var Ve=Object.defineProperty;var Ee=rt=>{throw TypeError(rt)};var $e=(rt,m,K)=>m in rt?Ve(rt,m,{enumerable:!0,configurable:!0,writable:!0,value:K}):rt[m]=K;var xt=(rt,m,K)=>$e(rt,typeof m!="symbol"?m+"":m,K),ne=(rt,m,K)=>m.has(rt)||Ee("Cannot "+K);var C=(rt,m,K)=>(ne(rt,m,"read from private field"),K?K.call(rt):m.get(rt)),ht=(rt,m,K)=>m.has(rt)?Ee("Cannot add the same private member more than once"):m instanceof WeakSet?m.add(rt):m.set(rt,K),ft=(rt,m,K,A)=>(ne(rt,m,"write to private field"),A?A.call(rt,K):m.set(rt,K),K),at=(rt,m,K)=>(ne(rt,m,"access private method"),K);var ie=(rt,m,K,A)=>({set _(k){ft(rt,m,k,K)},get _(){return C(rt,m,A)}});import{g as getAugmentedNamespace,a as getDefaultExportFromCjs}from"./theme.BI4ABVzp.js";function _mergeNamespaces(rt,m){for(var K=0;K<m.length;K++){const A=m[K];if(typeof A!="string"&&!Array.isArray(A)){for(const k in A)if(k!=="default"&&!(k in rt)){const H=Object.getOwnPropertyDescriptor(A,k);H&&Object.defineProperty(rt,k,H.get?H:{enumerable:!0,get:()=>A[k]})}}}return Object.freeze(Object.defineProperty(rt,Symbol.toStringTag,{value:"Module"}))}function commonjsRequire(rt){throw new Error('Could not dynamically require "'+rt+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$2={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(m,K){module.exports=K()})(globalThis,()=>(()=>{var __webpack_modules__=[,(rt,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.VerbosityLevel=m.Util=m.UnknownErrorException=m.UnexpectedResponseException=m.UNSUPPORTED_FEATURES=m.TextRenderingMode=m.StreamType=m.RenderingIntentFlag=m.PermissionFlag=m.PasswordResponses=m.PasswordException=m.PageActionEventType=m.OPS=m.MissingPDFException=m.LINE_FACTOR=m.LINE_DESCENT_FACTOR=m.InvalidPDFException=m.ImageKind=m.IDENTITY_MATRIX=m.FormatError=m.FontType=m.FeatureTest=m.FONT_IDENTITY_MATRIX=m.DocumentActionEventType=m.CMapCompressionType=m.BaseException=m.AnnotationType=m.AnnotationStateModelType=m.AnnotationReviewState=m.AnnotationReplyType=m.AnnotationMode=m.AnnotationMarkedState=m.AnnotationFlag=m.AnnotationFieldFlag=m.AnnotationEditorType=m.AnnotationEditorPrefix=m.AnnotationEditorParamsType=m.AnnotationBorderStyleType=m.AnnotationActionEventType=m.AbortException=void 0,m.arrayByteLength=l,m.arraysToBytes=w,m.assert=D,m.bytesToString=_,m.createPromiseCapability=Ut,m.createValidAbsoluteUrl=a,m.escapeString=bt,m.getModificationDate=Dt,m.getVerbosityLevel=et,m.info=nt,m.isArrayBuffer=St,m.isArrayEqual=Ct,m.isAscii=yt,m.objectFromMap=L,m.objectSize=M,m.setVerbosityLevel=Y,m.shadow=y,m.string32=v,m.stringToBytes=P,m.stringToPDFString=gt,m.stringToUTF16BEString=Et,m.stringToUTF8String=vt,m.unreachable=pt,m.utf8StringToString=wt,m.warn=dt;const K=[1,0,0,1,0,0];m.IDENTITY_MATRIX=K;const A=[.001,0,0,.001,0,0];m.FONT_IDENTITY_MATRIX=A;const k=1.35;m.LINE_FACTOR=k;const H=.35;m.LINE_DESCENT_FACTOR=H;const $={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};m.RenderingIntentFlag=$;const W={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};m.AnnotationMode=W;const U="pdfjs_internal_editor_";m.AnnotationEditorPrefix=U;const T={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};m.AnnotationEditorType=T;const E={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};m.AnnotationEditorParamsType=E;const R={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};m.PermissionFlag=R;const S={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};m.TextRenderingMode=S;const b={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};m.ImageKind=b;const h={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};m.AnnotationType=h;const f={MARKED:"Marked",REVIEW:"Review"};m.AnnotationStateModelType=f;const s={MARKED:"Marked",UNMARKED:"Unmarked"};m.AnnotationMarkedState=s;const e={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};m.AnnotationReviewState=e;const d={GROUP:"Group",REPLY:"R"};m.AnnotationReplyType=d;const o={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};m.AnnotationFlag=o;const p={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};m.AnnotationFieldFlag=p;const t={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};m.AnnotationBorderStyleType=t;const n={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};m.AnnotationActionEventType=n;const r={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};m.DocumentActionEventType=r;const u={O:"PageOpen",C:"PageClose"};m.PageActionEventType=u;const x={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};m.StreamType=x;const G={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};m.FontType=G;const I={ERRORS:0,WARNINGS:1,INFOS:5};m.VerbosityLevel=I;const lt={NONE:0,BINARY:1};m.CMapCompressionType=lt;const ut={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};m.OPS=ut;const ot={forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};m.UNSUPPORTED_FEATURES=ot;const J={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};m.PasswordResponses=J;let q=I.WARNINGS;function Y(it){Number.isInteger(it)&&(q=it)}function et(){return q}function nt(it){q>=I.INFOS&&console.log(`Info: ${it}`)}function dt(it){q>=I.WARNINGS&&console.log(`Warning: ${it}`)}function pt(it){throw new Error(it)}function D(it,V){it||pt(V)}function g(it){if(!it)return!1;switch(it.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function a(it,V=null,z=null){if(!it)return null;try{if(z&&typeof it=="string"){if(z.addDefaultProtocol&&it.startsWith("www.")){const At=it.match(/\./g);At&&At.length>=2&&(it=`http://${it}`)}if(z.tryConvertEncoding)try{it=vt(it)}catch{}}const mt=V?new URL(it,V):new URL(it);if(g(mt))return mt}catch{}return null}function y(it,V,z){return Object.defineProperty(it,V,{value:z,enumerable:!0,configurable:!0,writable:!1}),z}const F=function(){function V(z,mt){this.constructor===V&&pt("Cannot initialize BaseException."),this.message=z,this.name=mt}return V.prototype=new Error,V.constructor=V,V}();m.BaseException=F;class O extends F{constructor(V,z){super(V,"PasswordException"),this.code=z}}m.PasswordException=O;class N extends F{constructor(V,z){super(V,"UnknownErrorException"),this.details=z}}m.UnknownErrorException=N;class j extends F{constructor(V){super(V,"InvalidPDFException")}}m.InvalidPDFException=j;class Q extends F{constructor(V){super(V,"MissingPDFException")}}m.MissingPDFException=Q;class tt extends F{constructor(V,z){super(V,"UnexpectedResponseException"),this.status=z}}m.UnexpectedResponseException=tt;class i extends F{constructor(V){super(V,"FormatError")}}m.FormatError=i;class c extends F{constructor(V){super(V,"AbortException")}}m.AbortException=c;function _(it){(typeof it!="object"||it===null||it.length===void 0)&&pt("Invalid argument for bytesToString");const V=it.length,z=8192;if(V<z)return String.fromCharCode.apply(null,it);const mt=[];for(let At=0;At<V;At+=z){const Pt=Math.min(At+z,V),Tt=it.subarray(At,Pt);mt.push(String.fromCharCode.apply(null,Tt))}return mt.join("")}function P(it){typeof it!="string"&&pt("Invalid argument for stringToBytes");const V=it.length,z=new Uint8Array(V);for(let mt=0;mt<V;++mt)z[mt]=it.charCodeAt(mt)&255;return z}function l(it){if(it.length!==void 0)return it.length;if(it.byteLength!==void 0)return it.byteLength;pt("Invalid argument for arrayByteLength")}function w(it){const V=it.length;if(V===1&&it[0]instanceof Uint8Array)return it[0];let z=0;for(let Pt=0;Pt<V;Pt++)z+=l(it[Pt]);let mt=0;const At=new Uint8Array(z);for(let Pt=0;Pt<V;Pt++){let Tt=it[Pt];Tt instanceof Uint8Array||(typeof Tt=="string"?Tt=P(Tt):Tt=new Uint8Array(Tt));const It=Tt.byteLength;At.set(Tt,mt),mt+=It}return At}function v(it){return String.fromCharCode(it>>24&255,it>>16&255,it>>8&255,it&255)}function M(it){return Object.keys(it).length}function L(it){const V=Object.create(null);for(const[z,mt]of it)V[z]=mt;return V}function Z(){const it=new Uint8Array(4);return it[0]=1,new Uint32Array(it.buffer,0,1)[0]===1}function B(){try{return new Function(""),!0}catch{return!1}}class st{static get isLittleEndian(){return y(this,"isLittleEndian",Z())}static get isEvalSupported(){return y(this,"isEvalSupported",B())}static get isOffscreenCanvasSupported(){return y(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}m.FeatureTest=st;const X=[...Array(256).keys()].map(it=>it.toString(16).padStart(2,"0"));class ct{static makeHexColor(V,z,mt){return`#${X[V]}${X[z]}${X[mt]}`}static scaleMinMax(V,z){let mt;V[0]?(V[0]<0&&(mt=z[0],z[0]=z[1],z[1]=mt),z[0]*=V[0],z[1]*=V[0],V[3]<0&&(mt=z[2],z[2]=z[3],z[3]=mt),z[2]*=V[3],z[3]*=V[3]):(mt=z[0],z[0]=z[2],z[2]=mt,mt=z[1],z[1]=z[3],z[3]=mt,V[1]<0&&(mt=z[2],z[2]=z[3],z[3]=mt),z[2]*=V[1],z[3]*=V[1],V[2]<0&&(mt=z[0],z[0]=z[1],z[1]=mt),z[0]*=V[2],z[1]*=V[2]),z[0]+=V[4],z[1]+=V[4],z[2]+=V[5],z[3]+=V[5]}static transform(V,z){return[V[0]*z[0]+V[2]*z[1],V[1]*z[0]+V[3]*z[1],V[0]*z[2]+V[2]*z[3],V[1]*z[2]+V[3]*z[3],V[0]*z[4]+V[2]*z[5]+V[4],V[1]*z[4]+V[3]*z[5]+V[5]]}static applyTransform(V,z){const mt=V[0]*z[0]+V[1]*z[2]+z[4],At=V[0]*z[1]+V[1]*z[3]+z[5];return[mt,At]}static applyInverseTransform(V,z){const mt=z[0]*z[3]-z[1]*z[2],At=(V[0]*z[3]-V[1]*z[2]+z[2]*z[5]-z[4]*z[3])/mt,Pt=(-V[0]*z[1]+V[1]*z[0]+z[4]*z[1]-z[5]*z[0])/mt;return[At,Pt]}static getAxialAlignedBoundingBox(V,z){const mt=ct.applyTransform(V,z),At=ct.applyTransform(V.slice(2,4),z),Pt=ct.applyTransform([V[0],V[3]],z),Tt=ct.applyTransform([V[2],V[1]],z);return[Math.min(mt[0],At[0],Pt[0],Tt[0]),Math.min(mt[1],At[1],Pt[1],Tt[1]),Math.max(mt[0],At[0],Pt[0],Tt[0]),Math.max(mt[1],At[1],Pt[1],Tt[1])]}static inverseTransform(V){const z=V[0]*V[3]-V[1]*V[2];return[V[3]/z,-V[1]/z,-V[2]/z,V[0]/z,(V[2]*V[5]-V[4]*V[3])/z,(V[4]*V[1]-V[5]*V[0])/z]}static singularValueDecompose2dScale(V){const z=[V[0],V[2],V[1],V[3]],mt=V[0]*z[0]+V[1]*z[2],At=V[0]*z[1]+V[1]*z[3],Pt=V[2]*z[0]+V[3]*z[2],Tt=V[2]*z[1]+V[3]*z[3],It=(mt+Tt)/2,jt=Math.sqrt((mt+Tt)**2-4*(mt*Tt-Pt*At))/2,Nt=It+jt||1,Ft=It-jt||1;return[Math.sqrt(Nt),Math.sqrt(Ft)]}static normalizeRect(V){const z=V.slice(0);return V[0]>V[2]&&(z[0]=V[2],z[2]=V[0]),V[1]>V[3]&&(z[1]=V[3],z[3]=V[1]),z}static intersect(V,z){const mt=Math.max(Math.min(V[0],V[2]),Math.min(z[0],z[2])),At=Math.min(Math.max(V[0],V[2]),Math.max(z[0],z[2]));if(mt>At)return null;const Pt=Math.max(Math.min(V[1],V[3]),Math.min(z[1],z[3])),Tt=Math.min(Math.max(V[1],V[3]),Math.max(z[1],z[3]));return Pt>Tt?null:[mt,Pt,At,Tt]}static bezierBoundingBox(V,z,mt,At,Pt,Tt,It,jt){const Nt=[],Ft=[[],[]];let Bt,Lt,Vt,kt,$t,Yt,te,ee;for(let se=0;se<2;++se){if(se===0?(Lt=6*V-12*mt+6*Pt,Bt=-3*V+9*mt-9*Pt+3*It,Vt=3*mt-3*V):(Lt=6*z-12*At+6*Tt,Bt=-3*z+9*At-9*Tt+3*jt,Vt=3*At-3*z),Math.abs(Bt)<1e-12){if(Math.abs(Lt)<1e-12)continue;kt=-Vt/Lt,0<kt&&kt<1&&Nt.push(kt);continue}te=Lt*Lt-4*Vt*Bt,ee=Math.sqrt(te),!(te<0)&&($t=(-Lt+ee)/(2*Bt),0<$t&&$t<1&&Nt.push($t),Yt=(-Lt-ee)/(2*Bt),0<Yt&&Yt<1&&Nt.push(Yt))}let Ht=Nt.length,Rt;const Gt=Ht;for(;Ht--;)kt=Nt[Ht],Rt=1-kt,Ft[0][Ht]=Rt*Rt*Rt*V+3*Rt*Rt*kt*mt+3*Rt*kt*kt*Pt+kt*kt*kt*It,Ft[1][Ht]=Rt*Rt*Rt*z+3*Rt*Rt*kt*At+3*Rt*kt*kt*Tt+kt*kt*kt*jt;return Ft[0][Gt]=V,Ft[1][Gt]=z,Ft[0][Gt+1]=It,Ft[1][Gt+1]=jt,Ft[0].length=Ft[1].length=Gt+2,[Math.min(...Ft[0]),Math.min(...Ft[1]),Math.max(...Ft[0]),Math.max(...Ft[1])]}}m.Util=ct;const _t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function gt(it){if(it[0]>="ï"){let z;if(it[0]==="þ"&&it[1]==="ÿ"?z="utf-16be":it[0]==="ÿ"&&it[1]==="þ"?z="utf-16le":it[0]==="ï"&&it[1]==="»"&&it[2]==="¿"&&(z="utf-8"),z)try{const mt=new TextDecoder(z,{fatal:!0}),At=P(it);return mt.decode(At)}catch(mt){dt(`stringToPDFString: "${mt}".`)}}const V=[];for(let z=0,mt=it.length;z<mt;z++){const At=_t[it.charCodeAt(z)];V.push(At?String.fromCharCode(At):it.charAt(z))}return V.join("")}function bt(it){return it.replace(/([()\\\n\r])/g,V=>V===`
`?"\\n":V==="\r"?"\\r":`\\${V}`)}function yt(it){return/^[\x00-\x7F]*$/.test(it)}function Et(it){const V=["þÿ"];for(let z=0,mt=it.length;z<mt;z++){const At=it.charCodeAt(z);V.push(String.fromCharCode(At>>8&255),String.fromCharCode(At&255))}return V.join("")}function vt(it){return decodeURIComponent(escape(it))}function wt(it){return unescape(encodeURIComponent(it))}function St(it){return typeof it=="object"&&it!==null&&it.byteLength!==void 0}function Ct(it,V){if(it.length!==V.length)return!1;for(let z=0,mt=it.length;z<mt;z++)if(it[z]!==V[z])return!1;return!0}function Dt(it=new Date){return[it.getUTCFullYear().toString(),(it.getUTCMonth()+1).toString().padStart(2,"0"),it.getUTCDate().toString().padStart(2,"0"),it.getUTCHours().toString().padStart(2,"0"),it.getUTCMinutes().toString().padStart(2,"0"),it.getUTCSeconds().toString().padStart(2,"0")].join("")}function Ut(){const it=Object.create(null);let V=!1;return Object.defineProperty(it,"settled",{get(){return V}}),it.promise=new Promise(function(z,mt){it.resolve=function(At){V=!0,z(At)},it.reject=function(At){V=!0,mt(At)}}),it}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var rt,K,A,k,H,$,W,U,T,E,R,re,b,h;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(12),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:s,NodeCMapReaderFactory:e,NodeStandardFontDataFactory:d}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=s,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=e,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=d}let createPDFNetworkStream;function setPDFNetworkStreamFactory(s){createPDFNetworkStream=s}function getDocument(s){const e=new PDFDocumentLoadingTask;let d;if(typeof s=="string"||s instanceof URL)d={url:s};else if((0,_util.isArrayBuffer)(s))d={data:s};else if(s instanceof PDFDataRangeTransport)d={range:s};else{if(typeof s!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!s.url&&!s.data&&!s.range)throw new Error("Invalid parameter object: need either .data, .range or .url");d=s}const o=Object.create(null);let p=null,t=null;for(const r in d){const u=d[r];switch(r){case"url":if(typeof window<"u")try{o[r]=new URL(u,window.location).href;continue}catch(x){(0,_util.warn)(`Cannot create valid URL: "${x}".`)}else if(typeof u=="string"||u instanceof URL){o[r]=u.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":p=u;continue;case"worker":t=u;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&u instanceof Buffer)o[r]=new Uint8Array(u);else{if(u instanceof Uint8Array)break;if(typeof u=="string")o[r]=(0,_util.stringToBytes)(u);else if(typeof u=="object"&&u!==null&&!isNaN(u.length))o[r]=new Uint8Array(u);else if((0,_util.isArrayBuffer)(u))o[r]=new Uint8Array(u);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}o[r]=u}if(o.CMapReaderFactory=o.CMapReaderFactory||DefaultCMapReaderFactory,o.StandardFontDataFactory=o.StandardFontDataFactory||DefaultStandardFontDataFactory,o.ignoreErrors=o.stopAtErrors!==!0,o.fontExtraProperties=o.fontExtraProperties===!0,o.pdfBug=o.pdfBug===!0,o.enableXfa=o.enableXfa===!0,(!Number.isInteger(o.rangeChunkSize)||o.rangeChunkSize<1)&&(o.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof o.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(o.docBaseUrl))&&(o.docBaseUrl=null),(!Number.isInteger(o.maxImageSize)||o.maxImageSize<-1)&&(o.maxImageSize=-1),typeof o.cMapUrl!="string"&&(o.cMapUrl=null),typeof o.standardFontDataUrl!="string"&&(o.standardFontDataUrl=null),typeof o.useWorkerFetch!="boolean"&&(o.useWorkerFetch=o.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&o.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof o.isEvalSupported!="boolean"&&(o.isEvalSupported=!0),typeof o.isOffscreenCanvasSupported!="boolean"&&(o.isOffscreenCanvasSupported=!_is_node.isNodeJS),typeof o.disableFontFace!="boolean"&&(o.disableFontFace=_is_node.isNodeJS),typeof o.useSystemFonts!="boolean"&&(o.useSystemFonts=!_is_node.isNodeJS&&!o.disableFontFace),(typeof o.ownerDocument!="object"||o.ownerDocument===null)&&(o.ownerDocument=globalThis.document),typeof o.disableRange!="boolean"&&(o.disableRange=!1),typeof o.disableStream!="boolean"&&(o.disableStream=!1),typeof o.disableAutoFetch!="boolean"&&(o.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(o.verbosity),!t){const r={verbosity:o.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};t=r.port?PDFWorker.fromPort(r):new PDFWorker(r),e._worker=t}const n=e.docId;return t.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");const r=_fetchDocument(t,o,p,n),u=new Promise(function(x){let G;p?G=new _transport_stream.PDFDataTransportStream({length:o.length,initialData:o.initialData,progressiveDone:o.progressiveDone,contentDispositionFilename:o.contentDispositionFilename,disableRange:o.disableRange,disableStream:o.disableStream},p):o.data||(G=createPDFNetworkStream({url:o.url,length:o.length,httpHeaders:o.httpHeaders,withCredentials:o.withCredentials,rangeChunkSize:o.rangeChunkSize,disableRange:o.disableRange,disableStream:o.disableStream})),x(G)});return Promise.all([r,u]).then(function([x,G]){if(e.destroyed)throw new Error("Loading aborted");const I=new _message_handler.MessageHandler(n,x,t.port),lt=new WorkerTransport(I,e,G,o);e._transport=lt,I.send("Ready",null)})}).catch(e._capability.reject),e}async function _fetchDocument(s,e,d,o){if(s.destroyed)throw new Error("Worker was destroyed");d&&(e.length=d.length,e.initialData=d.initialData,e.progressiveDone=d.progressiveDone,e.contentDispositionFilename=d.contentDispositionFilename);const p=await s.messageHandler.sendWithPromise("GetDocRequest",{docId:o,apiVersion:"3.0.279",data:e.data,password:e.password,disableAutoFetch:e.disableAutoFetch,rangeChunkSize:e.rangeChunkSize,length:e.length,docBaseUrl:e.docBaseUrl,enableXfa:e.enableXfa,evaluatorOptions:{maxImageSize:e.maxImageSize,disableFontFace:e.disableFontFace,ignoreErrors:e.ignoreErrors,isEvalSupported:e.isEvalSupported,isOffscreenCanvasSupported:e.isOffscreenCanvasSupported,fontExtraProperties:e.fontExtraProperties,useSystemFonts:e.useSystemFonts,cMapUrl:e.useWorkerFetch?e.cMapUrl:null,standardFontDataUrl:e.useWorkerFetch?e.standardFontDataUrl:null}});if(e.data&&(e.data=null),s.destroyed)throw new Error("Worker was destroyed");return p}const m=class m{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${ie(m,rt)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var e;this.destroyed=!0,await((e=this._transport)==null?void 0:e.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};rt=new WeakMap,ht(m,rt,0);let PDFDocumentLoadingTask=m;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,d,o=!1,p=null){this.length=e,this.initialData=d,this.progressiveDone=o,this.contentDispositionFilename=p,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,d){for(const o of this._rangeListeners)o(e,d)}onDataProgress(e,d){this._readyCapability.promise.then(()=>{for(const o of this._progressListeners)o(e,d)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const d of this._progressiveReadListeners)d(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,d){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,d){this._pdfInfo=e,this._transport=d}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(e,d,o,p,t=!1){this._pageIndex=e,this._pageInfo=d,this._ownerDocument=p,this._transport=o,this._stats=t?new _display_utils.StatTimer:null,this._pdfBug=t,this.commonObjs=o.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:d=this.rotate,offsetX:o=0,offsetY:p=0,dontFlip:t=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:d,offsetX:o,offsetY:p,dontFlip:t})}getAnnotations({intent:e="display"}={}){const d=this._transport.getRenderingIntent(e);let o=this._annotationPromises.get(d.cacheKey);return o||(o=this._transport.getAnnotations(this._pageIndex,d.renderingIntent),this._annotationPromises.set(d.cacheKey,o)),o}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:d,intent:o="display",annotationMode:p=_util.AnnotationMode.ENABLE,transform:t=null,canvasFactory:n=null,background:r=null,optionalContentConfigPromise:u=null,annotationCanvasMap:x=null,pageColors:G=null,printAnnotationStorage:I=null}){var nt,dt;(nt=this._stats)==null||nt.time("Overall");const lt=this._transport.getRenderingIntent(o,p,I);this.pendingCleanup=!1,u||(u=this._transport.getOptionalContentConfig());let ut=this._intentStates.get(lt.cacheKey);ut||(ut=Object.create(null),this._intentStates.set(lt.cacheKey,ut)),ut.streamReaderCancelTimeout&&(clearTimeout(ut.streamReaderCancelTimeout),ut.streamReaderCancelTimeout=null);const ot=n||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),J=!!(lt.renderingIntent&_util.RenderingIntentFlag.PRINT);ut.displayReadyCapability||(ut.displayReadyCapability=(0,_util.createPromiseCapability)(),ut.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(dt=this._stats)==null||dt.time("Page Request"),this._pumpOperatorList(lt));const q=pt=>{var D,g;ut.renderTasks.delete(Y),(this.cleanupAfterRender||J)&&(this.pendingCleanup=!0),this._tryCleanup(),pt?(Y.capability.reject(pt),this._abortOperatorList({intentState:ut,reason:pt instanceof Error?pt:new Error(pt)})):Y.capability.resolve(),(D=this._stats)==null||D.timeEnd("Rendering"),(g=this._stats)==null||g.timeEnd("Overall")},Y=new InternalRenderTask({callback:q,params:{canvasContext:e,viewport:d,transform:t,background:r},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:x,operatorList:ut.operatorList,pageIndex:this._pageIndex,canvasFactory:ot,useRequestAnimationFrame:!J,pdfBug:this._pdfBug,pageColors:G});(ut.renderTasks||(ut.renderTasks=new Set)).add(Y);const et=Y.task;return Promise.all([ut.displayReadyCapability.promise,u]).then(([pt,D])=>{var g;if(this.pendingCleanup){q();return}(g=this._stats)==null||g.time("Rendering"),Y.initializeGraphics({transparency:pt,optionalContentConfig:D}),Y.operatorListChanged()}).catch(q),et}getOperatorList({intent:e="display",annotationMode:d=_util.AnnotationMode.ENABLE,printAnnotationStorage:o=null}={}){var u;function p(){n.operatorList.lastChunk&&(n.opListReadCapability.resolve(n.operatorList),n.renderTasks.delete(r))}const t=this._transport.getRenderingIntent(e,d,o,!0);let n=this._intentStates.get(t.cacheKey);n||(n=Object.create(null),this._intentStates.set(t.cacheKey,n));let r;return n.opListReadCapability||(r=Object.create(null),r.operatorListChanged=p,n.opListReadCapability=(0,_util.createPromiseCapability)(),(n.renderTasks||(n.renderTasks=new Set)).add(r),n.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(t)),n.opListReadCapability.promise}streamTextContent({disableCombineTextItems:e=!1,includeMarkedContent:d=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:e!==!0,includeMarkedContent:d===!0},{highWaterMark:100,size(p){return p.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(o=>_xfa_text.XfaText.textContent(o));const d=this.streamTextContent(e);return new Promise(function(o,p){function t(){n.read().then(function({value:u,done:x}){if(x){o(r);return}Object.assign(r.styles,u.styles),r.items.push(...u.items),t()},p)}const n=d.getReader(),r={items:[],styles:Object.create(null)};t()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const e=[];for(const d of this._intentStates.values())if(this._abortOperatorList({intentState:d,reason:new Error("Page was destroyed."),force:!0}),!d.opListReadCapability)for(const o of d.renderTasks)e.push(o.completed),o.cancel();this.objs.clear();for(const d of this._bitmaps)d.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(e)}cleanup(e=!1){return this.pendingCleanup=!0,this._tryCleanup(e)}_tryCleanup(e=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:d,operatorList:o}of this._intentStates.values())if(d.size>0||!o.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,e&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const d of this._bitmaps)d.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(e,d){var p,t;const o=this._intentStates.get(d);o&&((p=this._stats)==null||p.timeEnd("Page Request"),(t=o.displayReadyCapability)==null||t.resolve(e))}_renderPageChunk(e,d){for(let o=0,p=e.length;o<p;o++)d.operatorList.fnArray.push(e.fnArray[o]),d.operatorList.argsArray.push(e.argsArray[o]);d.operatorList.lastChunk=e.lastChunk,d.operatorList.separateAnnots=e.separateAnnots;for(const o of d.renderTasks)o.operatorListChanged();e.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:e,cacheKey:d,annotationStorageMap:o}){const t=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:d,annotationStorage:o}).getReader(),n=this._intentStates.get(d);n.streamReader=t;const r=()=>{t.read().then(({value:u,done:x})=>{if(x){n.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(u,n),r())},u=>{if(n.streamReader=null,!this._transport.destroyed){if(n.operatorList){n.operatorList.lastChunk=!0;for(const x of n.renderTasks)x.operatorListChanged();this._tryCleanup()}if(n.displayReadyCapability)n.displayReadyCapability.reject(u);else if(n.opListReadCapability)n.opListReadCapability.reject(u);else throw u}})};r()}_abortOperatorList({intentState:e,reason:d,force:o=!1}){if(e.streamReader){if(!o){if(e.renderTasks.size>0)return;if(d instanceof _display_utils.RenderingCancelledException){e.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:e,reason:d,force:!0}),e.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(e.streamReader.cancel(new _util.AbortException(d.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[p,t]of this._intentStates)if(t===e){this._intentStates.delete(p);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){ht(this,K,[]);ht(this,A,Promise.resolve())}postMessage(e,d){const o={data:structuredClone(e,d)};C(this,A).then(()=>{for(const p of C(this,K))p.call(this,o)})}addEventListener(e,d){C(this,K).push(d)}removeEventListener(e,d){const o=C(this,K).indexOf(d);C(this,K).splice(o,1)}terminate(){C(this,K).length=0}}K=new WeakMap,A=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const s=(k=document==null?void 0:document.currentScript)==null?void 0:k.src;s&&(PDFWorkerUtil.fallbackWorkerSrc=s.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(s,e){let d;try{if(d=new URL(s),!d.origin||d.origin==="null")return!1}catch{return!1}const o=new URL(e,d);return d.origin===o.origin},PDFWorkerUtil.createCDNWrapper=function(s){const e=`importScripts("${s}");`;return URL.createObjectURL(new Blob([e]))}}const _PDFWorker=class _PDFWorker{constructor({name:s=null,port:e=null,verbosity:d=(0,_util.getVerbosityLevel)()}={}){if(e&&C(_PDFWorker,H).has(e))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=s,this.destroyed=!1,this.verbosity=d,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,e){C(_PDFWorker,H).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(s){this._port=s,this._messageHandler=new _message_handler.MessageHandler("main","worker",s),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:s}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,s)||(s=PDFWorkerUtil.createCDNWrapper(new URL(s,window.location).href));const e=new Worker(s),d=new _message_handler.MessageHandler("main","worker",e),o=()=>{e.removeEventListener("error",p),d.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},p=()=>{this._webWorker||o()};e.addEventListener("error",p),d.on("test",n=>{if(e.removeEventListener("error",p),this.destroyed){o();return}n?(this._messageHandler=d,this._port=e,this._webWorker=e,this._readyCapability.resolve(),d.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),d.destroy(),e.terminate())}),d.on("ready",n=>{if(e.removeEventListener("error",p),this.destroyed){o();return}try{t()}catch{this._setupFakeWorker()}});const t=()=>{const n=new Uint8Array;d.send("test",n,[n.buffer])};t();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(s=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new LoopbackPort;this._port=e;const d=`fake${PDFWorkerUtil.fakeWorkerId++}`,o=new _message_handler.MessageHandler(d+"_worker",d,e);s.setup(o,e);const p=new _message_handler.MessageHandler(d,d+"_worker",e);this._messageHandler=p,this._readyCapability.resolve(),p.send("configure",{verbosity:this.verbosity})}).catch(s=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${s.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),C(_PDFWorker,H).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(s){if(!(s!=null&&s.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return C(this,H).has(s.port)?C(this,H).get(s.port):new _PDFWorker(s)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var s;try{return((s=globalThis.pdfjsWorker)==null?void 0:s.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};H=new WeakMap,ht(_PDFWorker,H,new WeakMap);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(e,d,o,p){ht(this,$,null);ht(this,W,new Map);ht(this,U,new Map);ht(this,T,null);this.messageHandler=e,this.loadingTask=d,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:p.ownerDocument,styleElement:p.styleElement}),this._params=p,p.useWorkerFetch||(this.CMapReaderFactory=new p.CMapReaderFactory({baseUrl:p.cMapUrl,isCompressed:p.cMapPacked}),this.StandardFontDataFactory=new p.StandardFontDataFactory({baseUrl:p.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=o,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return C(this,$)}getRenderingIntent(e,d=_util.AnnotationMode.ENABLE,o=null,p=!1){let t=_util.RenderingIntentFlag.DISPLAY,n=null;switch(e){case"any":t=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":t=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${e}`)}switch(d){case _util.AnnotationMode.DISABLE:t+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:t+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:t+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,n=(t&_util.RenderingIntentFlag.PRINT&&o instanceof _annotation_storage.PrintAnnotationStorage?o:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${d}`)}return p&&(t+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:t,cacheKey:`${t}_${_annotation_storage.AnnotationStorage.getHash(n)}`,annotationStorageMap:n}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const o of C(this,W).values())e.push(o._destroy());C(this,W).clear(),C(this,U).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const d=this.messageHandler.sendWithPromise("Terminate",null);return e.push(d),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),ft(this,T,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:d}=this;e.on("GetReader",(o,p)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=t=>{this._lastProgress={loaded:t.loaded,total:t.total}},p.onPull=()=>{this._fullReader.read().then(function({value:t,done:n}){if(n){p.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(t),"GetReader - expected an ArrayBuffer."),p.enqueue(new Uint8Array(t),1,[t])}).catch(t=>{p.error(t)})},p.onCancel=t=>{this._fullReader.cancel(t),p.ready.catch(n=>{if(!this.destroyed)throw n})}}),e.on("ReaderHeadersReady",o=>{const p=(0,_util.createPromiseCapability)(),t=this._fullReader;return t.headersReady.then(()=>{var n;(!t.isStreamingSupported||!t.isRangeSupported)&&(this._lastProgress&&((n=d.onProgress)==null||n.call(d,this._lastProgress)),t.onProgress=r=>{var u;(u=d.onProgress)==null||u.call(d,{loaded:r.loaded,total:r.total})}),p.resolve({isStreamingSupported:t.isStreamingSupported,isRangeSupported:t.isRangeSupported,contentLength:t.contentLength})},p.reject),p.promise}),e.on("GetRangeReader",(o,p)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const t=this._networkStream.getRangeReader(o.begin,o.end);if(!t){p.close();return}p.onPull=()=>{t.read().then(function({value:n,done:r}){if(r){p.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(n),"GetRangeReader - expected an ArrayBuffer."),p.enqueue(new Uint8Array(n),1,[n])}).catch(n=>{p.error(n)})},p.onCancel=n=>{t.cancel(n),p.ready.catch(r=>{if(!this.destroyed)throw r})}}),e.on("GetDoc",({pdfInfo:o})=>{this._numPages=o.numPages,this._htmlForXfa=o.htmlForXfa,delete o.htmlForXfa,d._capability.resolve(new PDFDocumentProxy(o,this))}),e.on("DocException",function(o){let p;switch(o.name){case"PasswordException":p=new _util.PasswordException(o.message,o.code);break;case"InvalidPDFException":p=new _util.InvalidPDFException(o.message);break;case"MissingPDFException":p=new _util.MissingPDFException(o.message);break;case"UnexpectedResponseException":p=new _util.UnexpectedResponseException(o.message,o.status);break;case"UnknownErrorException":p=new _util.UnknownErrorException(o.message,o.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}d._capability.reject(p)}),e.on("PasswordRequest",o=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),d.onPassword){const p=t=>{t instanceof Error?this._passwordCapability.reject(t):this._passwordCapability.resolve({password:t})};try{d.onPassword(p,o.code)}catch(t){this._passwordCapability.reject(t)}}else this._passwordCapability.reject(new _util.PasswordException(o.message,o.code));return this._passwordCapability.promise}),e.on("DataLoaded",o=>{var p;(p=d.onProgress)==null||p.call(d,{loaded:o.length,total:o.length}),this.downloadInfoCapability.resolve(o)}),e.on("StartRenderPage",o=>{if(this.destroyed)return;C(this,W).get(o.pageIndex)._startRenderPage(o.transparency,o.cacheKey)}),e.on("commonobj",([o,p,t])=>{var n;if(!this.destroyed&&!this.commonObjs.has(o))switch(p){case"Font":const r=this._params;if("error"in t){const G=t.error;(0,_util.warn)(`Error during font loading: ${G}`),this.commonObjs.resolve(o,G);break}let u=null;r.pdfBug&&((n=globalThis.FontInspector)!=null&&n.enabled)&&(u={registerFont(G,I){globalThis.FontInspector.fontAdded(G,I)}});const x=new _font_loader.FontFaceObject(t,{isEvalSupported:r.isEvalSupported,disableFontFace:r.disableFontFace,ignoreErrors:r.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:u});this.fontLoader.bind(x).catch(G=>e.sendWithPromise("FontFallback",{id:o})).finally(()=>{!r.fontExtraProperties&&x.data&&(x.data=null),this.commonObjs.resolve(o,x)});break;case"FontPath":case"Image":this.commonObjs.resolve(o,t);break;default:throw new Error(`Got unknown common object type ${p}`)}}),e.on("obj",([o,p,t,n])=>{var u;if(this.destroyed)return;const r=C(this,W).get(p);if(!r.objs.has(o))switch(t){case"Image":r.objs.resolve(o,n);const x=8e6;if(n){let G;if(n.bitmap){const{bitmap:I,width:lt,height:ut}=n;G=lt*ut*4,r._bitmaps.add(I)}else G=((u=n.data)==null?void 0:u.length)||0;G>x&&(r.cleanupAfterRender=!0)}break;case"Pattern":r.objs.resolve(o,n);break;default:throw new Error(`Got unknown object type ${t}`)}}),e.on("DocProgress",o=>{var p;this.destroyed||(p=d.onProgress)==null||p.call(d,{loaded:o.loaded,total:o.total})}),e.on("DocStats",o=>{this.destroyed||ft(this,$,Object.freeze({streamTypes:Object.freeze(o.streamTypes),fontTypes:Object.freeze(o.fontTypes)}))}),e.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),e.on("FetchBuiltInCMap",o=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(o):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",o=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(o):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:e}){var d,o;this.destroyed||(o=(d=this.loadingTask).onUnsupportedFeature)==null||o.call(d,e)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var e;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((e=this._fullReader)==null?void 0:e.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const d=e-1,o=C(this,U).get(d);if(o)return o;const p=this.messageHandler.sendWithPromise("GetPage",{pageIndex:d}).then(t=>{if(this.destroyed)throw new Error("Transport destroyed");const n=new PDFPageProxy(d,t,this,this._params.ownerDocument,this._params.pdfBug);return C(this,W).set(d,n),n});return C(this,U).set(d,p),p}getPageIndex(e){return typeof e!="object"||e===null||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,d){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:d})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return C(this,T)||ft(this,T,this.messageHandler.sendWithPromise("GetMetadata",null).then(e=>{var d,o;return{info:e[0],metadata:e[1]?new _metadata.Metadata(e[1]):null,contentDispositionFilename:((d=this._fullReader)==null?void 0:d.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const d of C(this,W).values())if(!d.cleanup())throw new Error(`startCleanup: Page ${d.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),ft(this,T,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const e=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e.disableAutoFetch,enableXfa:e.enableXfa})}}$=new WeakMap,W=new WeakMap,U=new WeakMap,T=new WeakMap;class PDFObjects{constructor(){ht(this,R);ht(this,E,Object.create(null))}get(e,d=null){if(d){const p=at(this,R,re).call(this,e);return p.capability.promise.then(()=>d(p.data)),null}const o=C(this,E)[e];if(!(o!=null&&o.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${e}.`);return o.data}has(e){const d=C(this,E)[e];return(d==null?void 0:d.capability.settled)||!1}resolve(e,d=null){const o=at(this,R,re).call(this,e);o.data=d,o.capability.resolve()}clear(){ft(this,E,Object.create(null))}}E=new WeakMap,R=new WeakSet,re=function(e){const d=C(this,E)[e];return d||(C(this,E)[e]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(e){ht(this,b,null);ft(this,b,e),this.onContinue=null}get promise(){return C(this,b).capability.promise}cancel(){C(this,b).cancel()}get separateAnnots(){const{separateAnnots:e}=C(this,b).operatorList;if(!e)return!1;const{annotationCanvasMap:d}=C(this,b);return e.form||e.canvas&&(d==null?void 0:d.size)>0}}b=new WeakMap,exports.RenderTask=RenderTask;const f=class f{constructor({callback:e,params:d,objs:o,commonObjs:p,annotationCanvasMap:t,operatorList:n,pageIndex:r,canvasFactory:u,useRequestAnimationFrame:x=!1,pdfBug:G=!1,pageColors:I=null}){this.callback=e,this.params=d,this.objs=o,this.commonObjs=p,this.annotationCanvasMap=t,this.operatorListIdx=null,this.operatorList=n,this._pageIndex=r,this.canvasFactory=u,this._pdfBug=G,this.pageColors=I,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=x===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=d.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:d}){var r,u;if(this.cancelled)return;if(this._canvas){if(C(f,h).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");C(f,h).add(this._canvas)}this._pdfBug&&((r=globalThis.StepperManager)!=null&&r.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:o,viewport:p,transform:t,background:n}=this.params;this.gfx=new _canvas.CanvasGraphics(o,this.commonObjs,this.objs,this.canvasFactory,d,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:t,viewport:p,transparency:e,background:n}),this.operatorListIdx=0,this.graphicsReady=!0,(u=this.graphicsReadyCallback)==null||u.call(this)}cancel(e=null){var d;this.running=!1,this.cancelled=!0,(d=this.gfx)==null||d.endDrawing(),this._canvas&&C(f,h).delete(this._canvas),this.callback(e||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&C(f,h).delete(this._canvas),this.callback())))}};h=new WeakMap,ht(f,h,new WeakSet);let InternalRenderTask=f;const version="3.0.279";exports.version=version;const build="d0823066c";exports.build=build},(rt,m,K)=>{var U,Ce,E;Object.defineProperty(m,"__esModule",{value:!0}),m.PrintAnnotationStorage=m.AnnotationStorage=void 0;var A=K(1),k=K(4),H=K(8);class ${constructor(){ht(this,U);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(S,b){const h=this._storage.get(S);return h===void 0?b:Object.assign(b,h)}getRawValue(S){return this._storage.get(S)}remove(S){if(this._storage.delete(S),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const b of this._storage.values())if(b instanceof k.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(S,b){const h=this._storage.get(S);let f=!1;if(h!==void 0)for(const[s,e]of Object.entries(b))h[s]!==e&&(f=!0,h[s]=e);else f=!0,this._storage.set(S,b);f&&at(this,U,Ce).call(this),b instanceof k.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(b.constructor._type)}has(S){return this._storage.has(S)}getAll(){return this._storage.size>0?(0,A.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new W(this)}get serializable(){if(this._storage.size===0)return null;const S=new Map;for(const[b,h]of this._storage){const f=h instanceof k.AnnotationEditor?h.serialize():h;f&&S.set(b,f)}return S}static getHash(S){if(!S)return"";const b=new H.MurmurHash3_64;for(const[h,f]of S)b.update(`${h}:${JSON.stringify(f)}`);return b.hexdigest()}}U=new WeakSet,Ce=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},m.AnnotationStorage=$;class W extends ${constructor(b){super();ht(this,E,null);ft(this,E,structuredClone(b.serializable))}get print(){(0,A.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return C(this,E)}}E=new WeakMap,m.PrintAnnotationStorage=W},(rt,m,K)=>{var $,W,U,T,E,R;Object.defineProperty(m,"__esModule",{value:!0}),m.AnnotationEditor=void 0;var A=K(5),k=K(1);const S=class S{constructor(h){ht(this,$,this.focusin.bind(this));ht(this,W,this.focusout.bind(this));ht(this,U,!1);ht(this,T,!1);ht(this,E,!1);ht(this,R,S._zIndex++);this.constructor===S&&(0,k.unreachable)("Cannot initialize AnnotationEditor."),this.parent=h.parent,this.id=h.id,this.width=this.height=null,this.pageIndex=h.parent.pageIndex,this.name=h.name,this.div=null;const[f,s]=this.parent.viewportBaseDimensions;this.x=h.x/f,this.y=h.y/s,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,k.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=C(this,R)}focusin(h){C(this,U)?ft(this,U,!1):this.parent.setSelected(this)}focusout(h){if(!this.isAttachedToDOM)return;const f=h.relatedTarget;f!=null&&f.closest(`#${this.id}`)||(h.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(h){const f=this.parent.div.getBoundingClientRect();this.startX=h.clientX-f.x,this.startY=h.clientY-f.y,h.dataTransfer.setData("text/plain",this.id),h.dataTransfer.effectAllowed="move"}setAt(h,f,s,e){const[d,o]=this.parent.viewportBaseDimensions;[s,e]=this.screenToPageTranslation(s,e),this.x=(h+s)/d,this.y=(f+e)/o,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(h,f){const[s,e]=this.parent.viewportBaseDimensions;[h,f]=this.screenToPageTranslation(h,f),this.x+=h/s,this.y+=f/e,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(h,f){const{rotation:s}=this.parent.viewport;switch(s){case 90:return[f,-h];case 180:return[-h,-f];case 270:return[-f,h];default:return[h,f]}}setDims(h,f){const[s,e]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*h/s}%`,this.div.style.height=`${100*f/e}%`}fixDims(){const{style:h}=this.div,{height:f,width:s}=h,e=s.endsWith("%"),d=f.endsWith("%");if(e&&d)return;const[o,p]=this.parent.viewportBaseDimensions;e||(h.width=`${100*parseFloat(s)/o}%`),d||(h.height=`${100*parseFloat(f)/p}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",C(this,$)),this.div.addEventListener("focusout",C(this,W));const[h,f]=this.getInitialTranslation();return this.translate(h,f),(0,A.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(h){const f=A.KeyboardManager.platform.isMac;if(h.button!==0||h.ctrlKey&&f){h.preventDefault();return}h.ctrlKey&&!f||h.shiftKey||h.metaKey&&f?this.parent.toggleSelected(this):this.parent.setSelected(this),ft(this,U,!0)}getRect(h,f){const[s,e]=this.parent.viewportBaseDimensions,[d,o]=this.parent.pageDimensions,p=d*h/s,t=o*f/e,n=this.x*d,r=this.y*o,u=this.width*d,x=this.height*o;switch(this.rotation){case 0:return[n+p,o-r-t-x,n+p+u,o-r-t];case 90:return[n+t,o-r+p,n+t+x,o-r+p+u];case 180:return[n-p-u,o-r+t,n-p,o-r+t+x];case 270:return[n-t-x,o-r-p-u,n-t,o-r-p];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(h,f){const[s,e,d,o]=h,p=d-s,t=o-e;switch(this.rotation){case 0:return[s,f-o,p,t];case 90:return[s,f-e,t,p];case 180:return[d,f-e,p,t];case 270:return[d,f-o,t,p];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){ft(this,E,!0)}disableEditMode(){ft(this,E,!1)}isInEditMode(){return C(this,E)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var h;(h=this.div)==null||h.addEventListener("focusin",C(this,$))}serialize(){(0,k.unreachable)("An editor must be serializable")}static deserialize(h,f){const s=new this.prototype.constructor({parent:f,id:f.getNextId()});s.rotation=h.rotation;const[e,d]=f.pageDimensions,[o,p,t,n]=s.getRectInCurrentCoords(h.rect,d);return s.x=o/e,s.y=p/d,s.width=t/e,s.height=n/d,s}remove(){this.div.removeEventListener("focusin",C(this,$)),this.div.removeEventListener("focusout",C(this,W)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var h;(h=this.div)==null||h.classList.add("selectedEditor")}unselect(){var h;(h=this.div)==null||h.classList.remove("selectedEditor")}updateParams(h,f){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return C(this,T)}set isEditing(h){ft(this,T,h),h?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};$=new WeakMap,W=new WeakMap,U=new WeakMap,T=new WeakMap,E=new WeakMap,R=new WeakMap,xt(S,"_colorManager",new A.ColorManager),xt(S,"_zIndex",1);let H=S;m.AnnotationEditor=H},(rt,m,K)=>{var S,b,h,f,s,e,Te,t,n,r,u,x,G,I,lt,ut,ot,J,q,Y,et,nt,dt,pt,D,g,a,Pe,ae,xe,we,Mt,Xt,ke,Fe,oe,zt,le;Object.defineProperty(m,"__esModule",{value:!0}),m.KeyboardManager=m.CommandManager=m.ColorManager=m.AnnotationEditorUIManager=void 0,m.bindEvents=H,m.opacityToHex=$;var A=K(1),k=K(6);function H(w,v,M){for(const L of M)v.addEventListener(L,w[L].bind(w))}function $(w){return Math.round(Math.min(255,Math.max(1,255*w))).toString(16).padStart(2,"0")}class W{constructor(){ht(this,S,0)}getId(){return`${A.AnnotationEditorPrefix}${ie(this,S)._++}`}}S=new WeakMap;class U{constructor(v=128){ht(this,b,[]);ht(this,h,!1);ht(this,f);ht(this,s,-1);ft(this,f,v)}add({cmd:v,undo:M,mustExec:L,type:Z=NaN,overwriteIfSameType:B=!1,keepUndo:st=!1}){if(L&&v(),C(this,h))return;const X={cmd:v,undo:M,type:Z};if(C(this,s)===-1){C(this,b).length>0&&(C(this,b).length=0),ft(this,s,0),C(this,b).push(X);return}if(B&&C(this,b)[C(this,s)].type===Z){st&&(X.undo=C(this,b)[C(this,s)].undo),C(this,b)[C(this,s)]=X;return}const ct=C(this,s)+1;ct===C(this,f)?C(this,b).splice(0,1):(ft(this,s,ct),ct<C(this,b).length&&C(this,b).splice(ct)),C(this,b).push(X)}undo(){C(this,s)!==-1&&(ft(this,h,!0),C(this,b)[C(this,s)].undo(),ft(this,h,!1),ft(this,s,C(this,s)-1))}redo(){C(this,s)<C(this,b).length-1&&(ft(this,s,C(this,s)+1),ft(this,h,!0),C(this,b)[C(this,s)].cmd(),ft(this,h,!1))}hasSomethingToUndo(){return C(this,s)!==-1}hasSomethingToRedo(){return C(this,s)<C(this,b).length-1}destroy(){ft(this,b,null)}}b=new WeakMap,h=new WeakMap,f=new WeakMap,s=new WeakMap,m.CommandManager=U;const o=class o{constructor(v){ht(this,e);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const M=o.platform.isMac;for(const[L,Z]of v)for(const B of L){const st=B.startsWith("mac+");M&&st?(this.callbacks.set(B.slice(4),Z),this.allKeys.add(B.split("+").at(-1))):!M&&!st&&(this.callbacks.set(B,Z),this.allKeys.add(B.split("+").at(-1)))}}static get platform(){const v=typeof navigator<"u"?navigator.platform:"";return(0,A.shadow)(this,"platform",{isWin:v.includes("Win"),isMac:v.includes("Mac")})}exec(v,M){if(!this.allKeys.has(M.key))return;const L=this.callbacks.get(at(this,e,Te).call(this,M));L&&(L.bind(v)(),M.stopPropagation(),M.preventDefault())}};e=new WeakSet,Te=function(v){v.altKey&&this.buffer.push("alt"),v.ctrlKey&&this.buffer.push("ctrl"),v.metaKey&&this.buffer.push("meta"),v.shiftKey&&this.buffer.push("shift"),this.buffer.push(v.key);const M=this.buffer.join("+");return this.buffer.length=0,M};let T=o;m.KeyboardManager=T;const p=class p{get _colors(){const v=new Map([["CanvasText",null],["Canvas",null]]);return(0,k.getColorValues)(v),(0,A.shadow)(this,"_colors",v)}convert(v){const M=(0,k.getRGB)(v);if(!window.matchMedia("(forced-colors: active)").matches)return M;for(const[L,Z]of this._colors)if(Z.every((B,st)=>B===M[st]))return p._colorsMapping.get(L);return M}getHexCode(v){const M=this._colors.get(v);return M?A.Util.makeHexColor(...M):v}};xt(p,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let E=p;m.ColorManager=E;const l=class l{constructor(v,M){ht(this,a);ht(this,t,null);ht(this,n,new Map);ht(this,r,new Map);ht(this,u,new U);ht(this,x,0);ht(this,G,null);ht(this,I,null);ht(this,lt,new W);ht(this,ut,!1);ht(this,ot,A.AnnotationEditorType.NONE);ht(this,J,new Set);ht(this,q,this.copy.bind(this));ht(this,Y,this.cut.bind(this));ht(this,et,this.paste.bind(this));ht(this,nt,this.keydown.bind(this));ht(this,dt,this.onEditingAction.bind(this));ht(this,pt,this.onPageChanging.bind(this));ht(this,D,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});ht(this,g,null);ft(this,g,v),ft(this,I,M),C(this,I)._on("editingaction",C(this,dt)),C(this,I)._on("pagechanging",C(this,pt))}destroy(){at(this,a,ae).call(this),C(this,I)._off("editingaction",C(this,dt)),C(this,I)._off("pagechanging",C(this,pt));for(const v of C(this,r).values())v.destroy();C(this,r).clear(),C(this,n).clear(),ft(this,t,null),C(this,J).clear(),C(this,u).destroy()}onPageChanging({pageNumber:v}){ft(this,x,v-1)}focusMainContainer(){C(this,g).focus()}copy(v){if(v.preventDefault(),C(this,t)&&C(this,t).commitOrRemove(),!this.hasSelection)return;const M=[];for(const L of C(this,J))L.isEmpty()||M.push(L.serialize());M.length!==0&&v.clipboardData.setData("application/pdfjs",JSON.stringify(M))}cut(v){this.copy(v),this.delete()}paste(v){v.preventDefault();let M=v.clipboardData.getData("application/pdfjs");if(!M)return;try{M=JSON.parse(M)}catch(Z){(0,A.warn)(`paste: "${Z.message}".`);return}if(!Array.isArray(M))return;this.unselectAll();const L=C(this,r).get(C(this,x));try{const Z=[];for(const X of M){const ct=L.deserialize(X);if(!ct)return;Z.push(ct)}const B=()=>{for(const X of Z)at(this,a,oe).call(this,X);at(this,a,le).call(this,Z)},st=()=>{for(const X of Z)X.remove()};this.addCommands({cmd:B,undo:st,mustExec:!0})}catch(Z){(0,A.warn)(`paste: "${Z.message}".`)}}keydown(v){var M;(M=this.getActive())!=null&&M.shouldGetKeyboardEvents()||l._keyboardManager.exec(this,v)}onEditingAction(v){["undo","redo","delete","selectAll"].includes(v.name)&&this[v.name]()}setEditingState(v){v?(at(this,a,Pe).call(this),at(this,a,xe).call(this),at(this,a,Mt).call(this,{isEditing:C(this,ot)!==A.AnnotationEditorType.NONE,isEmpty:at(this,a,zt).call(this),hasSomethingToUndo:C(this,u).hasSomethingToUndo(),hasSomethingToRedo:C(this,u).hasSomethingToRedo(),hasSelectedEditor:!1})):(at(this,a,ae).call(this),at(this,a,we).call(this),at(this,a,Mt).call(this,{isEditing:!1}))}registerEditorTypes(v){if(!C(this,G)){ft(this,G,v);for(const M of C(this,G))at(this,a,Xt).call(this,M.defaultPropertiesToUpdate)}}getId(){return C(this,lt).getId()}addLayer(v){C(this,r).set(v.pageIndex,v),C(this,ut)?v.enable():v.disable()}removeLayer(v){C(this,r).delete(v.pageIndex)}updateMode(v){if(ft(this,ot,v),v===A.AnnotationEditorType.NONE)this.setEditingState(!1),at(this,a,Fe).call(this);else{this.setEditingState(!0),at(this,a,ke).call(this);for(const M of C(this,r).values())M.updateMode(v)}}updateToolbar(v){v!==C(this,ot)&&C(this,I).dispatch("switchannotationeditormode",{source:this,mode:v})}updateParams(v,M){if(C(this,G)){for(const L of C(this,J))L.updateParams(v,M);for(const L of C(this,G))L.updateDefaultParams(v,M)}}getEditors(v){const M=[];for(const L of C(this,n).values())L.pageIndex===v&&M.push(L);return M}getEditor(v){return C(this,n).get(v)}addEditor(v){C(this,n).set(v.id,v)}removeEditor(v){C(this,n).delete(v.id),this.unselect(v)}setActiveEditor(v){C(this,t)!==v&&(ft(this,t,v),v&&at(this,a,Xt).call(this,v.propertiesToUpdate))}toggleSelected(v){if(C(this,J).has(v)){C(this,J).delete(v),v.unselect(),at(this,a,Mt).call(this,{hasSelectedEditor:this.hasSelection});return}C(this,J).add(v),v.select(),at(this,a,Xt).call(this,v.propertiesToUpdate),at(this,a,Mt).call(this,{hasSelectedEditor:!0})}setSelected(v){for(const M of C(this,J))M!==v&&M.unselect();C(this,J).clear(),C(this,J).add(v),v.select(),at(this,a,Xt).call(this,v.propertiesToUpdate),at(this,a,Mt).call(this,{hasSelectedEditor:!0})}isSelected(v){return C(this,J).has(v)}unselect(v){v.unselect(),C(this,J).delete(v),at(this,a,Mt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return C(this,J).size!==0}undo(){C(this,u).undo(),at(this,a,Mt).call(this,{hasSomethingToUndo:C(this,u).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:at(this,a,zt).call(this)})}redo(){C(this,u).redo(),at(this,a,Mt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:C(this,u).hasSomethingToRedo(),isEmpty:at(this,a,zt).call(this)})}addCommands(v){C(this,u).add(v),at(this,a,Mt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:at(this,a,zt).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const v=[...C(this,J)],M=()=>{for(const Z of v)Z.remove()},L=()=>{for(const Z of v)at(this,a,oe).call(this,Z)};this.addCommands({cmd:M,undo:L,mustExec:!0})}commitOrRemove(){var v;(v=C(this,t))==null||v.commitOrRemove()}selectAll(){for(const v of C(this,J))v.commit();at(this,a,le).call(this,C(this,n).values())}unselectAll(){if(C(this,t)){C(this,t).commitOrRemove();return}if(C(this,J).size!==0){for(const v of C(this,J))v.unselect();C(this,J).clear(),at(this,a,Mt).call(this,{hasSelectedEditor:!1})}}isActive(v){return C(this,t)===v}getActive(){return C(this,t)}getMode(){return C(this,ot)}};t=new WeakMap,n=new WeakMap,r=new WeakMap,u=new WeakMap,x=new WeakMap,G=new WeakMap,I=new WeakMap,lt=new WeakMap,ut=new WeakMap,ot=new WeakMap,J=new WeakMap,q=new WeakMap,Y=new WeakMap,et=new WeakMap,nt=new WeakMap,dt=new WeakMap,pt=new WeakMap,D=new WeakMap,g=new WeakMap,a=new WeakSet,Pe=function(){C(this,g).addEventListener("keydown",C(this,nt))},ae=function(){C(this,g).removeEventListener("keydown",C(this,nt))},xe=function(){document.addEventListener("copy",C(this,q)),document.addEventListener("cut",C(this,Y)),document.addEventListener("paste",C(this,et))},we=function(){document.removeEventListener("copy",C(this,q)),document.removeEventListener("cut",C(this,Y)),document.removeEventListener("paste",C(this,et))},Mt=function(v){Object.entries(v).some(([L,Z])=>C(this,D)[L]!==Z)&&C(this,I).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(C(this,D),v)})},Xt=function(v){C(this,I).dispatch("annotationeditorparamschanged",{source:this,details:v})},ke=function(){if(!C(this,ut)){ft(this,ut,!0);for(const v of C(this,r).values())v.enable()}},Fe=function(){if(this.unselectAll(),C(this,ut)){ft(this,ut,!1);for(const v of C(this,r).values())v.disable()}},oe=function(v){const M=C(this,r).get(v.pageIndex);M?M.addOrRebuild(v):this.addEditor(v)},zt=function(){if(C(this,n).size===0)return!0;if(C(this,n).size===1)for(const v of C(this,n).values())return v.isEmpty();return!1},le=function(v){C(this,J).clear();for(const M of v)M.isEmpty()||(C(this,J).add(M),M.select());at(this,a,Mt).call(this,{hasSelectedEditor:!0})},xt(l,"_keyboardManager",new T([[["ctrl+a","mac+meta+a"],l.prototype.selectAll],[["ctrl+z","mac+meta+z"],l.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],l.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],l.prototype.delete],[["Escape","mac+Escape"],l.prototype.unselectAll]]));let R=l;m.AnnotationEditorUIManager=R},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.StatTimer=m.RenderingCancelledException=m.PixelsPerInch=m.PageViewport=m.PDFDateString=m.DOMStandardFontDataFactory=m.DOMSVGFactory=m.DOMCanvasFactory=m.DOMCMapReaderFactory=m.AnnotationPrefix=void 0,m.deprecated=n,m.getColorValues=I,m.getCurrentTransform=lt,m.getCurrentTransformInverse=ut,m.getFilenameFromUrl=e,m.getPdfFilenameFromUrl=d,m.getRGB=G,m.getXfaPageViewport=x,m.isDataScheme=f,m.isPdfFile=s,m.isValidFetchUrl=p,m.loadScript=t;var A=K(7),k=K(1);const H="http://www.w3.org/2000/svg",$="pdfjs_internal_id_";m.AnnotationPrefix=$;const ot=class ot{};xt(ot,"CSS",96),xt(ot,"PDF",72),xt(ot,"PDF_TO_CSS_UNITS",ot.CSS/ot.PDF);let W=ot;m.PixelsPerInch=W;class U extends A.BaseCanvasFactory{constructor({ownerDocument:q=globalThis.document}={}){super(),this._document=q}_createCanvas(q,Y){const et=this._document.createElement("canvas");return et.width=q,et.height=Y,et}}m.DOMCanvasFactory=U;async function T(J,q=!1){if(p(J,document.baseURI)){const Y=await fetch(J);if(!Y.ok)throw new Error(Y.statusText);return q?new Uint8Array(await Y.arrayBuffer()):(0,k.stringToBytes)(await Y.text())}return new Promise((Y,et)=>{const nt=new XMLHttpRequest;nt.open("GET",J,!0),q&&(nt.responseType="arraybuffer"),nt.onreadystatechange=()=>{if(nt.readyState===XMLHttpRequest.DONE){if(nt.status===200||nt.status===0){let dt;if(q&&nt.response?dt=new Uint8Array(nt.response):!q&&nt.responseText&&(dt=(0,k.stringToBytes)(nt.responseText)),dt){Y(dt);return}}et(new Error(nt.statusText))}},nt.send(null)})}class E extends A.BaseCMapReaderFactory{_fetchData(q,Y){return T(q,this.isCompressed).then(et=>({cMapData:et,compressionType:Y}))}}m.DOMCMapReaderFactory=E;class R extends A.BaseStandardFontDataFactory{_fetchData(q){return T(q,!0)}}m.DOMStandardFontDataFactory=R;class S extends A.BaseSVGFactory{_createSVG(q){return document.createElementNS(H,q)}}m.DOMSVGFactory=S;class b{constructor({viewBox:q,scale:Y,rotation:et,offsetX:nt=0,offsetY:dt=0,dontFlip:pt=!1}){this.viewBox=q,this.scale=Y,this.rotation=et,this.offsetX=nt,this.offsetY=dt;const D=(q[2]+q[0])/2,g=(q[3]+q[1])/2;let a,y,F,O;switch(et%=360,et<0&&(et+=360),et){case 180:a=-1,y=0,F=0,O=1;break;case 90:a=0,y=1,F=1,O=0;break;case 270:a=0,y=-1,F=-1,O=0;break;case 0:a=1,y=0,F=0,O=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}pt&&(F=-F,O=-O);let N,j,Q,tt;a===0?(N=Math.abs(g-q[1])*Y+nt,j=Math.abs(D-q[0])*Y+dt,Q=Math.abs(q[3]-q[1])*Y,tt=Math.abs(q[2]-q[0])*Y):(N=Math.abs(D-q[0])*Y+nt,j=Math.abs(g-q[1])*Y+dt,Q=Math.abs(q[2]-q[0])*Y,tt=Math.abs(q[3]-q[1])*Y),this.transform=[a*Y,y*Y,F*Y,O*Y,N-a*Y*D-F*Y*g,j-y*Y*D-O*Y*g],this.width=Q,this.height=tt}clone({scale:q=this.scale,rotation:Y=this.rotation,offsetX:et=this.offsetX,offsetY:nt=this.offsetY,dontFlip:dt=!1}={}){return new b({viewBox:this.viewBox.slice(),scale:q,rotation:Y,offsetX:et,offsetY:nt,dontFlip:dt})}convertToViewportPoint(q,Y){return k.Util.applyTransform([q,Y],this.transform)}convertToViewportRectangle(q){const Y=k.Util.applyTransform([q[0],q[1]],this.transform),et=k.Util.applyTransform([q[2],q[3]],this.transform);return[Y[0],Y[1],et[0],et[1]]}convertToPdfPoint(q,Y){return k.Util.applyInverseTransform([q,Y],this.transform)}}m.PageViewport=b;class h extends k.BaseException{constructor(q,Y){super(q,"RenderingCancelledException"),this.type=Y}}m.RenderingCancelledException=h;function f(J){const q=J.length;let Y=0;for(;Y<q&&J[Y].trim()==="";)Y++;return J.substring(Y,Y+5).toLowerCase()==="data:"}function s(J){return typeof J=="string"&&/\.pdf$/i.test(J)}function e(J){const q=J.indexOf("#"),Y=J.indexOf("?"),et=Math.min(q>0?q:J.length,Y>0?Y:J.length);return J.substring(J.lastIndexOf("/",et)+1,et)}function d(J,q="document.pdf"){if(typeof J!="string")return q;if(f(J))return(0,k.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),q;const Y=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,et=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,nt=Y.exec(J);let dt=et.exec(nt[1])||et.exec(nt[2])||et.exec(nt[3]);if(dt&&(dt=dt[0],dt.includes("%")))try{dt=et.exec(decodeURIComponent(dt))[0]}catch{}return dt||q}class o{constructor(){this.started=Object.create(null),this.times=[]}time(q){q in this.started&&(0,k.warn)(`Timer is already running for ${q}`),this.started[q]=Date.now()}timeEnd(q){q in this.started||(0,k.warn)(`Timer has not been started for ${q}`),this.times.push({name:q,start:this.started[q],end:Date.now()}),delete this.started[q]}toString(){const q=[];let Y=0;for(const et of this.times){const nt=et.name;nt.length>Y&&(Y=nt.length)}for(const et of this.times){const nt=et.end-et.start;q.push(`${et.name.padEnd(Y)} ${nt}ms
`)}return q.join("")}}m.StatTimer=o;function p(J,q){try{const{protocol:Y}=q?new URL(J,q):new URL(J);return Y==="http:"||Y==="https:"}catch{return!1}}function t(J,q=!1){return new Promise((Y,et)=>{const nt=document.createElement("script");nt.src=J,nt.onload=function(dt){q&&nt.remove(),Y(dt)},nt.onerror=function(){et(new Error(`Cannot load script at: ${nt.src}`))},(document.head||document.documentElement).append(nt)})}function n(J){console.log("Deprecated API usage: "+J)}let r;class u{static toDateObject(q){if(!q||typeof q!="string")return null;r||(r=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const Y=r.exec(q);if(!Y)return null;const et=parseInt(Y[1],10);let nt=parseInt(Y[2],10);nt=nt>=1&&nt<=12?nt-1:0;let dt=parseInt(Y[3],10);dt=dt>=1&&dt<=31?dt:1;let pt=parseInt(Y[4],10);pt=pt>=0&&pt<=23?pt:0;let D=parseInt(Y[5],10);D=D>=0&&D<=59?D:0;let g=parseInt(Y[6],10);g=g>=0&&g<=59?g:0;const a=Y[7]||"Z";let y=parseInt(Y[8],10);y=y>=0&&y<=23?y:0;let F=parseInt(Y[9],10)||0;return F=F>=0&&F<=59?F:0,a==="-"?(pt+=y,D+=F):a==="+"&&(pt-=y,D-=F),new Date(Date.UTC(et,nt,dt,pt,D,g))}}m.PDFDateString=u;function x(J,{scale:q=1,rotation:Y=0}){const{width:et,height:nt}=J.attributes.style,dt=[0,0,parseInt(et),parseInt(nt)];return new b({viewBox:dt,scale:q,rotation:Y})}function G(J){if(J.startsWith("#")){const q=parseInt(J.slice(1),16);return[(q&16711680)>>16,(q&65280)>>8,q&255]}return J.startsWith("rgb(")?J.slice(4,-1).split(",").map(q=>parseInt(q)):J.startsWith("rgba(")?J.slice(5,-1).split(",").map(q=>parseInt(q)).slice(0,3):((0,k.warn)(`Not a valid color format: "${J}"`),[0,0,0])}function I(J){const q=document.createElement("span");q.style.visibility="hidden",document.body.append(q);for(const Y of J.keys()){q.style.color=Y;const et=window.getComputedStyle(q).color;J.set(Y,G(et))}q.remove()}function lt(J){const{a:q,b:Y,c:et,d:nt,e:dt,f:pt}=J.getTransform();return[q,Y,et,nt,dt,pt]}function ut(J){const{a:q,b:Y,c:et,d:nt,e:dt,f:pt}=J.getTransform().invertSelf();return[q,Y,et,nt,dt,pt]}},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.BaseStandardFontDataFactory=m.BaseSVGFactory=m.BaseCanvasFactory=m.BaseCMapReaderFactory=void 0;var A=K(1);class k{constructor(){this.constructor===k&&(0,A.unreachable)("Cannot initialize BaseCanvasFactory.")}create(T,E){if(T<=0||E<=0)throw new Error("Invalid canvas size");const R=this._createCanvas(T,E);return{canvas:R,context:R.getContext("2d")}}reset(T,E,R){if(!T.canvas)throw new Error("Canvas is not specified");if(E<=0||R<=0)throw new Error("Invalid canvas size");T.canvas.width=E,T.canvas.height=R}destroy(T){if(!T.canvas)throw new Error("Canvas is not specified");T.canvas.width=0,T.canvas.height=0,T.canvas=null,T.context=null}_createCanvas(T,E){(0,A.unreachable)("Abstract method `_createCanvas` called.")}}m.BaseCanvasFactory=k;class H{constructor({baseUrl:T=null,isCompressed:E=!1}){this.constructor===H&&(0,A.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=T,this.isCompressed=E}async fetch({name:T}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!T)throw new Error("CMap name must be specified.");const E=this.baseUrl+T+(this.isCompressed?".bcmap":""),R=this.isCompressed?A.CMapCompressionType.BINARY:A.CMapCompressionType.NONE;return this._fetchData(E,R).catch(S=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${E}`)})}_fetchData(T,E){(0,A.unreachable)("Abstract method `_fetchData` called.")}}m.BaseCMapReaderFactory=H;class ${constructor({baseUrl:T=null}){this.constructor===$&&(0,A.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=T}async fetch({filename:T}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!T)throw new Error("Font filename must be specified.");const E=`${this.baseUrl}${T}`;return this._fetchData(E).catch(R=>{throw new Error(`Unable to load font data at: ${E}`)})}_fetchData(T){(0,A.unreachable)("Abstract method `_fetchData` called.")}}m.BaseStandardFontDataFactory=$;class W{constructor(){this.constructor===W&&(0,A.unreachable)("Cannot initialize BaseSVGFactory.")}create(T,E,R=!1){if(T<=0||E<=0)throw new Error("Invalid SVG dimensions");const S=this._createSVG("svg:svg");return S.setAttribute("version","1.1"),R||(S.setAttribute("width",`${T}px`),S.setAttribute("height",`${E}px`)),S.setAttribute("preserveAspectRatio","none"),S.setAttribute("viewBox",`0 0 ${T} ${E}`),S}createElement(T){if(typeof T!="string")throw new Error("Invalid SVG element type");return this._createSVG(T)}_createSVG(T){(0,A.unreachable)("Abstract method `_createSVG` called.")}}m.BaseSVGFactory=W},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.MurmurHash3_64=void 0;var A=K(1);const k=3285377520,H=4294901760,$=65535;class W{constructor(T){this.h1=T?T&4294967295:k,this.h2=T?T&4294967295:k}update(T){let E,R;if(typeof T=="string"){E=new Uint8Array(T.length*2),R=0;for(let r=0,u=T.length;r<u;r++){const x=T.charCodeAt(r);x<=255?E[R++]=x:(E[R++]=x>>>8,E[R++]=x&255)}}else if((0,A.isArrayBuffer)(T))E=T.slice(),R=E.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const S=R>>2,b=R-S*4,h=new Uint32Array(E.buffer,0,S);let f=0,s=0,e=this.h1,d=this.h2;const o=3432918353,p=461845907,t=o&$,n=p&$;for(let r=0;r<S;r++)r&1?(f=h[r],f=f*o&H|f*t&$,f=f<<15|f>>>17,f=f*p&H|f*n&$,e^=f,e=e<<13|e>>>19,e=e*5+3864292196):(s=h[r],s=s*o&H|s*t&$,s=s<<15|s>>>17,s=s*p&H|s*n&$,d^=s,d=d<<13|d>>>19,d=d*5+3864292196);switch(f=0,b){case 3:f^=E[S*4+2]<<16;case 2:f^=E[S*4+1]<<8;case 1:f^=E[S*4],f=f*o&H|f*t&$,f=f<<15|f>>>17,f=f*p&H|f*n&$,S&1?e^=f:d^=f}this.h1=e,this.h2=d}hexdigest(){let T=this.h1,E=this.h2;T^=E>>>1,T=T*3981806797&H|T*36045&$,E=E*4283543511&H|((E<<16|T>>>16)*2950163797&H)>>>16,T^=E>>>1,T=T*444984403&H|T*60499&$,E=E*3301882366&H|((E<<16|T>>>16)*3120437893&H)>>>16,T^=E>>>1;const R=(T>>>0).toString(16),S=(E>>>0).toString(16);return R.padStart(8,"0")+S.padStart(8,"0")}}m.MurmurHash3_64=W},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.FontLoader=m.FontFaceObject=void 0;var A=K(1);class k{constructor({onUnsupportedFeature:W,ownerDocument:U=globalThis.document,styleElement:T=null}){this._onUnsupportedFeature=W,this._document=U,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(W){this.nativeFontFaces.push(W),this._document.fonts.add(W)}insertRule(W){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const U=this.styleElement.sheet;U.insertRule(W,U.cssRules.length)}clear(){for(const W of this.nativeFontFaces)this._document.fonts.delete(W);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(W){if(W.attached||W.missingFile)return;if(W.attached=!0,this.isFontLoadingAPISupported){const T=W.createNativeFontFace();if(T){this.addNativeFontFace(T);try{await T.loaded}catch(E){throw this._onUnsupportedFeature({featureId:A.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,A.warn)(`Failed to load font '${T.family}': '${E}'.`),W.disableFontFace=!0,E}}return}const U=W.createFontFaceRule();if(U){if(this.insertRule(U),this.isSyncFontLoadingSupported)return;await new Promise(T=>{const E=this._queueLoadingCallback(T);this._prepareFontLoadEvent(W,E)})}}get isFontLoadingAPISupported(){var U;const W=!!((U=this._document)!=null&&U.fonts);return(0,A.shadow)(this,"isFontLoadingAPISupported",W)}get isSyncFontLoadingSupported(){let W=!1;if(typeof navigator>"u")W=!0;else{const U=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(U==null?void 0:U[1])>=14&&(W=!0)}return(0,A.shadow)(this,"isSyncFontLoadingSupported",W)}_queueLoadingCallback(W){function U(){for((0,A.assert)(!E.done,"completeRequest() cannot be called twice."),E.done=!0;T.length>0&&T[0].done;){const R=T.shift();setTimeout(R.callback,0)}}const{loadingRequests:T}=this,E={done:!1,complete:U,callback:W};return T.push(E),E}get _loadTestFont(){const W=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,A.shadow)(this,"_loadTestFont",W)}_prepareFontLoadEvent(W,U){function T(G,I){return G.charCodeAt(I)<<24|G.charCodeAt(I+1)<<16|G.charCodeAt(I+2)<<8|G.charCodeAt(I+3)&255}function E(G,I,lt,ut){const ot=G.substring(0,I),J=G.substring(I+lt);return ot+ut+J}let R,S;const b=this._document.createElement("canvas");b.width=1,b.height=1;const h=b.getContext("2d");let f=0;function s(G,I){if(++f>30){(0,A.warn)("Load test font never loaded."),I();return}if(h.font="30px "+G,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){I();return}setTimeout(s.bind(null,G,I))}const e=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=E(d,976,e.length,e);const p=16,t=1482184792;let n=T(d,p);for(R=0,S=e.length-3;R<S;R+=4)n=n-t+T(e,R)|0;R<e.length&&(n=n-t+T(e+"XXX",R)|0),d=E(d,p,4,(0,A.string32)(n));const r=`url(data:font/opentype;base64,${btoa(d)});`,u=`@font-face {font-family:"${e}";src:${r}}`;this.insertRule(u);const x=this._document.createElement("div");x.style.visibility="hidden",x.style.width=x.style.height="10px",x.style.position="absolute",x.style.top=x.style.left="0px";for(const G of[W.loadedName,e]){const I=this._document.createElement("span");I.textContent="Hi",I.style.fontFamily=G,x.append(I)}this._document.body.append(x),s(e,()=>{x.remove(),U.complete()})}}m.FontLoader=k;class H{constructor(W,{isEvalSupported:U=!0,disableFontFace:T=!1,ignoreErrors:E=!1,onUnsupportedFeature:R,fontRegistry:S=null}){this.compiledGlyphs=Object.create(null);for(const b in W)this[b]=W[b];this.isEvalSupported=U!==!1,this.disableFontFace=T===!0,this.ignoreErrors=E===!0,this._onUnsupportedFeature=R,this.fontRegistry=S}createNativeFontFace(){var U;if(!this.data||this.disableFontFace)return null;let W;if(!this.cssFontInfo)W=new FontFace(this.loadedName,this.data,{});else{const T={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(T.style=`oblique ${this.cssFontInfo.italicAngle}deg`),W=new FontFace(this.cssFontInfo.fontFamily,this.data,T)}return(U=this.fontRegistry)==null||U.registerFont(this),W}createFontFaceRule(){var E;if(!this.data||this.disableFontFace)return null;const W=(0,A.bytesToString)(this.data),U=`url(data:${this.mimetype};base64,${btoa(W)});`;let T;if(!this.cssFontInfo)T=`@font-face {font-family:"${this.loadedName}";src:${U}}`;else{let R=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(R+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),T=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${R}src:${U}}`}return(E=this.fontRegistry)==null||E.registerFont(this,U),T}getPathGenerator(W,U){if(this.compiledGlyphs[U]!==void 0)return this.compiledGlyphs[U];let T;try{T=W.get(this.loadedName+"_path_"+U)}catch(E){if(!this.ignoreErrors)throw E;return this._onUnsupportedFeature({featureId:A.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,A.warn)(`getPathGenerator - ignoring character: "${E}".`),this.compiledGlyphs[U]=function(R,S){}}if(this.isEvalSupported&&A.FeatureTest.isEvalSupported){const E=[];for(const R of T){const S=R.args!==void 0?R.args.join(","):"";E.push("c.",R.cmd,"(",S,`);
`)}return this.compiledGlyphs[U]=new Function("c","size",E.join(""))}return this.compiledGlyphs[U]=function(E,R){for(const S of T)S.cmd==="scale"&&(S.args=[R,-R]),E[S.cmd].apply(E,S.args)}}}m.FontFaceObject=H},(rt,m,K)=>{var nt,ce;Object.defineProperty(m,"__esModule",{value:!0}),m.CanvasGraphics=void 0;var A=K(1),k=K(6),H=K(11),$=K(13),W=K(12);const U=16,T=100,E=4096,R=15,S=10,b=W.isNodeJS&&typeof Path2D>"u"?-1:1e3,h=16;function f(D,g){if(D._removeMirroring)throw new Error("Context is already forwarding operations.");D.__originalSave=D.save,D.__originalRestore=D.restore,D.__originalRotate=D.rotate,D.__originalScale=D.scale,D.__originalTranslate=D.translate,D.__originalTransform=D.transform,D.__originalSetTransform=D.setTransform,D.__originalResetTransform=D.resetTransform,D.__originalClip=D.clip,D.__originalMoveTo=D.moveTo,D.__originalLineTo=D.lineTo,D.__originalBezierCurveTo=D.bezierCurveTo,D.__originalRect=D.rect,D.__originalClosePath=D.closePath,D.__originalBeginPath=D.beginPath,D._removeMirroring=()=>{D.save=D.__originalSave,D.restore=D.__originalRestore,D.rotate=D.__originalRotate,D.scale=D.__originalScale,D.translate=D.__originalTranslate,D.transform=D.__originalTransform,D.setTransform=D.__originalSetTransform,D.resetTransform=D.__originalResetTransform,D.clip=D.__originalClip,D.moveTo=D.__originalMoveTo,D.lineTo=D.__originalLineTo,D.bezierCurveTo=D.__originalBezierCurveTo,D.rect=D.__originalRect,D.closePath=D.__originalClosePath,D.beginPath=D.__originalBeginPath,delete D._removeMirroring},D.save=function(){g.save(),this.__originalSave()},D.restore=function(){g.restore(),this.__originalRestore()},D.translate=function(y,F){g.translate(y,F),this.__originalTranslate(y,F)},D.scale=function(y,F){g.scale(y,F),this.__originalScale(y,F)},D.transform=function(y,F,O,N,j,Q){g.transform(y,F,O,N,j,Q),this.__originalTransform(y,F,O,N,j,Q)},D.setTransform=function(y,F,O,N,j,Q){g.setTransform(y,F,O,N,j,Q),this.__originalSetTransform(y,F,O,N,j,Q)},D.resetTransform=function(){g.resetTransform(),this.__originalResetTransform()},D.rotate=function(y){g.rotate(y),this.__originalRotate(y)},D.clip=function(y){g.clip(y),this.__originalClip(y)},D.moveTo=function(a,y){g.moveTo(a,y),this.__originalMoveTo(a,y)},D.lineTo=function(a,y){g.lineTo(a,y),this.__originalLineTo(a,y)},D.bezierCurveTo=function(a,y,F,O,N,j){g.bezierCurveTo(a,y,F,O,N,j),this.__originalBezierCurveTo(a,y,F,O,N,j)},D.rect=function(a,y,F,O){g.rect(a,y,F,O),this.__originalRect(a,y,F,O)},D.closePath=function(){g.closePath(),this.__originalClosePath()},D.beginPath=function(){g.beginPath(),this.__originalBeginPath()}}class s{constructor(g){this.canvasFactory=g,this.cache=Object.create(null)}getCanvas(g,a,y){let F;return this.cache[g]!==void 0?(F=this.cache[g],this.canvasFactory.reset(F,a,y)):(F=this.canvasFactory.create(a,y),this.cache[g]=F),F}delete(g){delete this.cache[g]}clear(){for(const g in this.cache){const a=this.cache[g];this.canvasFactory.destroy(a),delete this.cache[g]}}}function e(D,g,a,y,F,O,N,j,Q,tt){const[i,c,_,P,l,w]=(0,k.getCurrentTransform)(D);if(c===0&&_===0){const L=N*i+l,Z=Math.round(L),B=j*P+w,st=Math.round(B),X=(N+Q)*i+l,ct=Math.abs(Math.round(X)-Z)||1,_t=(j+tt)*P+w,gt=Math.abs(Math.round(_t)-st)||1;return D.setTransform(Math.sign(i),0,0,Math.sign(P),Z,st),D.drawImage(g,a,y,F,O,0,0,ct,gt),D.setTransform(i,c,_,P,l,w),[ct,gt]}if(i===0&&P===0){const L=j*_+l,Z=Math.round(L),B=N*c+w,st=Math.round(B),X=(j+tt)*_+l,ct=Math.abs(Math.round(X)-Z)||1,_t=(N+Q)*c+w,gt=Math.abs(Math.round(_t)-st)||1;return D.setTransform(0,Math.sign(c),Math.sign(_),0,Z,st),D.drawImage(g,a,y,F,O,0,0,gt,ct),D.setTransform(i,c,_,P,l,w),[gt,ct]}D.drawImage(g,a,y,F,O,N,j,Q,tt);const v=Math.hypot(i,c),M=Math.hypot(_,P);return[v*Q,M*tt]}function d(D){const{width:g,height:a}=D;if(g>b||a>b)return null;const y=1e3,F=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),O=g+1;let N=new Uint8Array(O*(a+1)),j,Q,tt;const i=g+7&-8;let c=new Uint8Array(i*a),_=0;for(const M of D.data){let L=128;for(;L>0;)c[_++]=M&L?0:255,L>>=1}let P=0;for(_=0,c[_]!==0&&(N[0]=1,++P),Q=1;Q<g;Q++)c[_]!==c[_+1]&&(N[Q]=c[_]?2:1,++P),_++;for(c[_]!==0&&(N[Q]=2,++P),j=1;j<a;j++){_=j*i,tt=j*O,c[_-i]!==c[_]&&(N[tt]=c[_]?1:8,++P);let M=(c[_]?4:0)+(c[_-i]?8:0);for(Q=1;Q<g;Q++)M=(M>>2)+(c[_+1]?4:0)+(c[_-i+1]?8:0),F[M]&&(N[tt+Q]=F[M],++P),_++;if(c[_-i]!==c[_]&&(N[tt+Q]=c[_]?2:4,++P),P>y)return null}for(_=i*(a-1),tt=j*O,c[_]!==0&&(N[tt]=8,++P),Q=1;Q<g;Q++)c[_]!==c[_+1]&&(N[tt+Q]=c[_]?4:8,++P),_++;if(c[_]!==0&&(N[tt+Q]=4,++P),P>y)return null;const l=new Int32Array([0,O,-1,0,-O,0,0,0,1]),w=new Path2D;for(j=0;P&&j<=a;j++){let M=j*O;const L=M+g;for(;M<L&&!N[M];)M++;if(M===L)continue;w.moveTo(M%O,j);const Z=M;let B=N[M];do{const st=l[B];do M+=st;while(!N[M]);const X=N[M];X!==5&&X!==10?(B=X,N[M]=0):(B=X&51*B>>4,N[M]&=B>>2|B<<2),w.lineTo(M%O,M/O|0),N[M]||--P}while(Z!==M);--j}return c=null,N=null,function(M){M.save(),M.scale(1/g,-1/a),M.translate(0,-a),M.fill(w),M.beginPath(),M.restore()}}class o{constructor(g,a){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=A.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=A.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=A.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,g,a])}clone(){const g=Object.create(this);return g.clipBox=this.clipBox.slice(),g}setCurrentPoint(g,a){this.x=g,this.y=a}updatePathMinMax(g,a,y){[a,y]=A.Util.applyTransform([a,y],g),this.minX=Math.min(this.minX,a),this.minY=Math.min(this.minY,y),this.maxX=Math.max(this.maxX,a),this.maxY=Math.max(this.maxY,y)}updateRectMinMax(g,a){const y=A.Util.applyTransform(a,g),F=A.Util.applyTransform(a.slice(2),g);this.minX=Math.min(this.minX,y[0],F[0]),this.minY=Math.min(this.minY,y[1],F[1]),this.maxX=Math.max(this.maxX,y[0],F[0]),this.maxY=Math.max(this.maxY,y[1],F[1])}updateScalingPathMinMax(g,a){A.Util.scaleMinMax(g,a),this.minX=Math.min(this.minX,a[0]),this.maxX=Math.max(this.maxX,a[1]),this.minY=Math.min(this.minY,a[2]),this.maxY=Math.max(this.maxY,a[3])}updateCurvePathMinMax(g,a,y,F,O,N,j,Q,tt,i){const c=A.Util.bezierBoundingBox(a,y,F,O,N,j,Q,tt);if(i){i[0]=Math.min(i[0],c[0],c[2]),i[1]=Math.max(i[1],c[0],c[2]),i[2]=Math.min(i[2],c[1],c[3]),i[3]=Math.max(i[3],c[1],c[3]);return}this.updateRectMinMax(g,c)}getPathBoundingBox(g=H.PathType.FILL,a=null){const y=[this.minX,this.minY,this.maxX,this.maxY];if(g===H.PathType.STROKE){a||(0,A.unreachable)("Stroke bounding box must include transform.");const F=A.Util.singularValueDecompose2dScale(a),O=F[0]*this.lineWidth/2,N=F[1]*this.lineWidth/2;y[0]-=O,y[1]-=N,y[2]+=O,y[3]+=N}return y}updateClipFromPath(){const g=A.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(g||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(g){this.clipBox=g,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(g=H.PathType.FILL,a=null){return A.Util.intersect(this.clipBox,this.getPathBoundingBox(g,a))}}function p(D,g,a=null){if(typeof ImageData<"u"&&g instanceof ImageData){D.putImageData(g,0,0);return}const y=g.height,F=g.width,O=y%h,N=(y-O)/h,j=O===0?N:N+1,Q=D.createImageData(F,h);let tt=0,i;const c=g.data,_=Q.data;let P,l,w,v,M,L,Z,B;if(a)switch(a.length){case 1:M=a[0],L=a[0],Z=a[0],B=a[0];break;case 4:M=a[0],L=a[1],Z=a[2],B=a[3];break}if(g.kind===A.ImageKind.GRAYSCALE_1BPP){const st=c.byteLength,X=new Uint32Array(_.buffer,0,_.byteLength>>2),ct=X.length,_t=F+7>>3;let gt=4294967295,bt=A.FeatureTest.isLittleEndian?4278190080:255;for(B&&B[0]===255&&B[255]===0&&([gt,bt]=[bt,gt]),P=0;P<j;P++){for(w=P<N?h:O,i=0,l=0;l<w;l++){const yt=st-tt;let Et=0;const vt=yt>_t?F:yt*8-7,wt=vt&-8;let St=0,Ct=0;for(;Et<wt;Et+=8)Ct=c[tt++],X[i++]=Ct&128?gt:bt,X[i++]=Ct&64?gt:bt,X[i++]=Ct&32?gt:bt,X[i++]=Ct&16?gt:bt,X[i++]=Ct&8?gt:bt,X[i++]=Ct&4?gt:bt,X[i++]=Ct&2?gt:bt,X[i++]=Ct&1?gt:bt;for(;Et<vt;Et++)St===0&&(Ct=c[tt++],St=128),X[i++]=Ct&St?gt:bt,St>>=1}for(;i<ct;)X[i++]=0;D.putImageData(Q,0,P*h)}}else if(g.kind===A.ImageKind.RGBA_32BPP){const st=!!(M||L||Z);for(l=0,v=F*h*4,P=0;P<N;P++){if(_.set(c.subarray(tt,tt+v)),tt+=v,st)for(let X=0;X<v;X+=4)M&&(_[X+0]=M[_[X+0]]),L&&(_[X+1]=L[_[X+1]]),Z&&(_[X+2]=Z[_[X+2]]);D.putImageData(Q,0,l),l+=h}if(P<j){if(v=F*O*4,_.set(c.subarray(tt,tt+v)),st)for(let X=0;X<v;X+=4)M&&(_[X+0]=M[_[X+0]]),L&&(_[X+1]=L[_[X+1]]),Z&&(_[X+2]=Z[_[X+2]]);D.putImageData(Q,0,l)}}else if(g.kind===A.ImageKind.RGB_24BPP){const st=!!(M||L||Z);for(w=h,v=F*w,P=0;P<j;P++){for(P>=N&&(w=O,v=F*w),i=0,l=v;l--;)_[i++]=c[tt++],_[i++]=c[tt++],_[i++]=c[tt++],_[i++]=255;if(st)for(let X=0;X<i;X+=4)M&&(_[X+0]=M[_[X+0]]),L&&(_[X+1]=L[_[X+1]]),Z&&(_[X+2]=Z[_[X+2]]);D.putImageData(Q,0,P*h)}}else throw new Error(`bad image kind: ${g.kind}`)}function t(D,g){if(g.bitmap){D.drawImage(g.bitmap,0,0);return}const a=g.height,y=g.width,F=a%h,O=(a-F)/h,N=F===0?O:O+1,j=D.createImageData(y,h);let Q=0;const tt=g.data,i=j.data;for(let c=0;c<N;c++){const _=c<O?h:F;({srcPos:Q}=(0,$.applyMaskImageData)({src:tt,srcPos:Q,dest:i,width:y,height:_})),D.putImageData(j,0,c*h)}}function n(D,g){const a=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(const y of a)D[y]!==void 0&&(g[y]=D[y]);D.setLineDash!==void 0&&(g.setLineDash(D.getLineDash()),g.lineDashOffset=D.lineDashOffset)}function r(D,g){D.strokeStyle=D.fillStyle=g||"#000000",D.fillRule="nonzero",D.globalAlpha=1,D.lineWidth=1,D.lineCap="butt",D.lineJoin="miter",D.miterLimit=10,D.globalCompositeOperation="source-over",D.font="10px sans-serif",D.setLineDash!==void 0&&(D.setLineDash([]),D.lineDashOffset=0)}function u(D,g,a,y){const F=D.length;for(let O=3;O<F;O+=4){const N=D[O];if(N===0)D[O-3]=g,D[O-2]=a,D[O-1]=y;else if(N<255){const j=255-N;D[O-3]=D[O-3]*N+g*j>>8,D[O-2]=D[O-2]*N+a*j>>8,D[O-1]=D[O-1]*N+y*j>>8}}}function x(D,g,a){const y=D.length,F=1/255;for(let O=3;O<y;O+=4){const N=a?a[D[O]]:D[O];g[O]=g[O]*N*F|0}}function G(D,g,a){const y=D.length;for(let F=3;F<y;F+=4){const O=D[F-3]*77+D[F-2]*152+D[F-1]*28;g[F]=a?g[F]*a[O>>8]>>8:g[F]*O>>16}}function I(D,g,a,y,F,O,N,j,Q,tt,i){const c=!!O,_=c?O[0]:0,P=c?O[1]:0,l=c?O[2]:0;let w;F==="Luminosity"?w=G:w=x;const M=Math.min(y,Math.ceil(1048576/a));for(let L=0;L<y;L+=M){const Z=Math.min(M,y-L),B=D.getImageData(j-tt,L+(Q-i),a,Z),st=g.getImageData(j,L+Q,a,Z);c&&u(B.data,_,P,l),w(B.data,st.data,N),g.putImageData(st,j,L+Q)}}function lt(D,g,a,y){const F=y[0],O=y[1],N=y[2]-F,j=y[3]-O;N===0||j===0||(I(g.context,a,N,j,g.subtype,g.backdrop,g.transferMap,F,O,g.offsetX,g.offsetY),D.save(),D.globalAlpha=1,D.globalCompositeOperation="source-over",D.setTransform(1,0,0,1,0,0),D.drawImage(a.canvas,0,0),D.restore())}function ut(D,g){const a=A.Util.singularValueDecompose2dScale(D);a[0]=Math.fround(a[0]),a[1]=Math.fround(a[1]);const y=Math.fround((globalThis.devicePixelRatio||1)*k.PixelsPerInch.PDF_TO_CSS_UNITS);return g!==void 0?g:a[0]<=y||a[1]<=y}const ot=["butt","round","square"],J=["miter","round","bevel"],q={},Y={},pt=class pt{constructor(g,a,y,F,O,N,j){ht(this,nt);this.ctx=g,this.current=new o(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=a,this.objs=y,this.canvasFactory=F,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=O,this.cachedCanvases=new s(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=N,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(j==null?void 0:j.background)||null,this.foregroundColor=(j==null?void 0:j.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(g,a=null){return typeof g=="string"?g.startsWith("g_")?this.commonObjs.get(g):this.objs.get(g):a}beginDrawing({transform:g,viewport:a,transparency:y=!1,background:F=null}){const O=this.ctx.canvas.width,N=this.ctx.canvas.height,j=F||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const Q=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const tt=this.backgroundColor=this.ctx.fillStyle;let i=!0,c=j;if(this.ctx.fillStyle=j,c=this.ctx.fillStyle,i=typeof c=="string"&&/^#[0-9A-Fa-f]{6}$/.test(c),Q==="#000000"&&tt==="#ffffff"||Q===tt||!i)this.foregroundColor=this.backgroundColor=null;else{const[_,P,l]=(0,k.getRGB)(c),w=M=>(M/=255,M<=.03928?M/12.92:((M+.055)/1.055)**2.4),v=Math.round(.2126*w(_)+.7152*w(P)+.0722*w(l));this.selectColor=(M,L,Z)=>{const B=.2126*w(M)+.7152*w(L)+.0722*w(Z);return Math.round(B)===v?tt:Q}}}if(this.ctx.fillStyle=this.backgroundColor||j,this.ctx.fillRect(0,0,O,N),this.ctx.restore(),y){const Q=this.cachedCanvases.getCanvas("transparent",O,N);this.compositeCtx=this.ctx,this.transparentCanvas=Q.canvas,this.ctx=Q.context,this.ctx.save(),this.ctx.transform(...(0,k.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),r(this.ctx,this.foregroundColor),g&&(this.ctx.transform(...g),this.outputScaleX=g[0],this.outputScaleY=g[0]),this.ctx.transform(...a.transform),this.viewportScale=a.scale,this.baseTransform=(0,k.getCurrentTransform)(this.ctx)}executeOperatorList(g,a,y,F){const O=g.argsArray,N=g.fnArray;let j=a||0;const Q=O.length;if(Q===j)return j;const tt=Q-j>S&&typeof y=="function",i=tt?Date.now()+R:0;let c=0;const _=this.commonObjs,P=this.objs;let l;for(;;){if(F!==void 0&&j===F.nextBreakPoint)return F.breakIt(j,y),j;if(l=N[j],l!==A.OPS.dependency)this[l].apply(this,O[j]);else for(const w of O[j]){const v=w.startsWith("g_")?_:P;if(!v.has(w))return v.get(w,y),j}if(j++,j===Q)return j;if(tt&&++c>S){if(Date.now()>i)return y(),j;c=0}}}endDrawing(){at(this,nt,ce).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const g of this._cachedBitmapsMap.values()){for(const a of g.values())typeof HTMLCanvasElement<"u"&&a instanceof HTMLCanvasElement&&(a.width=a.height=0);g.clear()}this._cachedBitmapsMap.clear()}_scaleImage(g,a){const y=g.width,F=g.height;let O=Math.max(Math.hypot(a[0],a[1]),1),N=Math.max(Math.hypot(a[2],a[3]),1),j=y,Q=F,tt="prescale1",i,c;for(;O>2&&j>1||N>2&&Q>1;){let _=j,P=Q;O>2&&j>1&&(_=Math.ceil(j/2),O/=j/_),N>2&&Q>1&&(P=Math.ceil(Q/2),N/=Q/P),i=this.cachedCanvases.getCanvas(tt,_,P),c=i.context,c.clearRect(0,0,_,P),c.drawImage(g,0,0,j,Q,0,0,_,P),g=i.canvas,j=_,Q=P,tt=tt==="prescale1"?"prescale2":"prescale1"}return{img:g,paintWidth:j,paintHeight:Q}}_createMaskCanvas(g){const a=this.ctx,{width:y,height:F}=g,O=this.current.fillColor,N=this.current.patternFill,j=(0,k.getCurrentTransform)(a);let Q,tt,i,c;if((g.bitmap||g.data)&&g.count>1){const ct=g.bitmap||g.data.buffer;tt=JSON.stringify(N?j:[j.slice(0,4),O]),Q=this._cachedBitmapsMap.get(ct),Q||(Q=new Map,this._cachedBitmapsMap.set(ct,Q));const _t=Q.get(tt);if(_t&&!N){const gt=Math.round(Math.min(j[0],j[2])+j[4]),bt=Math.round(Math.min(j[1],j[3])+j[5]);return{canvas:_t,offsetX:gt,offsetY:bt}}i=_t}i||(c=this.cachedCanvases.getCanvas("maskCanvas",y,F),t(c.context,g));let _=A.Util.transform(j,[1/y,0,0,-1/F,0,0]);_=A.Util.transform(_,[1,0,0,1,0,-F]);const P=A.Util.applyTransform([0,0],_),l=A.Util.applyTransform([y,F],_),w=A.Util.normalizeRect([P[0],P[1],l[0],l[1]]),v=Math.round(w[2]-w[0])||1,M=Math.round(w[3]-w[1])||1,L=this.cachedCanvases.getCanvas("fillCanvas",v,M),Z=L.context,B=Math.min(P[0],l[0]),st=Math.min(P[1],l[1]);Z.translate(-B,-st),Z.transform(..._),i||(i=this._scaleImage(c.canvas,(0,k.getCurrentTransformInverse)(Z)),i=i.img,Q&&N&&Q.set(tt,i)),Z.imageSmoothingEnabled=ut((0,k.getCurrentTransform)(Z),g.interpolate),e(Z,i,0,0,i.width,i.height,0,0,y,F),Z.globalCompositeOperation="source-in";const X=A.Util.transform((0,k.getCurrentTransformInverse)(Z),[1,0,0,1,-B,-st]);return Z.fillStyle=N?O.getPattern(a,this,X,H.PathType.FILL):O,Z.fillRect(0,0,y,F),Q&&!N&&(this.cachedCanvases.delete("fillCanvas"),Q.set(tt,L.canvas)),{canvas:L.canvas,offsetX:Math.round(B),offsetY:Math.round(st)}}setLineWidth(g){g!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=g,this.ctx.lineWidth=g}setLineCap(g){this.ctx.lineCap=ot[g]}setLineJoin(g){this.ctx.lineJoin=J[g]}setMiterLimit(g){this.ctx.miterLimit=g}setDash(g,a){const y=this.ctx;y.setLineDash!==void 0&&(y.setLineDash(g),y.lineDashOffset=a)}setRenderingIntent(g){}setFlatness(g){}setGState(g){for(const[a,y]of g)switch(a){case"LW":this.setLineWidth(y);break;case"LC":this.setLineCap(y);break;case"LJ":this.setLineJoin(y);break;case"ML":this.setMiterLimit(y);break;case"D":this.setDash(y[0],y[1]);break;case"RI":this.setRenderingIntent(y);break;case"FL":this.setFlatness(y);break;case"Font":this.setFont(y[0],y[1]);break;case"CA":this.current.strokeAlpha=y;break;case"ca":this.current.fillAlpha=y,this.ctx.globalAlpha=y;break;case"BM":this.ctx.globalCompositeOperation=y;break;case"SMask":this.current.activeSMask=y?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=y}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const g=this.inSMaskMode;this.current.activeSMask&&!g?this.beginSMaskMode():!this.current.activeSMask&&g&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const g=this.ctx.canvas.width,a=this.ctx.canvas.height,y="smaskGroupAt"+this.groupLevel,F=this.cachedCanvases.getCanvas(y,g,a);this.suspendedCtx=this.ctx,this.ctx=F.context;const O=this.ctx;O.setTransform(...(0,k.getCurrentTransform)(this.suspendedCtx)),n(this.suspendedCtx,O),f(O,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),n(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(g){if(!this.current.activeSMask)return;g?(g[0]=Math.floor(g[0]),g[1]=Math.floor(g[1]),g[2]=Math.ceil(g[2]),g[3]=Math.ceil(g[3])):g=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const a=this.current.activeSMask,y=this.suspendedCtx;lt(y,a,this.ctx,g),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(n(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const g=this.current;this.stateStack.push(g),this.current=g.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),n(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(g,a,y,F,O,N){this.ctx.transform(g,a,y,F,O,N),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(g,a,y){const F=this.ctx,O=this.current;let N=O.x,j=O.y,Q,tt;const i=(0,k.getCurrentTransform)(F),c=i[0]===0&&i[3]===0||i[1]===0&&i[2]===0,_=c?y.slice(0):null;for(let P=0,l=0,w=g.length;P<w;P++)switch(g[P]|0){case A.OPS.rectangle:N=a[l++],j=a[l++];const v=a[l++],M=a[l++],L=N+v,Z=j+M;F.moveTo(N,j),v===0||M===0?F.lineTo(L,Z):(F.lineTo(L,j),F.lineTo(L,Z),F.lineTo(N,Z)),c||O.updateRectMinMax(i,[N,j,L,Z]),F.closePath();break;case A.OPS.moveTo:N=a[l++],j=a[l++],F.moveTo(N,j),c||O.updatePathMinMax(i,N,j);break;case A.OPS.lineTo:N=a[l++],j=a[l++],F.lineTo(N,j),c||O.updatePathMinMax(i,N,j);break;case A.OPS.curveTo:Q=N,tt=j,N=a[l+4],j=a[l+5],F.bezierCurveTo(a[l],a[l+1],a[l+2],a[l+3],N,j),O.updateCurvePathMinMax(i,Q,tt,a[l],a[l+1],a[l+2],a[l+3],N,j,_),l+=6;break;case A.OPS.curveTo2:Q=N,tt=j,F.bezierCurveTo(N,j,a[l],a[l+1],a[l+2],a[l+3]),O.updateCurvePathMinMax(i,Q,tt,N,j,a[l],a[l+1],a[l+2],a[l+3],_),N=a[l+2],j=a[l+3],l+=4;break;case A.OPS.curveTo3:Q=N,tt=j,N=a[l+2],j=a[l+3],F.bezierCurveTo(a[l],a[l+1],N,j,N,j),O.updateCurvePathMinMax(i,Q,tt,a[l],a[l+1],N,j,N,j,_),l+=4;break;case A.OPS.closePath:F.closePath();break}c&&O.updateScalingPathMinMax(i,_),O.setCurrentPoint(N,j)}closePath(){this.ctx.closePath()}stroke(g){g=typeof g<"u"?g:!0;const a=this.ctx,y=this.current.strokeColor;a.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof y=="object"&&(y!=null&&y.getPattern)?(a.save(),a.strokeStyle=y.getPattern(a,this,(0,k.getCurrentTransformInverse)(a),H.PathType.STROKE),this.rescaleAndStroke(!1),a.restore()):this.rescaleAndStroke(!0)),g&&this.consumePath(this.current.getClippedPathBoundingBox()),a.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(g){g=typeof g<"u"?g:!0;const a=this.ctx,y=this.current.fillColor,F=this.current.patternFill;let O=!1;F&&(a.save(),a.fillStyle=y.getPattern(a,this,(0,k.getCurrentTransformInverse)(a),H.PathType.FILL),O=!0);const N=this.current.getClippedPathBoundingBox();this.contentVisible&&N!==null&&(this.pendingEOFill?(a.fill("evenodd"),this.pendingEOFill=!1):a.fill()),O&&a.restore(),g&&this.consumePath(N)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=q}eoClip(){this.pendingClip=Y}beginText(){this.current.textMatrix=A.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const g=this.pendingTextPaths,a=this.ctx;if(g===void 0){a.beginPath();return}a.save(),a.beginPath();for(const y of g)a.setTransform(...y.transform),a.translate(y.x,y.y),y.addToPath(a,y.fontSize);a.restore(),a.clip(),a.beginPath(),delete this.pendingTextPaths}setCharSpacing(g){this.current.charSpacing=g}setWordSpacing(g){this.current.wordSpacing=g}setHScale(g){this.current.textHScale=g/100}setLeading(g){this.current.leading=-g}setFont(g,a){const y=this.commonObjs.get(g),F=this.current;if(!y)throw new Error(`Can't find font for ${g}`);if(F.fontMatrix=y.fontMatrix||A.FONT_IDENTITY_MATRIX,(F.fontMatrix[0]===0||F.fontMatrix[3]===0)&&(0,A.warn)("Invalid font matrix for font "+g),a<0?(a=-a,F.fontDirection=-1):F.fontDirection=1,this.current.font=y,this.current.fontSize=a,y.isType3Font)return;const O=y.loadedName||"sans-serif";let N="normal";y.black?N="900":y.bold&&(N="bold");const j=y.italic?"italic":"normal",Q=`"${O}", ${y.fallbackName}`;let tt=a;a<U?tt=U:a>T&&(tt=T),this.current.fontSizeScale=a/tt,this.ctx.font=`${j} ${N} ${tt}px ${Q}`}setTextRenderingMode(g){this.current.textRenderingMode=g}setTextRise(g){this.current.textRise=g}moveText(g,a){this.current.x=this.current.lineX+=g,this.current.y=this.current.lineY+=a}setLeadingMoveText(g,a){this.setLeading(-a),this.moveText(g,a)}setTextMatrix(g,a,y,F,O,N){this.current.textMatrix=[g,a,y,F,O,N],this.current.textMatrixScale=Math.hypot(g,a),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(g,a,y,F){const O=this.ctx,N=this.current,j=N.font,Q=N.textRenderingMode,tt=N.fontSize/N.fontSizeScale,i=Q&A.TextRenderingMode.FILL_STROKE_MASK,c=!!(Q&A.TextRenderingMode.ADD_TO_PATH_FLAG),_=N.patternFill&&!j.missingFile;let P;(j.disableFontFace||c||_)&&(P=j.getPathGenerator(this.commonObjs,g)),j.disableFontFace||_?(O.save(),O.translate(a,y),O.beginPath(),P(O,tt),F&&O.setTransform(...F),(i===A.TextRenderingMode.FILL||i===A.TextRenderingMode.FILL_STROKE)&&O.fill(),(i===A.TextRenderingMode.STROKE||i===A.TextRenderingMode.FILL_STROKE)&&O.stroke(),O.restore()):((i===A.TextRenderingMode.FILL||i===A.TextRenderingMode.FILL_STROKE)&&O.fillText(g,a,y),(i===A.TextRenderingMode.STROKE||i===A.TextRenderingMode.FILL_STROKE)&&O.strokeText(g,a,y)),c&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,k.getCurrentTransform)(O),x:a,y,fontSize:tt,addToPath:P})}get isFontSubpixelAAEnabled(){const{context:g}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);g.scale(1.5,1),g.fillText("I",0,10);const a=g.getImageData(0,0,10,10).data;let y=!1;for(let F=3;F<a.length;F+=4)if(a[F]>0&&a[F]<255){y=!0;break}return(0,A.shadow)(this,"isFontSubpixelAAEnabled",y)}showText(g){const a=this.current,y=a.font;if(y.isType3Font)return this.showType3Text(g);const F=a.fontSize;if(F===0)return;const O=this.ctx,N=a.fontSizeScale,j=a.charSpacing,Q=a.wordSpacing,tt=a.fontDirection,i=a.textHScale*tt,c=g.length,_=y.vertical,P=_?1:-1,l=y.defaultVMetrics,w=F*a.fontMatrix[0],v=a.textRenderingMode===A.TextRenderingMode.FILL&&!y.disableFontFace&&!a.patternFill;O.save(),O.transform(...a.textMatrix),O.translate(a.x,a.y+a.textRise),tt>0?O.scale(i,-1):O.scale(i,1);let M;if(a.patternFill){O.save();const X=a.fillColor.getPattern(O,this,(0,k.getCurrentTransformInverse)(O),H.PathType.FILL);M=(0,k.getCurrentTransform)(O),O.restore(),O.fillStyle=X}let L=a.lineWidth;const Z=a.textMatrixScale;if(Z===0||L===0){const X=a.textRenderingMode&A.TextRenderingMode.FILL_STROKE_MASK;(X===A.TextRenderingMode.STROKE||X===A.TextRenderingMode.FILL_STROKE)&&(L=this.getSinglePixelWidth())}else L/=Z;N!==1&&(O.scale(N,N),L/=N),O.lineWidth=L;let B=0,st;for(st=0;st<c;++st){const X=g[st];if(typeof X=="number"){B+=P*X*F/1e3;continue}let ct=!1;const _t=(X.isSpace?Q:0)+j,gt=X.fontChar,bt=X.accent;let yt,Et,vt=X.width;if(_){const St=X.vmetric||l,Ct=-(X.vmetric?St[1]:vt*.5)*w,Dt=St[2]*w;vt=St?-St[0]:vt,yt=Ct/N,Et=(B+Dt)/N}else yt=B/N,Et=0;if(y.remeasure&&vt>0){const St=O.measureText(gt).width*1e3/F*N;if(vt<St&&this.isFontSubpixelAAEnabled){const Ct=vt/St;ct=!0,O.save(),O.scale(Ct,1),yt/=Ct}else vt!==St&&(yt+=(vt-St)/2e3*F/N)}if(this.contentVisible&&(X.isInFont||y.missingFile)){if(v&&!bt)O.fillText(gt,yt,Et);else if(this.paintChar(gt,yt,Et,M),bt){const St=yt+F*bt.offset.x/N,Ct=Et-F*bt.offset.y/N;this.paintChar(bt.fontChar,St,Ct,M)}}let wt;_?wt=vt*w-_t*tt:wt=vt*w+_t*tt,B+=wt,ct&&O.restore()}_?a.y-=B:a.x+=B*i,O.restore(),this.compose()}showType3Text(g){const a=this.ctx,y=this.current,F=y.font,O=y.fontSize,N=y.fontDirection,j=F.vertical?1:-1,Q=y.charSpacing,tt=y.wordSpacing,i=y.textHScale*N,c=y.fontMatrix||A.FONT_IDENTITY_MATRIX,_=g.length,P=y.textRenderingMode===A.TextRenderingMode.INVISIBLE;let l,w,v,M;if(!(P||O===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,a.save(),a.transform(...y.textMatrix),a.translate(y.x,y.y),a.scale(i,N),l=0;l<_;++l){if(w=g[l],typeof w=="number"){M=j*w*O/1e3,this.ctx.translate(M,0),y.x+=M*i;continue}const L=(w.isSpace?tt:0)+Q,Z=F.charProcOperatorList[w.operatorListId];if(!Z){(0,A.warn)(`Type3 character "${w.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=w,this.save(),a.scale(O,O),a.transform(...c),this.executeOperatorList(Z),this.restore()),v=A.Util.applyTransform([w.width,0],c)[0]*O+L,a.translate(v,0),y.x+=v*i}a.restore(),this.processingType3=null}}setCharWidth(g,a){}setCharWidthAndBounds(g,a,y,F,O,N){this.ctx.rect(y,F,O-y,N-F),this.ctx.clip(),this.endPath()}getColorN_Pattern(g){let a;if(g[0]==="TilingPattern"){const y=g[1],F=this.baseTransform||(0,k.getCurrentTransform)(this.ctx),O={createCanvasGraphics:N=>new pt(N,this.commonObjs,this.objs,this.canvasFactory)};a=new H.TilingPattern(g,y,this.ctx,O,F)}else a=this._getPattern(g[1],g[2]);return a}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(g,a,y){var O;const F=((O=this.selectColor)==null?void 0:O.call(this,g,a,y))||A.Util.makeHexColor(g,a,y);this.ctx.strokeStyle=F,this.current.strokeColor=F}setFillRGBColor(g,a,y){var O;const F=((O=this.selectColor)==null?void 0:O.call(this,g,a,y))||A.Util.makeHexColor(g,a,y);this.ctx.fillStyle=F,this.current.fillColor=F,this.current.patternFill=!1}_getPattern(g,a=null){let y;return this.cachedPatterns.has(g)?y=this.cachedPatterns.get(g):(y=(0,H.getShadingPattern)(this.objs.get(g)),this.cachedPatterns.set(g,y)),a&&(y.matrix=a),y}shadingFill(g){if(!this.contentVisible)return;const a=this.ctx;this.save();const y=this._getPattern(g);a.fillStyle=y.getPattern(a,this,(0,k.getCurrentTransformInverse)(a),H.PathType.SHADING);const F=(0,k.getCurrentTransformInverse)(a);if(F){const O=a.canvas,N=O.width,j=O.height,Q=A.Util.applyTransform([0,0],F),tt=A.Util.applyTransform([0,j],F),i=A.Util.applyTransform([N,0],F),c=A.Util.applyTransform([N,j],F),_=Math.min(Q[0],tt[0],i[0],c[0]),P=Math.min(Q[1],tt[1],i[1],c[1]),l=Math.max(Q[0],tt[0],i[0],c[0]),w=Math.max(Q[1],tt[1],i[1],c[1]);this.ctx.fillRect(_,P,l-_,w-P)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,A.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,A.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(g,a){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(g)&&g.length===6&&this.transform(...g),this.baseTransform=(0,k.getCurrentTransform)(this.ctx),a)){const y=a[2]-a[0],F=a[3]-a[1];this.ctx.rect(a[0],a[1],y,F),this.current.updateRectMinMax((0,k.getCurrentTransform)(this.ctx),a),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(g){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const a=this.ctx;g.isolated||(0,A.info)("TODO: Support non-isolated groups."),g.knockout&&(0,A.warn)("Knockout groups not supported.");const y=(0,k.getCurrentTransform)(a);if(g.matrix&&a.transform(...g.matrix),!g.bbox)throw new Error("Bounding box is required.");let F=A.Util.getAxialAlignedBoundingBox(g.bbox,(0,k.getCurrentTransform)(a));const O=[0,0,a.canvas.width,a.canvas.height];F=A.Util.intersect(F,O)||[0,0,0,0];const N=Math.floor(F[0]),j=Math.floor(F[1]);let Q=Math.max(Math.ceil(F[2])-N,1),tt=Math.max(Math.ceil(F[3])-j,1),i=1,c=1;Q>E&&(i=Q/E,Q=E),tt>E&&(c=tt/E,tt=E),this.current.startNewPathAndClipBox([0,0,Q,tt]);let _="groupAt"+this.groupLevel;g.smask&&(_+="_smask_"+this.smaskCounter++%2);const P=this.cachedCanvases.getCanvas(_,Q,tt),l=P.context;l.scale(1/i,1/c),l.translate(-N,-j),l.transform(...y),g.smask?this.smaskStack.push({canvas:P.canvas,context:l,offsetX:N,offsetY:j,scaleX:i,scaleY:c,subtype:g.smask.subtype,backdrop:g.smask.backdrop,transferMap:g.smask.transferMap||null,startTransformInverse:null}):(a.setTransform(1,0,0,1,0,0),a.translate(N,j),a.scale(i,c),a.save()),n(a,l),this.ctx=l,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(a),this.groupLevel++}endGroup(g){if(!this.contentVisible)return;this.groupLevel--;const a=this.ctx,y=this.groupStack.pop();if(this.ctx=y,this.ctx.imageSmoothingEnabled=!1,g.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const F=(0,k.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...F);const O=A.Util.getAxialAlignedBoundingBox([0,0,a.canvas.width,a.canvas.height],F);this.ctx.drawImage(a.canvas,0,0),this.ctx.restore(),this.compose(O)}}beginAnnotation(g,a,y,F,O){if(at(this,nt,ce).call(this),r(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(a)&&a.length===4){const N=a[2]-a[0],j=a[3]-a[1];if(O&&this.annotationCanvasMap){y=y.slice(),y[4]-=a[0],y[5]-=a[1],a=a.slice(),a[0]=a[1]=0,a[2]=N,a[3]=j;const[Q,tt]=A.Util.singularValueDecompose2dScale((0,k.getCurrentTransform)(this.ctx)),{viewportScale:i}=this,c=Math.ceil(N*this.outputScaleX*i),_=Math.ceil(j*this.outputScaleY*i);this.annotationCanvas=this.canvasFactory.create(c,_);const{canvas:P,context:l}=this.annotationCanvas;this.annotationCanvasMap.set(g,P),this.annotationCanvas.savedCtx=this.ctx,this.ctx=l,this.ctx.setTransform(Q,0,0,-tt,0,j*tt),r(this.ctx,this.foregroundColor)}else r(this.ctx,this.foregroundColor),this.ctx.rect(a[0],a[1],N,j),this.ctx.clip(),this.endPath()}this.current=new o(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...y),this.transform(...F)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(g){if(!this.contentVisible)return;const a=g.count;g=this.getObject(g.data,g),g.count=a;const y=this.ctx,F=this.processingType3;if(F&&(F.compiled===void 0&&(F.compiled=d(g)),F.compiled)){F.compiled(y);return}const O=this._createMaskCanvas(g),N=O.canvas;y.save(),y.setTransform(1,0,0,1,0,0),y.drawImage(N,O.offsetX,O.offsetY),y.restore(),this.compose()}paintImageMaskXObjectRepeat(g,a,y=0,F=0,O,N){if(!this.contentVisible)return;g=this.getObject(g.data,g);const j=this.ctx;j.save();const Q=(0,k.getCurrentTransform)(j);j.transform(a,y,F,O,0,0);const tt=this._createMaskCanvas(g);j.setTransform(1,0,0,1,0,0);for(let i=0,c=N.length;i<c;i+=2){const _=A.Util.transform(Q,[a,y,F,O,N[i],N[i+1]]),[P,l]=A.Util.applyTransform([0,0],_);j.drawImage(tt.canvas,P,l)}j.restore(),this.compose()}paintImageMaskXObjectGroup(g){if(!this.contentVisible)return;const a=this.ctx,y=this.current.fillColor,F=this.current.patternFill;for(const O of g){const{data:N,width:j,height:Q,transform:tt}=O,i=this.cachedCanvases.getCanvas("maskCanvas",j,Q),c=i.context;c.save();const _=this.getObject(N,O);t(c,_),c.globalCompositeOperation="source-in",c.fillStyle=F?y.getPattern(c,this,(0,k.getCurrentTransformInverse)(a),H.PathType.FILL):y,c.fillRect(0,0,j,Q),c.restore(),a.save(),a.transform(...tt),a.scale(1,-1),e(a,i.canvas,0,0,j,Q,0,-1,1,1),a.restore()}this.compose()}paintImageXObject(g){if(!this.contentVisible)return;const a=this.getObject(g);if(!a){(0,A.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(a)}paintImageXObjectRepeat(g,a,y,F){if(!this.contentVisible)return;const O=this.getObject(g);if(!O){(0,A.warn)("Dependent image isn't ready yet");return}const N=O.width,j=O.height,Q=[];for(let tt=0,i=F.length;tt<i;tt+=2)Q.push({transform:[a,0,0,y,F[tt],F[tt+1]],x:0,y:0,w:N,h:j});this.paintInlineImageXObjectGroup(O,Q)}paintInlineImageXObject(g){if(!this.contentVisible)return;const a=g.width,y=g.height,F=this.ctx;this.save(),F.scale(1/a,-1/y);let O;if(typeof HTMLElement=="function"&&g instanceof HTMLElement||!g.data)O=g;else{const j=this.cachedCanvases.getCanvas("inlineImage",a,y),Q=j.context;p(Q,g,this.current.transferMaps),O=j.canvas}const N=this._scaleImage(O,(0,k.getCurrentTransformInverse)(F));F.imageSmoothingEnabled=ut((0,k.getCurrentTransform)(F),g.interpolate),e(F,N.img,0,0,N.paintWidth,N.paintHeight,0,-y,a,y),this.compose(),this.restore()}paintInlineImageXObjectGroup(g,a){if(!this.contentVisible)return;const y=this.ctx,F=g.width,O=g.height,N=this.cachedCanvases.getCanvas("inlineImage",F,O),j=N.context;p(j,g,this.current.transferMaps);for(const Q of a)y.save(),y.transform(...Q.transform),y.scale(1,-1),e(y,N.canvas,Q.x,Q.y,Q.w,Q.h,0,-1,1,1),y.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(g){}markPointProps(g,a){}beginMarkedContent(g){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(g,a){g==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(a)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(g){const a=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(g);const y=this.ctx;this.pendingClip&&(a||(this.pendingClip===Y?y.clip("evenodd"):y.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),y.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const g=(0,k.getCurrentTransform)(this.ctx);if(g[1]===0&&g[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(g[0]),Math.abs(g[3]));else{const a=Math.abs(g[0]*g[3]-g[2]*g[1]),y=Math.hypot(g[0],g[2]),F=Math.hypot(g[1],g[3]);this._cachedGetSinglePixelWidth=Math.max(y,F)/a}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:g}=this.current,a=(0,k.getCurrentTransform)(this.ctx);let y,F;if(a[1]===0&&a[2]===0){const O=Math.abs(a[0]),N=Math.abs(a[3]);if(g===0)y=1/O,F=1/N;else{const j=O*g,Q=N*g;y=j<1?1/j:1,F=Q<1?1/Q:1}}else{const O=Math.abs(a[0]*a[3]-a[2]*a[1]),N=Math.hypot(a[0],a[1]),j=Math.hypot(a[2],a[3]);if(g===0)y=j/O,F=N/O;else{const Q=g*O;y=j>Q?j/Q:1,F=N>Q?N/Q:1}}this._cachedScaleForStroking=[y,F]}return this._cachedScaleForStroking}rescaleAndStroke(g){const{ctx:a}=this,{lineWidth:y}=this.current,[F,O]=this.getScaleForStroking();if(a.lineWidth=y||1,F===1&&O===1){a.stroke();return}let N,j,Q;g&&(N=(0,k.getCurrentTransform)(a),j=a.getLineDash().slice(),Q=a.lineDashOffset),a.scale(F,O);const tt=Math.max(F,O);a.setLineDash(a.getLineDash().map(i=>i/tt)),a.lineDashOffset/=tt,a.stroke(),g&&(a.setTransform(...N),a.setLineDash(j),a.lineDashOffset=Q)}isContentVisible(){for(let g=this.markedContentStack.length-1;g>=0;g--)if(!this.markedContentStack[g].visible)return!1;return!0}};nt=new WeakSet,ce=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)};let et=pt;m.CanvasGraphics=et;for(const D in A.OPS)et.prototype[D]!==void 0&&(et.prototype[A.OPS[D]]=et.prototype[D])},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.TilingPattern=m.PathType=void 0,m.getShadingPattern=h;var A=K(1),k=K(6),H=K(12);const $={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};m.PathType=$;function W(e,d){if(!d||H.isNodeJS)return;const o=d[2]-d[0],p=d[3]-d[1],t=new Path2D;t.rect(d[0],d[1],o,p),e.clip(t)}class U{constructor(){this.constructor===U&&(0,A.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,A.unreachable)("Abstract method `getPattern` called.")}}class T extends U{constructor(d){super(),this._type=d[1],this._bbox=d[2],this._colorStops=d[3],this._p0=d[4],this._p1=d[5],this._r0=d[6],this._r1=d[7],this.matrix=null}_createGradient(d){let o;this._type==="axial"?o=d.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(o=d.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const p of this._colorStops)o.addColorStop(p[0],p[1]);return o}getPattern(d,o,p,t){let n;if(t===$.STROKE||t===$.FILL){const r=o.current.getClippedPathBoundingBox(t,(0,k.getCurrentTransform)(d))||[0,0,0,0],u=Math.ceil(r[2]-r[0])||1,x=Math.ceil(r[3]-r[1])||1,G=o.cachedCanvases.getCanvas("pattern",u,x,!0),I=G.context;I.clearRect(0,0,I.canvas.width,I.canvas.height),I.beginPath(),I.rect(0,0,I.canvas.width,I.canvas.height),I.translate(-r[0],-r[1]),p=A.Util.transform(p,[1,0,0,1,r[0],r[1]]),I.transform(...o.baseTransform),this.matrix&&I.transform(...this.matrix),W(I,this._bbox),I.fillStyle=this._createGradient(I),I.fill(),n=d.createPattern(G.canvas,"no-repeat");const lt=new DOMMatrix(p);n.setTransform(lt)}else W(d,this._bbox),n=this._createGradient(d);return n}}function E(e,d,o,p,t,n,r,u){const x=d.coords,G=d.colors,I=e.data,lt=e.width*4;let ut;x[o+1]>x[p+1]&&(ut=o,o=p,p=ut,ut=n,n=r,r=ut),x[p+1]>x[t+1]&&(ut=p,p=t,t=ut,ut=r,r=u,u=ut),x[o+1]>x[p+1]&&(ut=o,o=p,p=ut,ut=n,n=r,r=ut);const ot=(x[o]+d.offsetX)*d.scaleX,J=(x[o+1]+d.offsetY)*d.scaleY,q=(x[p]+d.offsetX)*d.scaleX,Y=(x[p+1]+d.offsetY)*d.scaleY,et=(x[t]+d.offsetX)*d.scaleX,nt=(x[t+1]+d.offsetY)*d.scaleY;if(J>=nt)return;const dt=G[n],pt=G[n+1],D=G[n+2],g=G[r],a=G[r+1],y=G[r+2],F=G[u],O=G[u+1],N=G[u+2],j=Math.round(J),Q=Math.round(nt);let tt,i,c,_,P,l,w,v;for(let M=j;M<=Q;M++){if(M<Y){let X;M<J?X=0:X=(J-M)/(J-Y),tt=ot-(ot-q)*X,i=dt-(dt-g)*X,c=pt-(pt-a)*X,_=D-(D-y)*X}else{let X;M>nt?X=1:Y===nt?X=0:X=(Y-M)/(Y-nt),tt=q-(q-et)*X,i=g-(g-F)*X,c=a-(a-O)*X,_=y-(y-N)*X}let L;M<J?L=0:M>nt?L=1:L=(J-M)/(J-nt),P=ot-(ot-et)*L,l=dt-(dt-F)*L,w=pt-(pt-O)*L,v=D-(D-N)*L;const Z=Math.round(Math.min(tt,P)),B=Math.round(Math.max(tt,P));let st=lt*M+Z*4;for(let X=Z;X<=B;X++)L=(tt-X)/(tt-P),L<0?L=0:L>1&&(L=1),I[st++]=i-(i-l)*L|0,I[st++]=c-(c-w)*L|0,I[st++]=_-(_-v)*L|0,I[st++]=255}}function R(e,d,o){const p=d.coords,t=d.colors;let n,r;switch(d.type){case"lattice":const u=d.verticesPerRow,x=Math.floor(p.length/u)-1,G=u-1;for(n=0;n<x;n++){let I=n*u;for(let lt=0;lt<G;lt++,I++)E(e,o,p[I],p[I+1],p[I+u],t[I],t[I+1],t[I+u]),E(e,o,p[I+u+1],p[I+1],p[I+u],t[I+u+1],t[I+1],t[I+u])}break;case"triangles":for(n=0,r=p.length;n<r;n+=3)E(e,o,p[n],p[n+1],p[n+2],t[n],t[n+1],t[n+2]);break;default:throw new Error("illegal figure")}}class S extends U{constructor(d){super(),this._coords=d[2],this._colors=d[3],this._figures=d[4],this._bounds=d[5],this._bbox=d[7],this._background=d[8],this.matrix=null}_createMeshCanvas(d,o,p){const u=Math.floor(this._bounds[0]),x=Math.floor(this._bounds[1]),G=Math.ceil(this._bounds[2])-u,I=Math.ceil(this._bounds[3])-x,lt=Math.min(Math.ceil(Math.abs(G*d[0]*1.1)),3e3),ut=Math.min(Math.ceil(Math.abs(I*d[1]*1.1)),3e3),ot=G/lt,J=I/ut,q={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-x,scaleX:1/ot,scaleY:1/J},Y=lt+2*2,et=ut+2*2,nt=p.getCanvas("mesh",Y,et,!1),dt=nt.context,pt=dt.createImageData(lt,ut);if(o){const g=pt.data;for(let a=0,y=g.length;a<y;a+=4)g[a]=o[0],g[a+1]=o[1],g[a+2]=o[2],g[a+3]=255}for(const g of this._figures)R(pt,g,q);return dt.putImageData(pt,2,2),{canvas:nt.canvas,offsetX:u-2*ot,offsetY:x-2*J,scaleX:ot,scaleY:J}}getPattern(d,o,p,t){W(d,this._bbox);let n;if(t===$.SHADING)n=A.Util.singularValueDecompose2dScale((0,k.getCurrentTransform)(d));else if(n=A.Util.singularValueDecompose2dScale(o.baseTransform),this.matrix){const u=A.Util.singularValueDecompose2dScale(this.matrix);n=[n[0]*u[0],n[1]*u[1]]}const r=this._createMeshCanvas(n,t===$.SHADING?null:this._background,o.cachedCanvases);return t!==$.SHADING&&(d.setTransform(...o.baseTransform),this.matrix&&d.transform(...this.matrix)),d.translate(r.offsetX,r.offsetY),d.scale(r.scaleX,r.scaleY),d.createPattern(r.canvas,"no-repeat")}}class b extends U{getPattern(){return"hotpink"}}function h(e){switch(e[0]){case"RadialAxial":return new T(e);case"Mesh":return new S(e);case"Dummy":return new b}throw new Error(`Unknown IR type: ${e[0]}`)}const f={COLORED:1,UNCOLORED:2};class s{static get MAX_PATTERN_SIZE(){return(0,A.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(d,o,p,t,n){this.operatorList=d[2],this.matrix=d[3]||[1,0,0,1,0,0],this.bbox=d[4],this.xstep=d[5],this.ystep=d[6],this.paintType=d[7],this.tilingType=d[8],this.color=o,this.ctx=p,this.canvasGraphicsFactory=t,this.baseTransform=n}createPatternCanvas(d){const o=this.operatorList,p=this.bbox,t=this.xstep,n=this.ystep,r=this.paintType,u=this.tilingType,x=this.color,G=this.canvasGraphicsFactory;(0,A.info)("TilingType: "+u);const I=p[0],lt=p[1],ut=p[2],ot=p[3],J=A.Util.singularValueDecompose2dScale(this.matrix),q=A.Util.singularValueDecompose2dScale(this.baseTransform),Y=[J[0]*q[0],J[1]*q[1]],et=this.getSizeAndScale(t,this.ctx.canvas.width,Y[0]),nt=this.getSizeAndScale(n,this.ctx.canvas.height,Y[1]),dt=d.cachedCanvases.getCanvas("pattern",et.size,nt.size,!0),pt=dt.context,D=G.createCanvasGraphics(pt);D.groupLevel=d.groupLevel,this.setFillAndStrokeStyleToContext(D,r,x);let g=I,a=lt,y=ut,F=ot;return I<0&&(g=0,y+=Math.abs(I)),lt<0&&(a=0,F+=Math.abs(lt)),pt.translate(-(et.scale*g),-(nt.scale*a)),D.transform(et.scale,0,0,nt.scale,0,0),pt.save(),this.clipBbox(D,g,a,y,F),D.baseTransform=(0,k.getCurrentTransform)(D.ctx),D.executeOperatorList(o),D.endDrawing(),{canvas:dt.canvas,scaleX:et.scale,scaleY:nt.scale,offsetX:g,offsetY:a}}getSizeAndScale(d,o,p){d=Math.abs(d);const t=Math.max(s.MAX_PATTERN_SIZE,o);let n=Math.ceil(d*p);return n>=t?n=t:p=n/d,{scale:p,size:n}}clipBbox(d,o,p,t,n){const r=t-o,u=n-p;d.ctx.rect(o,p,r,u),d.current.updateRectMinMax((0,k.getCurrentTransform)(d.ctx),[o,p,t,n]),d.clip(),d.endPath()}setFillAndStrokeStyleToContext(d,o,p){const t=d.ctx,n=d.current;switch(o){case f.COLORED:const r=this.ctx;t.fillStyle=r.fillStyle,t.strokeStyle=r.strokeStyle,n.fillColor=r.fillStyle,n.strokeColor=r.strokeStyle;break;case f.UNCOLORED:const u=A.Util.makeHexColor(p[0],p[1],p[2]);t.fillStyle=u,t.strokeStyle=u,n.fillColor=u,n.strokeColor=u;break;default:throw new A.FormatError(`Unsupported paint type: ${o}`)}}getPattern(d,o,p,t){let n=p;t!==$.SHADING&&(n=A.Util.transform(n,o.baseTransform),this.matrix&&(n=A.Util.transform(n,this.matrix)));const r=this.createPatternCanvas(o);let u=new DOMMatrix(n);u=u.translate(r.offsetX,r.offsetY),u=u.scale(1/r.scaleX,1/r.scaleY);const x=d.createPattern(r.canvas,"repeat");return x.setTransform(u),x}}m.TilingPattern=s},(rt,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.isNodeJS=void 0;const K=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");m.isNodeJS=K},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.applyMaskImageData=k;var A=K(1);function k({src:H,srcPos:$=0,dest:W,destPos:U=0,width:T,height:E,inverseDecode:R=!1}){const S=A.FeatureTest.isLittleEndian?4278190080:255,[b,h]=R?[0,S]:[S,0],f=T>>3,s=T&7,e=H.length;W=new Uint32Array(W.buffer);for(let d=0;d<E;d++){for(const p=$+f;$<p;$++){const t=$<e?H[$]:255;W[U++]=t&128?h:b,W[U++]=t&64?h:b,W[U++]=t&32?h:b,W[U++]=t&16?h:b,W[U++]=t&8?h:b,W[U++]=t&4?h:b,W[U++]=t&2?h:b,W[U++]=t&1?h:b}if(s===0)continue;const o=$<e?H[$++]:255;for(let p=0;p<s;p++)W[U++]=o&1<<7-p?h:b}return{srcPos:$,destPos:U}}},(rt,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.GlobalWorkerOptions=void 0;const K=Object.create(null);m.GlobalWorkerOptions=K,K.workerPort=K.workerPort===void 0?null:K.workerPort,K.workerSrc=K.workerSrc===void 0?"":K.workerSrc},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.MessageHandler=void 0;var A=K(1);const k={UNKNOWN:0,DATA:1,ERROR:2},H={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function $(U){switch(U instanceof Error||typeof U=="object"&&U!==null||(0,A.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),U.name){case"AbortException":return new A.AbortException(U.message);case"MissingPDFException":return new A.MissingPDFException(U.message);case"PasswordException":return new A.PasswordException(U.message,U.code);case"UnexpectedResponseException":return new A.UnexpectedResponseException(U.message,U.status);case"UnknownErrorException":return new A.UnknownErrorException(U.message,U.details);default:return new A.UnknownErrorException(U.message,U.toString())}}class W{constructor(T,E,R){this.sourceName=T,this.targetName=E,this.comObj=R,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=S=>{const b=S.data;if(b.targetName!==this.sourceName)return;if(b.stream){this._processStreamMessage(b);return}if(b.callback){const f=b.callbackId,s=this.callbackCapabilities[f];if(!s)throw new Error(`Cannot resolve callback ${f}`);if(delete this.callbackCapabilities[f],b.callback===k.DATA)s.resolve(b.data);else if(b.callback===k.ERROR)s.reject($(b.reason));else throw new Error("Unexpected callback case");return}const h=this.actionHandler[b.action];if(!h)throw new Error(`Unknown action from worker: ${b.action}`);if(b.callbackId){const f=this.sourceName,s=b.sourceName;new Promise(function(e){e(h(b.data))}).then(function(e){R.postMessage({sourceName:f,targetName:s,callback:k.DATA,callbackId:b.callbackId,data:e})},function(e){R.postMessage({sourceName:f,targetName:s,callback:k.ERROR,callbackId:b.callbackId,reason:$(e)})});return}if(b.streamId){this._createStreamSink(b);return}h(b.data)},R.addEventListener("message",this._onComObjOnMessage)}on(T,E){const R=this.actionHandler;if(R[T])throw new Error(`There is already an actionName called "${T}"`);R[T]=E}send(T,E,R){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:T,data:E},R)}sendWithPromise(T,E,R){const S=this.callbackId++,b=(0,A.createPromiseCapability)();this.callbackCapabilities[S]=b;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:T,callbackId:S,data:E},R)}catch(h){b.reject(h)}return b.promise}sendWithStream(T,E,R,S){const b=this.streamId++,h=this.sourceName,f=this.targetName,s=this.comObj;return new ReadableStream({start:e=>{const d=(0,A.createPromiseCapability)();return this.streamControllers[b]={controller:e,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},s.postMessage({sourceName:h,targetName:f,action:T,streamId:b,data:E,desiredSize:e.desiredSize},S),d.promise},pull:e=>{const d=(0,A.createPromiseCapability)();return this.streamControllers[b].pullCall=d,s.postMessage({sourceName:h,targetName:f,stream:H.PULL,streamId:b,desiredSize:e.desiredSize}),d.promise},cancel:e=>{(0,A.assert)(e instanceof Error,"cancel must have a valid reason");const d=(0,A.createPromiseCapability)();return this.streamControllers[b].cancelCall=d,this.streamControllers[b].isClosed=!0,s.postMessage({sourceName:h,targetName:f,stream:H.CANCEL,streamId:b,reason:$(e)}),d.promise}},R)}_createStreamSink(T){const E=T.streamId,R=this.sourceName,S=T.sourceName,b=this.comObj,h=this,f=this.actionHandler[T.action],s={enqueue(e,d=1,o){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=d,p>0&&this.desiredSize<=0&&(this.sinkCapability=(0,A.createPromiseCapability)(),this.ready=this.sinkCapability.promise),b.postMessage({sourceName:R,targetName:S,stream:H.ENQUEUE,streamId:E,chunk:e},o)},close(){this.isCancelled||(this.isCancelled=!0,b.postMessage({sourceName:R,targetName:S,stream:H.CLOSE,streamId:E}),delete h.streamSinks[E])},error(e){(0,A.assert)(e instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,b.postMessage({sourceName:R,targetName:S,stream:H.ERROR,streamId:E,reason:$(e)}))},sinkCapability:(0,A.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:T.desiredSize,ready:null};s.sinkCapability.resolve(),s.ready=s.sinkCapability.promise,this.streamSinks[E]=s,new Promise(function(e){e(f(T.data,s))}).then(function(){b.postMessage({sourceName:R,targetName:S,stream:H.START_COMPLETE,streamId:E,success:!0})},function(e){b.postMessage({sourceName:R,targetName:S,stream:H.START_COMPLETE,streamId:E,reason:$(e)})})}_processStreamMessage(T){const E=T.streamId,R=this.sourceName,S=T.sourceName,b=this.comObj,h=this.streamControllers[E],f=this.streamSinks[E];switch(T.stream){case H.START_COMPLETE:T.success?h.startCall.resolve():h.startCall.reject($(T.reason));break;case H.PULL_COMPLETE:T.success?h.pullCall.resolve():h.pullCall.reject($(T.reason));break;case H.PULL:if(!f){b.postMessage({sourceName:R,targetName:S,stream:H.PULL_COMPLETE,streamId:E,success:!0});break}f.desiredSize<=0&&T.desiredSize>0&&f.sinkCapability.resolve(),f.desiredSize=T.desiredSize,new Promise(function(s){s(f.onPull&&f.onPull())}).then(function(){b.postMessage({sourceName:R,targetName:S,stream:H.PULL_COMPLETE,streamId:E,success:!0})},function(s){b.postMessage({sourceName:R,targetName:S,stream:H.PULL_COMPLETE,streamId:E,reason:$(s)})});break;case H.ENQUEUE:if((0,A.assert)(h,"enqueue should have stream controller"),h.isClosed)break;h.controller.enqueue(T.chunk);break;case H.CLOSE:if((0,A.assert)(h,"close should have stream controller"),h.isClosed)break;h.isClosed=!0,h.controller.close(),this._deleteStreamController(h,E);break;case H.ERROR:(0,A.assert)(h,"error should have stream controller"),h.controller.error($(T.reason)),this._deleteStreamController(h,E);break;case H.CANCEL_COMPLETE:T.success?h.cancelCall.resolve():h.cancelCall.reject($(T.reason)),this._deleteStreamController(h,E);break;case H.CANCEL:if(!f)break;new Promise(function(s){s(f.onCancel&&f.onCancel($(T.reason)))}).then(function(){b.postMessage({sourceName:R,targetName:S,stream:H.CANCEL_COMPLETE,streamId:E,success:!0})},function(s){b.postMessage({sourceName:R,targetName:S,stream:H.CANCEL_COMPLETE,streamId:E,reason:$(s)})}),f.sinkCapability.reject($(T.reason)),f.isCancelled=!0,delete this.streamSinks[E];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(T,E){await Promise.allSettled([T.startCall&&T.startCall.promise,T.pullCall&&T.pullCall.promise,T.cancelCall&&T.cancelCall.promise]),delete this.streamControllers[E]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}m.MessageHandler=W},(rt,m,K)=>{var H,$;Object.defineProperty(m,"__esModule",{value:!0}),m.Metadata=void 0;var A=K(1);class k{constructor({parsedData:U,rawData:T}){ht(this,H);ht(this,$);ft(this,H,U),ft(this,$,T)}getRaw(){return C(this,$)}get(U){return C(this,H).get(U)??null}getAll(){return(0,A.objectFromMap)(C(this,H))}has(U){return C(this,H).has(U)}}H=new WeakMap,$=new WeakMap,m.Metadata=k},(rt,m,K)=>{var U,T,E,R,S,b,he;Object.defineProperty(m,"__esModule",{value:!0}),m.OptionalContentConfig=void 0;var A=K(1),k=K(8);const H=Symbol("INTERNAL");class ${constructor(s,e){ht(this,U,!0);this.name=s,this.intent=e}get visible(){return C(this,U)}_setVisible(s,e){s!==H&&(0,A.unreachable)("Internal method `_setVisible` called."),ft(this,U,e)}}U=new WeakMap;class W{constructor(s){ht(this,b);ht(this,T,null);ht(this,E,new Map);ht(this,R,null);ht(this,S,null);if(this.name=null,this.creator=null,s!==null){this.name=s.name,this.creator=s.creator,ft(this,S,s.order);for(const e of s.groups)C(this,E).set(e.id,new $(e.name,e.intent));if(s.baseState==="OFF")for(const e of C(this,E).values())e._setVisible(H,!1);for(const e of s.on)C(this,E).get(e)._setVisible(H,!0);for(const e of s.off)C(this,E).get(e)._setVisible(H,!1);ft(this,R,this.getHash())}}isVisible(s){if(C(this,E).size===0)return!0;if(!s)return(0,A.warn)("Optional content group not defined."),!0;if(s.type==="OCG")return C(this,E).has(s.id)?C(this,E).get(s.id).visible:((0,A.warn)(`Optional content group not found: ${s.id}`),!0);if(s.type==="OCMD"){if(s.expression)return at(this,b,he).call(this,s.expression);if(!s.policy||s.policy==="AnyOn"){for(const e of s.ids){if(!C(this,E).has(e))return(0,A.warn)(`Optional content group not found: ${e}`),!0;if(C(this,E).get(e).visible)return!0}return!1}else if(s.policy==="AllOn"){for(const e of s.ids){if(!C(this,E).has(e))return(0,A.warn)(`Optional content group not found: ${e}`),!0;if(!C(this,E).get(e).visible)return!1}return!0}else if(s.policy==="AnyOff"){for(const e of s.ids){if(!C(this,E).has(e))return(0,A.warn)(`Optional content group not found: ${e}`),!0;if(!C(this,E).get(e).visible)return!0}return!1}else if(s.policy==="AllOff"){for(const e of s.ids){if(!C(this,E).has(e))return(0,A.warn)(`Optional content group not found: ${e}`),!0;if(C(this,E).get(e).visible)return!1}return!0}return(0,A.warn)(`Unknown optional content policy ${s.policy}.`),!0}return(0,A.warn)(`Unknown group type ${s.type}.`),!0}setVisibility(s,e=!0){if(!C(this,E).has(s)){(0,A.warn)(`Optional content group not found: ${s}`);return}C(this,E).get(s)._setVisible(H,!!e),ft(this,T,null)}get hasInitialVisibility(){return this.getHash()===C(this,R)}getOrder(){return C(this,E).size?C(this,S)?C(this,S).slice():[...C(this,E).keys()]:null}getGroups(){return C(this,E).size>0?(0,A.objectFromMap)(C(this,E)):null}getGroup(s){return C(this,E).get(s)||null}getHash(){if(C(this,T)!==null)return C(this,T);const s=new k.MurmurHash3_64;for(const[e,d]of C(this,E))s.update(`${e}:${d.visible}`);return ft(this,T,s.hexdigest())}}T=new WeakMap,E=new WeakMap,R=new WeakMap,S=new WeakMap,b=new WeakSet,he=function(s){const e=s.length;if(e<2)return!0;const d=s[0];for(let o=1;o<e;o++){const p=s[o];let t;if(Array.isArray(p))t=at(this,b,he).call(this,p);else if(C(this,E).has(p))t=C(this,E).get(p).visible;else return(0,A.warn)(`Optional content group not found: ${p}`),!0;switch(d){case"And":if(!t)return!1;break;case"Or":if(t)return!0;break;case"Not":return!t;default:return!0}}return d==="And"},m.OptionalContentConfig=W},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.PDFDataTransportStream=void 0;var A=K(1),k=K(6);class H{constructor(T,E){(0,A.assert)(E,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=T.progressiveDone||!1,this._contentDispositionFilename=T.contentDispositionFilename||null;const R=T.initialData;if((R==null?void 0:R.length)>0){const S=new Uint8Array(R).buffer;this._queuedChunks.push(S)}this._pdfDataRangeTransport=E,this._isStreamingSupported=!T.disableStream,this._isRangeSupported=!T.disableRange,this._contentLength=T.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((S,b)=>{this._onReceiveData({begin:S,chunk:b})}),this._pdfDataRangeTransport.addProgressListener((S,b)=>{this._onProgress({loaded:S,total:b})}),this._pdfDataRangeTransport.addProgressiveReadListener(S=>{this._onReceiveData({chunk:S})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(T){const E=new Uint8Array(T.chunk).buffer;if(T.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(E):this._queuedChunks.push(E);else{const R=this._rangeReaders.some(function(S){return S._begin!==T.begin?!1:(S._enqueue(E),!0)});(0,A.assert)(R,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var T;return((T=this._fullRequestReader)==null?void 0:T._loaded)??0}_onProgress(T){var E,R,S,b;T.total===void 0?(R=(E=this._rangeReaders[0])==null?void 0:E.onProgress)==null||R.call(E,{loaded:T.loaded}):(b=(S=this._fullRequestReader)==null?void 0:S.onProgress)==null||b.call(S,{loaded:T.loaded,total:T.total})}_onProgressiveDone(){var T;(T=this._fullRequestReader)==null||T.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(T){const E=this._rangeReaders.indexOf(T);E>=0&&this._rangeReaders.splice(E,1)}getFullReader(){(0,A.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const T=this._queuedChunks;return this._queuedChunks=null,new $(this,T,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(T,E){if(E<=this._progressiveDataLength)return null;const R=new W(this,T,E);return this._pdfDataRangeTransport.requestDataRange(T,E),this._rangeReaders.push(R),R}cancelAllRequests(T){var E;(E=this._fullRequestReader)==null||E.cancel(T);for(const R of this._rangeReaders.slice(0))R.cancel(T);this._pdfDataRangeTransport.abort()}}m.PDFDataTransportStream=H;class ${constructor(T,E,R=!1,S=null){this._stream=T,this._done=R||!1,this._filename=(0,k.isPdfFile)(S)?S:null,this._queuedChunks=E||[],this._loaded=0;for(const b of this._queuedChunks)this._loaded+=b.byteLength;this._requests=[],this._headersReady=Promise.resolve(),T._fullRequestReader=this,this.onProgress=null}_enqueue(T){this._done||(this._requests.length>0?this._requests.shift().resolve({value:T,done:!1}):this._queuedChunks.push(T),this._loaded+=T.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const T=(0,A.createPromiseCapability)();return this._requests.push(T),T.promise}cancel(T){this._done=!0;for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class W{constructor(T,E,R){this._stream=T,this._begin=E,this._end=R,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(T){if(!this._done){if(this._requests.length===0)this._queuedChunk=T;else{this._requests.shift().resolve({value:T,done:!1});for(const R of this._requests)R.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const E=this._queuedChunk;return this._queuedChunk=null,{value:E,done:!1}}if(this._done)return{value:void 0,done:!0};const T=(0,A.createPromiseCapability)();return this._requests.push(T),T.promise}cancel(T){this._done=!0;for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(rt,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.XfaText=void 0;class K{static textContent(k){const H=[],$={items:H,styles:Object.create(null)};function W(U){var R;if(!U)return;let T=null;const E=U.name;if(E==="#text")T=U.value;else if(K.shouldBuildText(E))(R=U==null?void 0:U.attributes)!=null&&R.textContent?T=U.attributes.textContent:U.value&&(T=U.value);else return;if(T!==null&&H.push({str:T}),!!U.children)for(const S of U.children)W(S)}return W(k),$}static shouldBuildText(k){return!(k==="textarea"||k==="input"||k==="option"||k==="select")}}m.XfaText=K},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.NodeStandardFontDataFactory=m.NodeCanvasFactory=m.NodeCMapReaderFactory=void 0;var A=K(7);const k=function(U){return new Promise((T,E)=>{require$$5.readFile(U,(S,b)=>{if(S||!b){E(new Error(S));return}T(new Uint8Array(b))})})};class H extends A.BaseCanvasFactory{_createCanvas(T,E){return require$$5.createCanvas(T,E)}}m.NodeCanvasFactory=H;class $ extends A.BaseCMapReaderFactory{_fetchData(T,E){return k(T).then(R=>({cMapData:R,compressionType:E}))}}m.NodeCMapReaderFactory=$;class W extends A.BaseStandardFontDataFactory{_fetchData(T){return k(T)}}m.NodeStandardFontDataFactory=W},(rt,m,K)=>{var U,T,E,R,S,b,h,f,s,de,Re,ue,Me;Object.defineProperty(m,"__esModule",{value:!0}),m.AnnotationEditorLayer=void 0;var A=K(5),k=K(1),H=K(22),$=K(23);const t=class t{constructor(r){ht(this,s);ht(this,U);ht(this,T,!1);ht(this,E,this.pointerup.bind(this));ht(this,R,this.pointerdown.bind(this));ht(this,S,new Map);ht(this,b,!1);ht(this,h,!1);ht(this,f);t._initialized||(t._initialized=!0,H.FreeTextEditor.initialize(r.l10n),$.InkEditor.initialize(r.l10n)),r.uiManager.registerEditorTypes([H.FreeTextEditor,$.InkEditor]),ft(this,f,r.uiManager),this.annotationStorage=r.annotationStorage,this.pageIndex=r.pageIndex,this.div=r.div,ft(this,U,r.accessibilityManager),C(this,f).addLayer(this)}updateToolbar(r){C(this,f).updateToolbar(r)}updateMode(r=C(this,f).getMode()){at(this,s,Me).call(this),r===k.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),C(this,f).unselectAll(),this.div.classList.toggle("freeTextEditing",r===k.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",r===k.AnnotationEditorType.INK)}addInkEditorIfNeeded(r){if(!r&&C(this,f).getMode()!==k.AnnotationEditorType.INK)return;if(!r){for(const x of C(this,S).values())if(x.isEmpty()){x.setInBackground();return}}at(this,s,ue).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(r){C(this,f).setEditingState(r)}addCommands(r){C(this,f).addCommands(r)}enable(){this.div.style.pointerEvents="auto";for(const r of C(this,S).values())r.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const r of C(this,S).values())r.disableEditing()}setActiveEditor(r){C(this,f).getActive()!==r&&C(this,f).setActiveEditor(r)}enableClick(){this.div.addEventListener("pointerdown",C(this,R)),this.div.addEventListener("pointerup",C(this,E))}disableClick(){this.div.removeEventListener("pointerdown",C(this,R)),this.div.removeEventListener("pointerup",C(this,E))}attach(r){C(this,S).set(r.id,r)}detach(r){var u;C(this,S).delete(r.id),(u=C(this,U))==null||u.removePointerInTextLayer(r.contentDiv)}remove(r){C(this,f).removeEditor(r),this.detach(r),this.annotationStorage.remove(r.id),r.div.style.display="none",setTimeout(()=>{r.div.style.display="",r.div.remove(),r.isAttachedToDOM=!1,document.activeElement===document.body&&C(this,f).focusMainContainer()},0),C(this,h)||this.addInkEditorIfNeeded(!1)}add(r){if(at(this,s,de).call(this,r),C(this,f).addEditor(r),this.attach(r),!r.isAttachedToDOM){const u=r.render();this.div.append(u),r.isAttachedToDOM=!0}this.moveEditorInDOM(r),r.onceAdded(),this.addToAnnotationStorage(r)}moveEditorInDOM(r){var u;(u=C(this,U))==null||u.moveElementInDOM(this.div,r.div,r.contentDiv,!0)}addToAnnotationStorage(r){!r.isEmpty()&&!this.annotationStorage.has(r.id)&&this.annotationStorage.setValue(r.id,r)}addOrRebuild(r){r.needsToBeRebuilt()?r.rebuild():this.add(r)}addANewEditor(r){const u=()=>{this.addOrRebuild(r)},x=()=>{r.remove()};this.addCommands({cmd:u,undo:x,mustExec:!0})}addUndoableEditor(r){const u=()=>{this.addOrRebuild(r)},x=()=>{r.remove()};this.addCommands({cmd:u,undo:x,mustExec:!1})}getNextId(){return C(this,f).getId()}deserialize(r){switch(r.annotationType){case k.AnnotationEditorType.FREETEXT:return H.FreeTextEditor.deserialize(r,this);case k.AnnotationEditorType.INK:return $.InkEditor.deserialize(r,this)}return null}setSelected(r){C(this,f).setSelected(r)}toggleSelected(r){C(this,f).toggleSelected(r)}isSelected(r){return C(this,f).isSelected(r)}unselect(r){C(this,f).unselect(r)}pointerup(r){const u=A.KeyboardManager.platform.isMac;if(!(r.button!==0||r.ctrlKey&&u)&&r.target===this.div&&C(this,b)){if(ft(this,b,!1),!C(this,T)){ft(this,T,!0);return}at(this,s,ue).call(this,r)}}pointerdown(r){const u=A.KeyboardManager.platform.isMac;if(r.button!==0||r.ctrlKey&&u||r.target!==this.div)return;ft(this,b,!0);const x=C(this,f).getActive();ft(this,T,!x||x.isEmpty())}drop(r){const u=r.dataTransfer.getData("text/plain"),x=C(this,f).getEditor(u);if(!x)return;r.preventDefault(),r.dataTransfer.dropEffect="move",at(this,s,de).call(this,x);const G=this.div.getBoundingClientRect(),I=r.clientX-G.x,lt=r.clientY-G.y;x.translate(I-x.startX,lt-x.startY),this.moveEditorInDOM(x),x.div.focus()}dragover(r){r.preventDefault()}destroy(){var r,u;((r=C(this,f).getActive())==null?void 0:r.parent)===this&&C(this,f).setActiveEditor(null);for(const x of C(this,S).values())(u=C(this,U))==null||u.removePointerInTextLayer(x.contentDiv),x.isAttachedToDOM=!1,x.div.remove(),x.parent=null;this.div=null,C(this,S).clear(),C(this,f).removeLayer(this)}render(r){this.viewport=r.viewport,(0,A.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const u of C(this,f).getEditors(this.pageIndex))this.add(u);this.updateMode()}update(r){C(this,f).commitOrRemove(),this.viewport=r.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[r,u,x,G]=this.viewport.viewBox,I=x-r,lt=G-u;return[I,lt]}get viewportBaseDimensions(){const{width:r,height:u,rotation:x}=this.viewport;return x%180===0?[r,u]:[u,r]}setDimensions(){const{width:r,height:u,rotation:x}=this.viewport,G=x%180!==0,I=Math.floor(r)+"px",lt=Math.floor(u)+"px";this.div.style.width=G?lt:I,this.div.style.height=G?I:lt,this.div.setAttribute("data-main-rotation",x)}};U=new WeakMap,T=new WeakMap,E=new WeakMap,R=new WeakMap,S=new WeakMap,b=new WeakMap,h=new WeakMap,f=new WeakMap,s=new WeakSet,de=function(r){var u;r.parent!==this&&(this.attach(r),r.pageIndex=this.pageIndex,(u=r.parent)==null||u.detach(r),r.parent=this,r.div&&r.isAttachedToDOM&&(r.div.remove(),this.div.append(r.div)))},Re=function(r){switch(C(this,f).getMode()){case k.AnnotationEditorType.FREETEXT:return new H.FreeTextEditor(r);case k.AnnotationEditorType.INK:return new $.InkEditor(r)}return null},ue=function(r){const u=this.getNextId(),x=at(this,s,Re).call(this,{parent:this,id:u,x:r.offsetX,y:r.offsetY});return x&&this.add(x),x},Me=function(){ft(this,h,!0);for(const r of C(this,S).values())r.isEmpty()&&r.remove();ft(this,h,!1)},xt(t,"_initialized",!1);let W=t;m.AnnotationEditorLayer=W},(rt,m,K)=>{var W,U,T,E,R,S,b,h,f,s,Oe,De,Ie,fe;Object.defineProperty(m,"__esModule",{value:!0}),m.FreeTextEditor=void 0;var A=K(1),k=K(5),H=K(4);const t=class t extends H.AnnotationEditor{constructor(u){super({...u,name:"freeTextEditor"});ht(this,s);ht(this,W,this.editorDivBlur.bind(this));ht(this,U,this.editorDivFocus.bind(this));ht(this,T,this.editorDivInput.bind(this));ht(this,E,this.editorDivKeydown.bind(this));ht(this,R);ht(this,S,"");ht(this,b,`${this.id}-editor`);ht(this,h,!1);ht(this,f);ft(this,R,u.color||t._defaultColor||H.AnnotationEditor._defaultLineColor),ft(this,f,u.fontSize||t._defaultFontSize)}static initialize(u){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(G=>[G,u.get(G)]));const x=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(x.getPropertyValue("--freetext-padding"))}static updateDefaultParams(u,x){switch(u){case A.AnnotationEditorParamsType.FREETEXT_SIZE:t._defaultFontSize=x;break;case A.AnnotationEditorParamsType.FREETEXT_COLOR:t._defaultColor=x;break}}updateParams(u,x){switch(u){case A.AnnotationEditorParamsType.FREETEXT_SIZE:at(this,s,Oe).call(this,x);break;case A.AnnotationEditorParamsType.FREETEXT_COLOR:at(this,s,De).call(this,x);break}}static get defaultPropertiesToUpdate(){return[[A.AnnotationEditorParamsType.FREETEXT_SIZE,t._defaultFontSize],[A.AnnotationEditorParamsType.FREETEXT_COLOR,t._defaultColor||H.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[A.AnnotationEditorParamsType.FREETEXT_SIZE,C(this,f)],[A.AnnotationEditorParamsType.FREETEXT_COLOR,C(this,R)]]}getInitialTranslation(){return[-t._internalPadding*this.parent.scaleFactor,-(t._internalPadding+C(this,f))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(A.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",C(this,E)),this.editorDiv.addEventListener("focus",C(this,U)),this.editorDiv.addEventListener("blur",C(this,W)),this.editorDiv.addEventListener("input",C(this,T)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",C(this,b)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",C(this,E)),this.editorDiv.removeEventListener("focus",C(this,U)),this.editorDiv.removeEventListener("blur",C(this,W)),this.editorDiv.removeEventListener("input",C(this,T)),this.div.focus(),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(u){super.focusin(u),u.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){super.commit(),C(this,h)||(ft(this,h,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),ft(this,S,at(this,s,Ie).call(this).trimEnd()),at(this,s,fe).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(u){this.enableEditMode(),this.editorDiv.focus()}keydown(u){u.target===this.div&&u.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(u){t._keyboardManager.exec(this,u)}editorDivFocus(u){this.isEditing=!0}editorDivBlur(u){this.isEditing=!1}editorDivInput(u){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let u,x;this.width&&(u=this.x,x=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",C(this,b)),this.enableEditing(),t._l10nPromise.get("editor_free_text2_aria_label").then(I=>{var lt;return(lt=this.editorDiv)==null?void 0:lt.setAttribute("aria-label",I)}),t._l10nPromise.get("free_text2_default_content").then(I=>{var lt;return(lt=this.editorDiv)==null?void 0:lt.setAttribute("default-content",I)}),this.editorDiv.contentEditable=!0;const{style:G}=this.editorDiv;if(G.fontSize=`calc(${C(this,f)}px * var(--scale-factor))`,G.color=C(this,R),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,k.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[I,lt]=this.parent.viewportBaseDimensions;this.setAt(u*I,x*lt,this.width*I,this.height*lt);for(const ut of C(this,S).split(`
`)){const ot=document.createElement("div");ot.append(ut?document.createTextNode(ut):document.createElement("br")),this.editorDiv.append(ot)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(u,x){const G=super.deserialize(u,x);return ft(G,f,u.fontSize),ft(G,R,A.Util.makeHexColor(...u.color)),ft(G,S,u.value),G}serialize(){if(this.isEmpty())return null;const u=t._internalPadding*this.parent.scaleFactor,x=this.getRect(u,u),G=H.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:A.AnnotationEditorType.FREETEXT,color:G,fontSize:C(this,f),value:C(this,S),pageIndex:this.parent.pageIndex,rect:x,rotation:this.rotation}}};W=new WeakMap,U=new WeakMap,T=new WeakMap,E=new WeakMap,R=new WeakMap,S=new WeakMap,b=new WeakMap,h=new WeakMap,f=new WeakMap,s=new WeakSet,Oe=function(u){const x=I=>{this.editorDiv.style.fontSize=`calc(${I}px * var(--scale-factor))`,this.translate(0,-(I-C(this,f))*this.parent.scaleFactor),ft(this,f,I),at(this,s,fe).call(this)},G=C(this,f);this.parent.addCommands({cmd:()=>{x(u)},undo:()=>{x(G)},mustExec:!0,type:A.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},De=function(u){const x=C(this,R);this.parent.addCommands({cmd:()=>{ft(this,R,u),this.editorDiv.style.color=u},undo:()=>{ft(this,R,x),this.editorDiv.style.color=x},mustExec:!0,type:A.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ie=function(){const u=this.editorDiv.getElementsByTagName("div");if(u.length===0)return this.editorDiv.innerText;const x=[];for(const G of u){const I=G.firstChild;(I==null?void 0:I.nodeName)==="#text"?x.push(I.data):x.push("")}return x.join(`
`)},fe=function(){const[u,x]=this.parent.viewportBaseDimensions,G=this.div.getBoundingClientRect();this.width=G.width/u,this.height=G.height/x},xt(t,"_freeTextDefaultContent",""),xt(t,"_l10nPromise"),xt(t,"_internalPadding",0),xt(t,"_defaultColor",null),xt(t,"_defaultFontSize",10),xt(t,"_keyboardManager",new k.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.prototype.commitOrRemove]])),xt(t,"_type","freetext");let $=t;m.FreeTextEditor=$},(rt,m,K)=>{var E,R,S,b,h,f,s,e,d,o,p,t,n,r,u,Le,Ne,Ue,je,pe,Be,We,qe,Ot,ge,Kt,Jt,Wt,me,Qt,a,be,He,Ge,Xe,_e,Zt,qt,Ae;Object.defineProperty(m,"__esModule",{value:!0}),m.InkEditor=void 0,Object.defineProperty(m,"fitCurve",{enumerable:!0,get:function(){return H.fitCurve}});var A=K(1),k=K(4),H=K(24),$=K(5);const W=16,U=100,c=class c extends k.AnnotationEditor{constructor(l){super({...l,name:"inkEditor"});ht(this,u);ht(this,E,0);ht(this,R,0);ht(this,S,0);ht(this,b,this.canvasPointermove.bind(this));ht(this,h,this.canvasPointerleave.bind(this));ht(this,f,this.canvasPointerup.bind(this));ht(this,s,this.canvasPointerdown.bind(this));ht(this,e,!1);ht(this,d,!1);ht(this,o,null);ht(this,p,null);ht(this,t,0);ht(this,n,0);ht(this,r,null);this.color=l.color||null,this.thickness=l.thickness||null,this.opacity=l.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(l){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(w=>[w,l.get(w)]))}static updateDefaultParams(l,w){switch(l){case A.AnnotationEditorParamsType.INK_THICKNESS:c._defaultThickness=w;break;case A.AnnotationEditorParamsType.INK_COLOR:c._defaultColor=w;break;case A.AnnotationEditorParamsType.INK_OPACITY:c._defaultOpacity=w/100;break}}updateParams(l,w){switch(l){case A.AnnotationEditorParamsType.INK_THICKNESS:at(this,u,Le).call(this,w);break;case A.AnnotationEditorParamsType.INK_COLOR:at(this,u,Ne).call(this,w);break;case A.AnnotationEditorParamsType.INK_OPACITY:at(this,u,Ue).call(this,w);break}}static get defaultPropertiesToUpdate(){return[[A.AnnotationEditorParamsType.INK_THICKNESS,c._defaultThickness],[A.AnnotationEditorParamsType.INK_COLOR,c._defaultColor||k.AnnotationEditor._defaultLineColor],[A.AnnotationEditorParamsType.INK_OPACITY,Math.round(c._defaultOpacity*100)]]}get propertiesToUpdate(){return[[A.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||c._defaultThickness],[A.AnnotationEditorParamsType.INK_COLOR,this.color||c._defaultColor||k.AnnotationEditor._defaultLineColor],[A.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??c._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(at(this,u,Kt).call(this),at(this,u,Jt).call(this)),this.isAttachedToDOM||(this.parent.add(this),at(this,u,Wt).call(this)),at(this,u,qt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,C(this,p).disconnect(),ft(this,p,null),super.remove())}enableEditMode(){C(this,e)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",C(this,s)),this.canvas.addEventListener("pointerup",C(this,f)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",C(this,s)),this.canvas.removeEventListener("pointerup",C(this,f)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){C(this,e)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),ft(this,e,!0),this.div.classList.add("disabled"),at(this,u,qt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(l){super.focusin(l),this.enableEditMode()}canvasPointerdown(l){l.button!==0||!this.isInEditMode()||C(this,e)||(this.setInForeground(),l.type!=="mouse"&&this.div.focus(),l.stopPropagation(),this.canvas.addEventListener("pointerleave",C(this,h)),this.canvas.addEventListener("pointermove",C(this,b)),at(this,u,Be).call(this,l.offsetX,l.offsetY))}canvasPointermove(l){l.stopPropagation(),at(this,u,We).call(this,l.offsetX,l.offsetY)}canvasPointerup(l){l.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(l.stopPropagation(),at(this,u,ge).call(this,l),this.setInBackground())}canvasPointerleave(l){at(this,u,ge).call(this,l),this.setInBackground()}render(){if(this.div)return this.div;let l,w;this.width&&(l=this.x,w=this.y),super.render(),c._l10nPromise.get("editor_ink2_aria_label").then(B=>{var st;return(st=this.div)==null?void 0:st.setAttribute("aria-label",B)});const[v,M,L,Z]=at(this,u,je).call(this);if(this.setAt(v,M,0,0),this.setDims(L,Z),at(this,u,Kt).call(this),this.width){const[B,st]=this.parent.viewportBaseDimensions;this.setAt(l*B,w*st,this.width*B,this.height*st),ft(this,d,!0),at(this,u,Wt).call(this),this.setDims(this.width*B,this.height*st),at(this,u,Ot).call(this),at(this,u,Ae).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return at(this,u,Jt).call(this),this.div}setDimensions(l,w){const v=Math.round(l),M=Math.round(w);if(C(this,t)===v&&C(this,n)===M)return;ft(this,t,v),ft(this,n,M),this.canvas.style.visibility="hidden",C(this,E)&&Math.abs(C(this,E)-l/w)>.01&&(w=Math.ceil(l/C(this,E)),this.setDims(l,w));const[L,Z]=this.parent.viewportBaseDimensions;this.width=l/L,this.height=w/Z,C(this,e)&&at(this,u,me).call(this,l,w),at(this,u,Wt).call(this),at(this,u,Ot).call(this),this.canvas.style.visibility="visible"}static deserialize(l,w){var _t,gt;const v=super.deserialize(l,w);v.thickness=l.thickness,v.color=A.Util.makeHexColor(...l.color),v.opacity=l.opacity;const[M,L]=w.pageDimensions,Z=v.width*M,B=v.height*L,st=w.scaleFactor,X=l.thickness/2;ft(v,E,Z/B),ft(v,e,!0),ft(v,t,Math.round(Z)),ft(v,n,Math.round(B));for(const{bezier:bt}of l.paths){const yt=[];v.paths.push(yt);let Et=st*(bt[0]-X),vt=st*(B-bt[1]-X);for(let St=2,Ct=bt.length;St<Ct;St+=6){const Dt=st*(bt[St]-X),Ut=st*(B-bt[St+1]-X),it=st*(bt[St+2]-X),V=st*(B-bt[St+3]-X),z=st*(bt[St+4]-X),mt=st*(B-bt[St+5]-X);yt.push([[Et,vt],[Dt,Ut],[it,V],[z,mt]]),Et=z,vt=mt}const wt=at(this,a,be).call(this,yt);v.bezierPath2D.push(wt)}const ct=at(_t=v,u,_e).call(_t);return ft(v,S,Math.max(W,ct[2]-ct[0])),ft(v,R,Math.max(W,ct[3]-ct[1])),at(gt=v,u,me).call(gt,Z,B),v}serialize(){if(this.isEmpty())return null;const l=this.getRect(0,0),w=this.rotation%180===0?l[3]-l[1]:l[2]-l[0],v=k.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:A.AnnotationEditorType.INK,color:v,thickness:this.thickness,opacity:this.opacity,paths:at(this,u,He).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,w),pageIndex:this.parent.pageIndex,rect:l,rotation:this.rotation}}};E=new WeakMap,R=new WeakMap,S=new WeakMap,b=new WeakMap,h=new WeakMap,f=new WeakMap,s=new WeakMap,e=new WeakMap,d=new WeakMap,o=new WeakMap,p=new WeakMap,t=new WeakMap,n=new WeakMap,r=new WeakMap,u=new WeakSet,Le=function(l){const w=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=l,at(this,u,qt).call(this)},undo:()=>{this.thickness=w,at(this,u,qt).call(this)},mustExec:!0,type:A.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Ne=function(l){const w=this.color;this.parent.addCommands({cmd:()=>{this.color=l,at(this,u,Ot).call(this)},undo:()=>{this.color=w,at(this,u,Ot).call(this)},mustExec:!0,type:A.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ue=function(l){l/=100;const w=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=l,at(this,u,Ot).call(this)},undo:()=>{this.opacity=w,at(this,u,Ot).call(this)},mustExec:!0,type:A.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},je=function(){const{width:l,height:w,rotation:v}=this.parent.viewport;switch(v){case 90:return[0,l,l,w];case 180:return[l,w,l,w];case 270:return[w,0,l,w];default:return[0,0,l,w]}},pe=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,$.opacityToHex)(this.opacity)}`},Be=function(l,w){this.isEditing=!0,C(this,d)||(ft(this,d,!0),at(this,u,Wt).call(this),this.thickness||(this.thickness=c._defaultThickness),this.color||(this.color=c._defaultColor||k.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=c._defaultOpacity)),this.currentPath.push([l,w]),ft(this,o,null),at(this,u,pe).call(this),this.ctx.beginPath(),this.ctx.moveTo(l,w),ft(this,r,()=>{C(this,r)&&(C(this,o)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):at(this,u,Ot).call(this),this.ctx.lineTo(...C(this,o)),ft(this,o,null),this.ctx.stroke()),window.requestAnimationFrame(C(this,r)))}),window.requestAnimationFrame(C(this,r))},We=function(l,w){const[v,M]=this.currentPath.at(-1);l===v&&w===M||(this.currentPath.push([l,w]),ft(this,o,[l,w]))},qe=function(l,w){var X;this.ctx.closePath(),ft(this,r,null),l=Math.min(Math.max(l,0),this.canvas.width),w=Math.min(Math.max(w,0),this.canvas.height);const[v,M]=this.currentPath.at(-1);(l!==v||w!==M)&&this.currentPath.push([l,w]);let L;if(this.currentPath.length!==1)L=(0,H.fitCurve)(this.currentPath,30,null);else{const ct=[l,w];L=[[ct,ct.slice(),ct.slice(),ct]]}const Z=at(X=c,a,be).call(X,L);this.currentPath.length=0;const B=()=>{this.paths.push(L),this.bezierPath2D.push(Z),this.rebuild()},st=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(at(this,u,Kt).call(this),at(this,u,Jt).call(this)),at(this,u,qt).call(this))};this.parent.addCommands({cmd:B,undo:st,mustExec:!0})},Ot=function(){if(this.isEmpty()){at(this,u,Qt).call(this);return}at(this,u,pe).call(this);const{canvas:l,ctx:w}=this;w.setTransform(1,0,0,1,0,0),w.clearRect(0,0,l.width,l.height),at(this,u,Qt).call(this);for(const v of this.bezierPath2D)w.stroke(v)},ge=function(l){at(this,u,qe).call(this,l.offsetX,l.offsetY),this.canvas.removeEventListener("pointerleave",C(this,h)),this.canvas.removeEventListener("pointermove",C(this,b)),this.parent.addToAnnotationStorage(this)},Kt=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",c._l10nPromise.get("editor_ink_canvas_aria_label").then(l=>{var w;return(w=this.canvas)==null?void 0:w.setAttribute("aria-label",l)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Jt=function(){let l=null;ft(this,p,new ResizeObserver(w=>{const v=w[0].contentRect;v.width&&v.height&&(l!==null&&clearTimeout(l),l=setTimeout(()=>{this.fixDims(),l=null},U),this.setDimensions(v.width,v.height))})),C(this,p).observe(this.div)},Wt=function(){if(!C(this,d))return;const[l,w]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*l),this.canvas.height=Math.ceil(this.height*w),at(this,u,Qt).call(this)},me=function(l,w){const v=at(this,u,Zt).call(this),M=(l-v)/C(this,S),L=(w-v)/C(this,R);this.scaleFactor=Math.min(M,L)},Qt=function(){const l=at(this,u,Zt).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+l,this.translationY*this.scaleFactor+l)},a=new WeakSet,be=function(l){const w=new Path2D;for(let v=0,M=l.length;v<M;v++){const[L,Z,B,st]=l[v];v===0&&w.moveTo(...L),w.bezierCurveTo(Z[0],Z[1],B[0],B[1],st[0],st[1])}return w},He=function(l,w,v,M){const Z=[],B=this.thickness/2;let st,X;for(const ct of this.paths){st=[],X=[];for(let _t=0,gt=ct.length;_t<gt;_t++){const[bt,yt,Et,vt]=ct[_t],wt=l*(bt[0]+w)+B,St=M-l*(bt[1]+v)-B,Ct=l*(yt[0]+w)+B,Dt=M-l*(yt[1]+v)-B,Ut=l*(Et[0]+w)+B,it=M-l*(Et[1]+v)-B,V=l*(vt[0]+w)+B,z=M-l*(vt[1]+v)-B;_t===0&&(st.push(wt,St),X.push(wt,St)),st.push(Ct,Dt,Ut,it,V,z),at(this,u,Ge).call(this,wt,St,Ct,Dt,Ut,it,V,z,4,X)}Z.push({bezier:st,points:X})}return Z},Ge=function(l,w,v,M,L,Z,B,st,X,ct){if(at(this,u,Xe).call(this,l,w,v,M,L,Z,B,st)){ct.push(B,st);return}for(let _t=1;_t<X-1;_t++){const gt=_t/X,bt=1-gt;let yt=gt*l+bt*v,Et=gt*w+bt*M,vt=gt*v+bt*L,wt=gt*M+bt*Z;const St=gt*L+bt*B,Ct=gt*Z+bt*st;yt=gt*yt+bt*vt,Et=gt*Et+bt*wt,vt=gt*vt+bt*St,wt=gt*wt+bt*Ct,yt=gt*yt+bt*vt,Et=gt*Et+bt*wt,ct.push(yt,Et)}ct.push(B,st)},Xe=function(l,w,v,M,L,Z,B,st){const ct=(3*v-2*l-B)**2,_t=(3*M-2*w-st)**2,gt=(3*L-l-2*B)**2,bt=(3*Z-w-2*st)**2;return Math.max(ct,gt)+Math.max(_t,bt)<=10},_e=function(){let l=1/0,w=-1/0,v=1/0,M=-1/0;for(const L of this.paths)for(const[Z,B,st,X]of L){const ct=A.Util.bezierBoundingBox(...Z,...B,...st,...X);l=Math.min(l,ct[0]),v=Math.min(v,ct[1]),w=Math.max(w,ct[2]),M=Math.max(M,ct[3])}return[l,v,w,M]},Zt=function(){return C(this,e)?Math.ceil(this.thickness*this.parent.scaleFactor):0},qt=function(l=!1){if(this.isEmpty())return;if(!C(this,e)){at(this,u,Ot).call(this);return}const w=at(this,u,_e).call(this),v=at(this,u,Zt).call(this);ft(this,S,Math.max(W,w[2]-w[0])),ft(this,R,Math.max(W,w[3]-w[1]));const M=Math.ceil(v+C(this,S)*this.scaleFactor),L=Math.ceil(v+C(this,R)*this.scaleFactor),[Z,B]=this.parent.viewportBaseDimensions;this.width=M/Z,this.height=L/B,ft(this,E,M/L),at(this,u,Ae).call(this);const st=this.translationX,X=this.translationY;this.translationX=-w[0],this.translationY=-w[1],at(this,u,Wt).call(this),at(this,u,Ot).call(this),ft(this,t,M),ft(this,n,L),this.setDims(M,L);const ct=l?v/this.scaleFactor/2:0;this.translate(st-this.translationX-ct,X-this.translationY-ct)},Ae=function(){const{style:l}=this.div;C(this,E)>=1?(l.minHeight=`${W}px`,l.minWidth=`${Math.round(C(this,E)*W)}px`):(l.minWidth=`${W}px`,l.minHeight=`${Math.round(W/C(this,E))}px`)},ht(c,a),xt(c,"_defaultColor",null),xt(c,"_defaultOpacity",1),xt(c,"_defaultThickness",1),xt(c,"_l10nPromise"),xt(c,"_type","ink");let T=c;m.InkEditor=T},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.fitCurve=void 0;const A=K(25);m.fitCurve=A},rt=>{function m(h,f,s){if(!Array.isArray(h))throw new TypeError("First argument should be an array");if(h.forEach(p=>{if(!Array.isArray(p)||p.some(t=>typeof t!="number")||p.length!==h[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),h=h.filter((p,t)=>t===0||!p.every((n,r)=>n===h[t-1][r])),h.length<2)return[];const e=h.length,d=R(h[1],h[0]),o=R(h[e-2],h[e-1]);return K(h,d,o,f,s)}function K(h,f,s,e,d){var p,t,n,r,u,x,G,I,lt,ut,ot,J,q;if(h.length===2)return J=S.vectorLen(S.subtract(h[0],h[1]))/3,p=[h[0],S.addArrays(h[0],S.mulItems(f,J)),S.addArrays(h[1],S.mulItems(s,J)),h[1]],[p];if(t=W(h),[p,r,x]=A(h,t,t,f,s,d),r===0||r<e)return[p];if(r<e*e)for(n=t,u=r,G=x,q=0;q<20;q++){if(n=H(p,h,n),[p,r,x]=A(h,t,n,f,s,d),r<e)return[p];if(x===G){let Y=r/u;if(Y>.9999&&Y<1.0001)break}u=r,G=x}return ot=[],I=S.subtract(h[x-1],h[x+1]),I.every(Y=>Y===0)&&(I=S.subtract(h[x-1],h[x]),[I[0],I[1]]=[-I[1],I[0]]),lt=S.normalize(I),ut=S.mulItems(lt,-1),ot=ot.concat(K(h.slice(0,x+1),f,lt,e,d)),ot=ot.concat(K(h.slice(x),ut,s,e,d)),ot}function A(h,f,s,e,d,o){var p,t,n;return p=k(h,s,e,d),[t,n]=U(h,p,f),o&&o({bez:p,points:h,params:f,maxErr:t,maxPoint:n}),[p,t,n]}function k(h,f,s,e){var d,o,p,t,n,r,u,x,G,I,lt,ut,ot,J,q,Y,et,nt=h[0],dt=h[h.length-1];for(d=[nt,null,null,dt],o=S.zeros_Xx2x2(f.length),ot=0,J=f.length;ot<J;ot++)Y=f[ot],et=1-Y,p=o[ot],p[0]=S.mulItems(s,3*Y*(et*et)),p[1]=S.mulItems(e,3*et*(Y*Y));for(t=[[0,0],[0,0]],n=[0,0],ot=0,J=h.length;ot<J;ot++)Y=f[ot],p=o[ot],t[0][0]+=S.dot(p[0],p[0]),t[0][1]+=S.dot(p[0],p[1]),t[1][0]+=S.dot(p[0],p[1]),t[1][1]+=S.dot(p[1],p[1]),q=S.subtract(h[ot],b.q([nt,nt,dt,dt],Y)),n[0]+=S.dot(p[0],q),n[1]+=S.dot(p[1],q);return r=t[0][0]*t[1][1]-t[1][0]*t[0][1],u=t[0][0]*n[1]-t[1][0]*n[0],x=n[0]*t[1][1]-n[1]*t[0][1],G=r===0?0:x/r,I=r===0?0:u/r,ut=S.vectorLen(S.subtract(nt,dt)),lt=1e-6*ut,G<lt||I<lt?(d[1]=S.addArrays(nt,S.mulItems(s,ut/3)),d[2]=S.addArrays(dt,S.mulItems(e,ut/3))):(d[1]=S.addArrays(nt,S.mulItems(s,G)),d[2]=S.addArrays(dt,S.mulItems(e,I))),d}function H(h,f,s){return s.map((e,d)=>$(h,f[d],e))}function $(h,f,s){var e=S.subtract(b.q(h,s),f),d=b.qprime(h,s),o=S.mulMatrix(e,d),p=S.sum(S.squareItems(d))+2*S.mulMatrix(e,b.qprimeprime(h,s));return p===0?s:s-o/p}function W(h){var f=[],s,e,d;return h.forEach((o,p)=>{s=p?e+S.vectorLen(S.subtract(o,d)):0,f.push(s),e=s,d=o}),f=f.map(o=>o/e),f}function U(h,f,s){var e,d,o,p,t,n,r,u;d=0,o=Math.floor(h.length/2);const x=T(f,10);for(t=0,n=h.length;t<n;t++)r=h[t],u=E(f,s[t],x,10),p=S.subtract(b.q(f,u),r),e=p[0]*p[0]+p[1]*p[1],e>d&&(d=e,o=t);return[d,o]}var T=function(h,f){for(var s,e=[0],d=h[0],o=0,p=1;p<=f;p++)s=b.q(h,p/f),o+=S.vectorLen(S.subtract(s,d)),e.push(o),d=s;return e=e.map(t=>t/o),e};function E(h,f,s,e){if(f<0)return 0;if(f>1)return 1;for(var d,o,p,t,n,r=1;r<=e;r++)if(f<=s[r]){t=(r-1)/e,p=r/e,o=s[r-1],d=s[r],n=(f-o)/(d-o)*(p-t)+t;break}return n}function R(h,f){return S.normalize(S.subtract(h,f))}class S{static zeros_Xx2x2(f){for(var s=[];f--;)s.push([0,0]);return s}static mulItems(f,s){return f.map(e=>e*s)}static mulMatrix(f,s){return f.reduce((e,d,o)=>e+d*s[o],0)}static subtract(f,s){return f.map((e,d)=>e-s[d])}static addArrays(f,s){return f.map((e,d)=>e+s[d])}static addItems(f,s){return f.map(e=>e+s)}static sum(f){return f.reduce((s,e)=>s+e)}static dot(f,s){return S.mulMatrix(f,s)}static vectorLen(f){return Math.hypot(...f)}static divItems(f,s){return f.map(e=>e/s)}static squareItems(f){return f.map(s=>s*s)}static normalize(f){return this.divItems(f,this.vectorLen(f))}}class b{static q(f,s){var e=1-s,d=S.mulItems(f[0],e*e*e),o=S.mulItems(f[1],3*e*e*s),p=S.mulItems(f[2],3*e*s*s),t=S.mulItems(f[3],s*s*s);return S.addArrays(S.addArrays(d,o),S.addArrays(p,t))}static qprime(f,s){var e=1-s,d=S.mulItems(S.subtract(f[1],f[0]),3*e*e),o=S.mulItems(S.subtract(f[2],f[1]),6*e*s),p=S.mulItems(S.subtract(f[3],f[2]),3*s*s);return S.addArrays(S.addArrays(d,o),p)}static qprimeprime(f,s){return S.addArrays(S.mulItems(S.addArrays(S.subtract(f[2],S.mulItems(f[1],2)),f[0]),6*(1-s)),S.mulItems(S.addArrays(S.subtract(f[3],S.mulItems(f[2],2)),f[1]),6*s))}}rt.exports=m,rt.exports.fitCubic=K,rt.exports.createTangent=R},(rt,m,K)=>{var g,ze,F,ye,ve,Se;Object.defineProperty(m,"__esModule",{value:!0}),m.AnnotationLayer=void 0;var A=K(1),k=K(6),H=K(3),$=K(27),W=K(28);const U=1e3,T=9,E=new WeakSet;function R(tt){return{width:tt[2]-tt[0],height:tt[3]-tt[1]}}class S{static create(i){switch(i.data.annotationType){case A.AnnotationType.LINK:return new h(i);case A.AnnotationType.TEXT:return new f(i);case A.AnnotationType.WIDGET:switch(i.data.fieldType){case"Tx":return new e(i);case"Btn":return i.data.radioButton?new o(i):i.data.checkBox?new d(i):new p(i);case"Ch":return new t(i)}return new s(i);case A.AnnotationType.POPUP:return new n(i);case A.AnnotationType.FREETEXT:return new u(i);case A.AnnotationType.LINE:return new x(i);case A.AnnotationType.SQUARE:return new G(i);case A.AnnotationType.CIRCLE:return new I(i);case A.AnnotationType.POLYLINE:return new lt(i);case A.AnnotationType.CARET:return new ot(i);case A.AnnotationType.INK:return new J(i);case A.AnnotationType.POLYGON:return new ut(i);case A.AnnotationType.HIGHLIGHT:return new q(i);case A.AnnotationType.UNDERLINE:return new Y(i);case A.AnnotationType.SQUIGGLY:return new et(i);case A.AnnotationType.STRIKEOUT:return new nt(i);case A.AnnotationType.STAMP:return new dt(i);case A.AnnotationType.FILEATTACHMENT:return new pt(i);default:return new b(i)}}}class b{constructor(i,{isRenderable:c=!1,ignoreBorder:_=!1,createQuadrilaterals:P=!1}={}){this.isRenderable=c,this.data=i.data,this.layer=i.layer,this.page=i.page,this.viewport=i.viewport,this.linkService=i.linkService,this.downloadManager=i.downloadManager,this.imageResourcesPath=i.imageResourcesPath,this.renderForms=i.renderForms,this.svgFactory=i.svgFactory,this.annotationStorage=i.annotationStorage,this.enableScripting=i.enableScripting,this.hasJSActions=i.hasJSActions,this._fieldObjects=i.fieldObjects,this._mouseState=i.mouseState,c&&(this.container=this._createContainer(_)),P&&(this.quadrilaterals=this._createQuadrilaterals(_))}_createContainer(i=!1){const c=this.data,_=this.page,P=this.viewport,l=document.createElement("section"),{width:w,height:v}=R(c.rect),[M,L,Z,B]=P.viewBox,st=Z-M,X=B-L;l.setAttribute("data-annotation-id",c.id);const ct=A.Util.normalizeRect([c.rect[0],_.view[3]-c.rect[1]+_.view[1],c.rect[2],_.view[3]-c.rect[3]+_.view[1]]);if(!i&&c.borderStyle.width>0){l.style.borderWidth=`${c.borderStyle.width}px`;const gt=c.borderStyle.horizontalCornerRadius,bt=c.borderStyle.verticalCornerRadius;if(gt>0||bt>0){const Et=`calc(${gt}px * var(--scale-factor)) / calc(${bt}px * var(--scale-factor))`;l.style.borderRadius=Et}else if(this instanceof o){const Et=`calc(${w}px * var(--scale-factor)) / calc(${v}px * var(--scale-factor))`;l.style.borderRadius=Et}switch(c.borderStyle.style){case A.AnnotationBorderStyleType.SOLID:l.style.borderStyle="solid";break;case A.AnnotationBorderStyleType.DASHED:l.style.borderStyle="dashed";break;case A.AnnotationBorderStyleType.BEVELED:(0,A.warn)("Unimplemented border style: beveled");break;case A.AnnotationBorderStyleType.INSET:(0,A.warn)("Unimplemented border style: inset");break;case A.AnnotationBorderStyleType.UNDERLINE:l.style.borderBottomStyle="solid";break}const yt=c.borderColor||null;yt?l.style.borderColor=A.Util.makeHexColor(yt[0]|0,yt[1]|0,yt[2]|0):l.style.borderWidth=0}l.style.left=`${100*(ct[0]-M)/st}%`,l.style.top=`${100*(ct[1]-L)/X}%`;const{rotation:_t}=c;return c.hasOwnCanvas||_t===0?(l.style.width=`${100*w/st}%`,l.style.height=`${100*v/X}%`):this.setRotation(_t,l),l}setRotation(i,c=this.container){const[_,P,l,w]=this.viewport.viewBox,v=l-_,M=w-P,{width:L,height:Z}=R(this.data.rect);let B,st;i%180===0?(B=100*L/v,st=100*Z/M):(B=100*Z/v,st=100*L/M),c.style.width=`${B}%`,c.style.height=`${st}%`,c.setAttribute("data-main-rotation",(360-i)%360)}get _commonActions(){const i=(c,_,P)=>{const l=P.detail[c];P.target.style[_]=$.ColorConverters[`${l[0]}_HTML`](l.slice(1))};return(0,A.shadow)(this,"_commonActions",{display:c=>{const _=c.detail.display%2===1;this.container.style.visibility=_?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:_,print:c.detail.display===0||c.detail.display===3})},print:c=>{this.annotationStorage.setValue(this.data.id,{print:c.detail.print})},hidden:c=>{this.container.style.visibility=c.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:c.detail.hidden})},focus:c=>{setTimeout(()=>c.target.focus({preventScroll:!1}),0)},userName:c=>{c.target.title=c.detail.userName},readonly:c=>{c.detail.readonly?c.target.setAttribute("readonly",""):c.target.removeAttribute("readonly")},required:c=>{this._setRequired(c.target,c.detail.required)},bgColor:c=>{i("bgColor","backgroundColor",c)},fillColor:c=>{i("fillColor","backgroundColor",c)},fgColor:c=>{i("fgColor","color",c)},textColor:c=>{i("textColor","color",c)},borderColor:c=>{i("borderColor","borderColor",c)},strokeColor:c=>{i("strokeColor","borderColor",c)},rotation:c=>{const _=c.detail.rotation;this.setRotation(_),this.annotationStorage.setValue(this.data.id,{rotation:_})}})}_dispatchEventFromSandbox(i,c){const _=this._commonActions;for(const P of Object.keys(c.detail)){const l=i[P]||_[P];l==null||l(c)}}_setDefaultPropertiesFromJS(i){if(!this.enableScripting)return;const c=this.annotationStorage.getRawValue(this.data.id);if(!c)return;const _=this._commonActions;for(const[P,l]of Object.entries(c)){const w=_[P];if(w){const v={detail:{[P]:l},target:i};w(v),delete c[P]}}}_createQuadrilaterals(i=!1){if(!this.data.quadPoints)return null;const c=[],_=this.data.rect;for(const P of this.data.quadPoints)this.data.rect=[P[2].x,P[2].y,P[1].x,P[1].y],c.push(this._createContainer(i));return this.data.rect=_,c}_createPopup(i,c){let _=this.container;this.quadrilaterals&&(i=i||this.quadrilaterals,_=this.quadrilaterals[0]),i||(i=document.createElement("div"),i.className="popupTriggerArea",_.append(i));const l=new r({container:_,trigger:i,color:c.color,titleObj:c.titleObj,modificationDate:c.modificationDate,contentsObj:c.contentsObj,richText:c.richText,hideWrapper:!0}).render();l.style.left="100%",_.append(l)}_renderQuadrilaterals(i){for(const c of this.quadrilaterals)c.className=i;return this.quadrilaterals}render(){(0,A.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(i,c=null){const _=[];if(this._fieldObjects){const P=this._fieldObjects[i];if(P)for(const{page:l,id:w,exportValues:v}of P){if(l===-1||w===c)continue;const M=typeof v=="string"?v:null,L=document.querySelector(`[data-element-id="${w}"]`);if(L&&!E.has(L)){(0,A.warn)(`_getElementsByName - element not allowed: ${w}`);continue}_.push({id:w,exportValue:M,domElement:L})}return _}for(const P of document.getElementsByName(i)){const{exportValue:l}=P,w=P.getAttribute("data-element-id");w!==c&&E.has(P)&&_.push({id:w,exportValue:l,domElement:P})}return _}static get platform(){const i=typeof navigator<"u"?navigator.platform:"";return(0,A.shadow)(this,"platform",{isWin:i.includes("Win"),isMac:i.includes("Mac")})}}class h extends b{constructor(c,_=null){super(c,{isRenderable:!0,ignoreBorder:!!(_!=null&&_.ignoreBorder),createQuadrilaterals:!0});ht(this,g);this.isTooltipOnly=c.data.isTooltipOnly}render(){const{data:c,linkService:_}=this,P=document.createElement("a");P.setAttribute("data-element-id",c.id);let l=!1;return c.url?(_.addLinkAttributes(P,c.url,c.newWindow),l=!0):c.action?(this._bindNamedAction(P,c.action),l=!0):c.attachment?(this._bindAttachment(P,c.attachment),l=!0):c.setOCGState?(at(this,g,ze).call(this,P,c.setOCGState),l=!0):c.dest?(this._bindLink(P,c.dest),l=!0):(c.actions&&(c.actions.Action||c.actions["Mouse Up"]||c.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(P,c),l=!0),c.resetForm?(this._bindResetFormAction(P,c.resetForm),l=!0):this.isTooltipOnly&&!l&&(this._bindLink(P,""),l=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((w,v)=>{const M=v===0?P:P.cloneNode();return w.append(M),w}):(this.container.className="linkAnnotation",l&&this.container.append(P),this.container)}_bindLink(c,_){c.href=this.linkService.getDestinationHash(_),c.onclick=()=>(_&&this.linkService.goToDestination(_),!1),(_||_==="")&&(c.className="internalLink")}_bindNamedAction(c,_){c.href=this.linkService.getAnchorUrl(""),c.onclick=()=>(this.linkService.executeNamedAction(_),!1),c.className="internalLink"}_bindAttachment(c,_){c.href=this.linkService.getAnchorUrl(""),c.onclick=()=>{var P;return(P=this.downloadManager)==null||P.openOrDownloadData(this.container,_.content,_.filename),!1},c.className="internalLink"}_bindJSAction(c,_){c.href=this.linkService.getAnchorUrl("");const P=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const l of Object.keys(_.actions)){const w=P.get(l);w&&(c[w]=()=>{var v;return(v=this.linkService.eventBus)==null||v.dispatch("dispatcheventinsandbox",{source:this,detail:{id:_.id,name:l}}),!1})}c.onclick||(c.onclick=()=>!1),c.className="internalLink"}_bindResetFormAction(c,_){const P=c.onclick;if(P||(c.href=this.linkService.getAnchorUrl("")),c.className="internalLink",!this._fieldObjects){(0,A.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),P||(c.onclick=()=>!1);return}c.onclick=()=>{var B;P==null||P();const{fields:l,refs:w,include:v}=_,M=[];if(l.length!==0||w.length!==0){const st=new Set(w);for(const X of l){const ct=this._fieldObjects[X]||[];for(const{id:_t}of ct)st.add(_t)}for(const X of Object.values(this._fieldObjects))for(const ct of X)st.has(ct.id)===v&&M.push(ct)}else for(const st of Object.values(this._fieldObjects))M.push(...st);const L=this.annotationStorage,Z=[];for(const st of M){const{id:X}=st;switch(Z.push(X),st.type){case"text":{const _t=st.defaultValue||"";L.setValue(X,{value:_t});break}case"checkbox":case"radiobutton":{const _t=st.defaultValue===st.exportValues;L.setValue(X,{value:_t});break}case"combobox":case"listbox":{const _t=st.defaultValue||"";L.setValue(X,{value:_t});break}default:continue}const ct=document.querySelector(`[data-element-id="${X}"]`);if(ct){if(!E.has(ct)){(0,A.warn)(`_bindResetFormAction - element not allowed: ${X}`);continue}}else continue;ct.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((B=this.linkService.eventBus)==null||B.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Z,name:"ResetForm"}})),!1}}}g=new WeakSet,ze=function(c,_){c.href=this.linkService.getAnchorUrl(""),c.onclick=()=>(this.linkService.executeSetOCGState(_),!1),c.className="internalLink"};class f extends b{constructor(i){var _,P,l;const c=!!(i.data.hasPopup||(_=i.data.titleObj)!=null&&_.str||(P=i.data.contentsObj)!=null&&P.str||(l=i.data.richText)!=null&&l.str);super(i,{isRenderable:c})}render(){this.container.className="textAnnotation";const i=document.createElement("img");return i.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",i.alt="[{{type}} Annotation]",i.dataset.l10nId="text_annotation_type",i.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(i,this.data),this.container.append(i),this.container}}class s extends b{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(i){const{isWin:c,isMac:_}=b.platform;return c&&i.ctrlKey||_&&i.metaKey}_setEventListener(i,c,_,P){c.includes("mouse")?i.addEventListener(c,l=>{var w;(w=this.linkService.eventBus)==null||w.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:_,value:P(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):i.addEventListener(c,l=>{var w;(w=this.linkService.eventBus)==null||w.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:_,value:P(l)}})})}_setEventListeners(i,c,_){var P;for(const[l,w]of c)(w==="Action"||(P=this.data.actions)!=null&&P[w])&&this._setEventListener(i,l,w,_)}_setBackgroundColor(i){const c=this.data.backgroundColor||null;i.style.backgroundColor=c===null?"transparent":A.Util.makeHexColor(c[0],c[1],c[2])}_setTextStyle(i){const c=["left","center","right"],{fontColor:_}=this.data.defaultAppearanceData,P=this.data.defaultAppearanceData.fontSize||T,l=i.style;let w;const v=2,M=L=>Math.round(10*L)/10;if(this.data.multiLine){const L=Math.abs(this.data.rect[3]-this.data.rect[1]-v),Z=Math.round(L/(A.LINE_FACTOR*P))||1,B=L/Z;w=Math.min(P,M(B/A.LINE_FACTOR))}else{const L=Math.abs(this.data.rect[3]-this.data.rect[1]-v);w=Math.min(P,M(L/A.LINE_FACTOR))}l.fontSize=`calc(${w}px * var(--scale-factor))`,l.color=A.Util.makeHexColor(_[0],_[1],_[2]),this.data.textAlignment!==null&&(l.textAlign=c[this.data.textAlignment])}_setRequired(i,c){c?i.setAttribute("required",!0):i.removeAttribute("required"),i.setAttribute("aria-required",c)}}class e extends s{constructor(i){const c=i.renderForms||!i.data.hasAppearance&&!!i.data.fieldValue;super(i,{isRenderable:c})}setPropertyOnSiblings(i,c,_,P){const l=this.annotationStorage;for(const w of this._getElementsByName(i.name,i.id))w.domElement&&(w.domElement[c]=_),l.setValue(w.id,{[P]:_})}render(){var P;const i=this.annotationStorage,c=this.data.id;this.container.className="textWidgetAnnotation";let _=null;if(this.renderForms){const l=i.getValue(c,{value:this.data.fieldValue});let w=l.formattedValue||l.value||"";const v=i.getValue(c,{charLimit:this.data.maxLen}).charLimit;v&&w.length>v&&(w=w.slice(0,v));const M={userValue:w,formattedValue:null,valueOnFocus:""};this.data.multiLine?(_=document.createElement("textarea"),_.textContent=w,this.data.doNotScroll&&(_.style.overflowY="hidden")):(_=document.createElement("input"),_.type="text",_.setAttribute("value",w),this.data.doNotScroll&&(_.style.overflowX="hidden")),E.add(_),_.setAttribute("data-element-id",c),_.disabled=this.data.readOnly,_.name=this.data.fieldName,_.tabIndex=U,this._setRequired(_,this.data.required),v&&(_.maxLength=v),_.addEventListener("input",Z=>{i.setValue(c,{value:Z.target.value}),this.setPropertyOnSiblings(_,"value",Z.target.value,"value")}),_.addEventListener("resetform",Z=>{const B=this.data.defaultFieldValue??"";_.value=M.userValue=B,M.formattedValue=null});let L=Z=>{const{formattedValue:B}=M;B!=null&&(Z.target.value=B),Z.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){_.addEventListener("focus",B=>{M.userValue&&(B.target.value=M.userValue),M.valueOnFocus=B.target.value}),_.addEventListener("updatefromsandbox",B=>{const st={value(X){M.userValue=X.detail.value??"",i.setValue(c,{value:M.userValue.toString()}),X.target.value=M.userValue},formattedValue(X){const{formattedValue:ct}=X.detail;M.formattedValue=ct,ct!=null&&X.target!==document.activeElement&&(X.target.value=ct),i.setValue(c,{formattedValue:ct})},selRange(X){X.target.setSelectionRange(...X.detail.selRange)},charLimit:X=>{var bt;const{charLimit:ct}=X.detail,{target:_t}=X;if(ct===0){_t.removeAttribute("maxLength");return}_t.setAttribute("maxLength",ct);let gt=M.userValue;!gt||gt.length<=ct||(gt=gt.slice(0,ct),_t.value=M.userValue=gt,i.setValue(c,{value:gt}),(bt=this.linkService.eventBus)==null||bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:c,name:"Keystroke",value:gt,willCommit:!0,commitKey:1,selStart:_t.selectionStart,selEnd:_t.selectionEnd}}))}};this._dispatchEventFromSandbox(st,B)}),_.addEventListener("keydown",B=>{var ct;let st=-1;if(B.key==="Escape"?st=0:B.key==="Enter"&&!this.data.multiLine?st=2:B.key==="Tab"&&(st=3),st===-1)return;const{value:X}=B.target;M.valueOnFocus!==X&&(M.userValue=X,(ct=this.linkService.eventBus)==null||ct.dispatch("dispatcheventinsandbox",{source:this,detail:{id:c,name:"Keystroke",value:X,willCommit:!0,commitKey:st,selStart:B.target.selectionStart,selEnd:B.target.selectionEnd}}))});const Z=L;L=null,_.addEventListener("blur",B=>{var X;const{value:st}=B.target;M.userValue=st,this._mouseState.isDown&&M.valueOnFocus!==st&&((X=this.linkService.eventBus)==null||X.dispatch("dispatcheventinsandbox",{source:this,detail:{id:c,name:"Keystroke",value:st,willCommit:!0,commitKey:1,selStart:B.target.selectionStart,selEnd:B.target.selectionEnd}})),Z(B)}),(P=this.data.actions)!=null&&P.Keystroke&&_.addEventListener("beforeinput",B=>{var Et;const{data:st,target:X}=B,{value:ct,selectionStart:_t,selectionEnd:gt}=X;let bt=_t,yt=gt;switch(B.inputType){case"deleteWordBackward":{const vt=ct.substring(0,_t).match(/\w*[^\w]*$/);vt&&(bt-=vt[0].length);break}case"deleteWordForward":{const vt=ct.substring(_t).match(/^[^\w]*\w*/);vt&&(yt+=vt[0].length);break}case"deleteContentBackward":_t===gt&&(bt-=1);break;case"deleteContentForward":_t===gt&&(yt+=1);break}B.preventDefault(),(Et=this.linkService.eventBus)==null||Et.dispatch("dispatcheventinsandbox",{source:this,detail:{id:c,name:"Keystroke",value:ct,change:st||"",willCommit:!1,selStart:bt,selEnd:yt}})}),this._setEventListeners(_,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],B=>B.target.value)}if(L&&_.addEventListener("blur",L),this.data.comb){const B=(this.data.rect[2]-this.data.rect[0])/v;_.classList.add("comb"),_.style.letterSpacing=`calc(${B}px * var(--scale-factor) - 1ch)`}}else _=document.createElement("div"),_.textContent=this.data.fieldValue,_.style.verticalAlign="middle",_.style.display="table-cell";return this._setTextStyle(_),this._setBackgroundColor(_),this._setDefaultPropertiesFromJS(_),this.container.append(_),this.container}}class d extends s{constructor(i){super(i,{isRenderable:i.renderForms})}render(){const i=this.annotationStorage,c=this.data,_=c.id;let P=i.getValue(_,{value:c.exportValue===c.fieldValue}).value;typeof P=="string"&&(P=P!=="Off",i.setValue(_,{value:P})),this.container.className="buttonWidgetAnnotation checkBox";const l=document.createElement("input");return E.add(l),l.setAttribute("data-element-id",_),l.disabled=c.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=c.fieldName,P&&l.setAttribute("checked",!0),l.setAttribute("exportValue",c.exportValue),l.tabIndex=U,l.addEventListener("change",w=>{const{name:v,checked:M}=w.target;for(const L of this._getElementsByName(v,_)){const Z=M&&L.exportValue===c.exportValue;L.domElement&&(L.domElement.checked=Z),i.setValue(L.id,{value:Z})}i.setValue(_,{value:M})}),l.addEventListener("resetform",w=>{const v=c.defaultFieldValue||"Off";w.target.checked=v===c.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",w=>{const v={value(M){M.target.checked=M.detail.value!=="Off",i.setValue(_,{value:M.target.checked})}};this._dispatchEventFromSandbox(v,w)}),this._setEventListeners(l,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],w=>w.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class o extends s{constructor(i){super(i,{isRenderable:i.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const i=this.annotationStorage,c=this.data,_=c.id;let P=i.getValue(_,{value:c.fieldValue===c.buttonValue}).value;typeof P=="string"&&(P=P!==c.buttonValue,i.setValue(_,{value:P}));const l=document.createElement("input");if(E.add(l),l.setAttribute("data-element-id",_),l.disabled=c.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=c.fieldName,P&&l.setAttribute("checked",!0),l.tabIndex=U,l.addEventListener("change",w=>{const{name:v,checked:M}=w.target;for(const L of this._getElementsByName(v,_))i.setValue(L.id,{value:!1});i.setValue(_,{value:M})}),l.addEventListener("resetform",w=>{const v=c.defaultFieldValue;w.target.checked=v!=null&&v===c.buttonValue}),this.enableScripting&&this.hasJSActions){const w=c.buttonValue;l.addEventListener("updatefromsandbox",v=>{const M={value:L=>{const Z=w===L.detail.value;for(const B of this._getElementsByName(L.target.name)){const st=Z&&B.id===_;B.domElement&&(B.domElement.checked=st),i.setValue(B.id,{value:st})}}};this._dispatchEventFromSandbox(M,v)}),this._setEventListeners(l,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],v=>v.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class p extends h{constructor(i){super(i,{ignoreBorder:i.data.hasAppearance})}render(){const i=super.render();i.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(i.title=this.data.alternativeText);const c=i.lastChild;return this.enableScripting&&this.hasJSActions&&c&&(this._setDefaultPropertiesFromJS(c),c.addEventListener("updatefromsandbox",_=>{this._dispatchEventFromSandbox({},_)})),i}}class t extends s{constructor(i){super(i,{isRenderable:i.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const i=this.annotationStorage,c=this.data.id,_=i.getValue(c,{value:this.data.fieldValue}),P=document.createElement("select");E.add(P),P.setAttribute("data-element-id",c),P.disabled=this.data.readOnly,this._setRequired(P,this.data.required),P.name=this.data.fieldName,P.tabIndex=U;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(P.size=this.data.options.length,this.data.multiSelect&&(P.multiple=!0)),P.addEventListener("resetform",L=>{const Z=this.data.defaultFieldValue;for(const B of P.options)B.selected=B.value===Z});for(const L of this.data.options){const Z=document.createElement("option");Z.textContent=L.displayValue,Z.value=L.exportValue,_.value.includes(L.exportValue)&&(Z.setAttribute("selected",!0),l=!1),P.append(Z)}let w=null;if(l){const L=document.createElement("option");L.value=" ",L.setAttribute("hidden",!0),L.setAttribute("selected",!0),P.prepend(L),w=()=>{L.remove(),P.removeEventListener("input",w),w=null},P.addEventListener("input",w)}const v=(L,Z)=>{const B=Z?"value":"textContent",st=L.target.options;return L.target.multiple?Array.prototype.filter.call(st,X=>X.selected).map(X=>X[B]):st.selectedIndex===-1?null:st[st.selectedIndex][B]},M=L=>{const Z=L.target.options;return Array.prototype.map.call(Z,B=>({displayValue:B.textContent,exportValue:B.value}))};return this.enableScripting&&this.hasJSActions?(P.addEventListener("updatefromsandbox",L=>{const Z={value(B){w==null||w();const st=B.detail.value,X=new Set(Array.isArray(st)?st:[st]);for(const ct of P.options)ct.selected=X.has(ct.value);i.setValue(c,{value:v(B,!0)})},multipleSelection(B){P.multiple=!0},remove(B){const st=P.options,X=B.detail.remove;st[X].selected=!1,P.remove(X),st.length>0&&Array.prototype.findIndex.call(st,_t=>_t.selected)===-1&&(st[0].selected=!0),i.setValue(c,{value:v(B,!0),items:M(B)})},clear(B){for(;P.length!==0;)P.remove(0);i.setValue(c,{value:null,items:[]})},insert(B){const{index:st,displayValue:X,exportValue:ct}=B.detail.insert,_t=P.children[st],gt=document.createElement("option");gt.textContent=X,gt.value=ct,_t?_t.before(gt):P.append(gt),i.setValue(c,{value:v(B,!0),items:M(B)})},items(B){const{items:st}=B.detail;for(;P.length!==0;)P.remove(0);for(const X of st){const{displayValue:ct,exportValue:_t}=X,gt=document.createElement("option");gt.textContent=ct,gt.value=_t,P.append(gt)}P.options.length>0&&(P.options[0].selected=!0),i.setValue(c,{value:v(B,!0),items:M(B)})},indices(B){const st=new Set(B.detail.indices);for(const X of B.target.options)X.selected=st.has(X.index);i.setValue(c,{value:v(B,!0)})},editable(B){B.target.disabled=!B.detail.editable}};this._dispatchEventFromSandbox(Z,L)}),P.addEventListener("input",L=>{var st;const Z=v(L,!0),B=v(L,!1);i.setValue(c,{value:Z}),(st=this.linkService.eventBus)==null||st.dispatch("dispatcheventinsandbox",{source:this,detail:{id:c,name:"Keystroke",value:B,changeEx:Z,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(P,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],L=>L.target.checked)):P.addEventListener("input",function(L){i.setValue(c,{value:v(L,!0)})}),this.data.combo&&this._setTextStyle(P),this._setBackgroundColor(P),this._setDefaultPropertiesFromJS(P),this.container.append(P),this.container}}const y=class y extends b{constructor(i){var P,l,w;const{data:c}=i,_=!y.IGNORE_TYPES.has(c.parentType)&&!!((P=c.titleObj)!=null&&P.str||(l=c.contentsObj)!=null&&l.str||(w=c.richText)!=null&&w.str);super(i,{isRenderable:_})}render(){this.container.className="popupAnnotation";const i=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(i.length===0)return this.container;const c=new r({container:this.container,trigger:Array.from(i),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),_=this.page,P=A.Util.normalizeRect([this.data.parentRect[0],_.view[3]-this.data.parentRect[1]+_.view[1],this.data.parentRect[2],_.view[3]-this.data.parentRect[3]+_.view[1]]),l=P[0]+this.data.parentRect[2]-this.data.parentRect[0],w=P[1],[v,M,L,Z]=this.viewport.viewBox,B=L-v,st=Z-M;return this.container.style.left=`${100*(l-v)/B}%`,this.container.style.top=`${100*(w-M)/st}%`,this.container.append(c.render()),this.container}};xt(y,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));let n=y;class r{constructor(i){this.container=i.container,this.trigger=i.trigger,this.color=i.color,this.titleObj=i.titleObj,this.modificationDate=i.modificationDate,this.contentsObj=i.contentsObj,this.richText=i.richText,this.hideWrapper=i.hideWrapper||!1,this.pinned=!1}render(){var v,M;const c=document.createElement("div");c.className="popupWrapper",this.hideElement=this.hideWrapper?c:this.container,this.hideElement.hidden=!0;const _=document.createElement("div");_.className="popup";const P=this.color;if(P){const L=.7*(255-P[0])+P[0],Z=.7*(255-P[1])+P[1],B=.7*(255-P[2])+P[2];_.style.backgroundColor=A.Util.makeHexColor(L|0,Z|0,B|0)}const l=document.createElement("h1");l.dir=this.titleObj.dir,l.textContent=this.titleObj.str,_.append(l);const w=k.PDFDateString.toDateObject(this.modificationDate);if(w){const L=document.createElement("span");L.className="popupDate",L.textContent="{{date}}, {{time}}",L.dataset.l10nId="annotation_date_string",L.dataset.l10nArgs=JSON.stringify({date:w.toLocaleDateString(),time:w.toLocaleTimeString()}),_.append(L)}if((v=this.richText)!=null&&v.str&&(!((M=this.contentsObj)!=null&&M.str)||this.contentsObj.str===this.richText.str))W.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:_}),_.lastChild.className="richText popupContent";else{const L=this._formatContents(this.contentsObj);_.append(L)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const L of this.trigger)L.addEventListener("click",this._toggle.bind(this)),L.addEventListener("mouseover",this._show.bind(this,!1)),L.addEventListener("mouseout",this._hide.bind(this,!1));return _.addEventListener("click",this._hide.bind(this,!0)),c.append(_),c}_formatContents({str:i,dir:c}){const _=document.createElement("p");_.className="popupContent",_.dir=c;const P=i.split(/(?:\r\n?|\n)/);for(let l=0,w=P.length;l<w;++l){const v=P[l];_.append(document.createTextNode(v)),l<w-1&&_.append(document.createElement("br"))}return _}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(i=!1){i&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(i=!0){i&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class u extends b{constructor(i){var _,P,l;const c=!!(i.data.hasPopup||(_=i.data.titleObj)!=null&&_.str||(P=i.data.contentsObj)!=null&&P.str||(l=i.data.richText)!=null&&l.str);super(i,{isRenderable:c,ignoreBorder:!0}),this.textContent=i.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const i=document.createElement("div");i.className="annotationTextContent",i.setAttribute("role","comment");for(const c of this.textContent){const _=document.createElement("span");_.textContent=c,i.append(_)}this.container.append(i)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class x extends b{constructor(i){var _,P,l;const c=!!(i.data.hasPopup||(_=i.data.titleObj)!=null&&_.str||(P=i.data.contentsObj)!=null&&P.str||(l=i.data.richText)!=null&&l.str);super(i,{isRenderable:c,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const i=this.data,{width:c,height:_}=R(i.rect),P=this.svgFactory.create(c,_,!0),l=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",i.rect[2]-i.lineCoordinates[0]),l.setAttribute("y1",i.rect[3]-i.lineCoordinates[1]),l.setAttribute("x2",i.rect[2]-i.lineCoordinates[2]),l.setAttribute("y2",i.rect[3]-i.lineCoordinates[3]),l.setAttribute("stroke-width",i.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),P.append(l),this.container.append(P),this._createPopup(l,i),this.container}}class G extends b{constructor(i){var _,P,l;const c=!!(i.data.hasPopup||(_=i.data.titleObj)!=null&&_.str||(P=i.data.contentsObj)!=null&&P.str||(l=i.data.richText)!=null&&l.str);super(i,{isRenderable:c,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const i=this.data,{width:c,height:_}=R(i.rect),P=this.svgFactory.create(c,_,!0),l=i.borderStyle.width,w=this.svgFactory.createElement("svg:rect");return w.setAttribute("x",l/2),w.setAttribute("y",l/2),w.setAttribute("width",c-l),w.setAttribute("height",_-l),w.setAttribute("stroke-width",l||1),w.setAttribute("stroke","transparent"),w.setAttribute("fill","transparent"),P.append(w),this.container.append(P),this._createPopup(w,i),this.container}}class I extends b{constructor(i){var _,P,l;const c=!!(i.data.hasPopup||(_=i.data.titleObj)!=null&&_.str||(P=i.data.contentsObj)!=null&&P.str||(l=i.data.richText)!=null&&l.str);super(i,{isRenderable:c,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const i=this.data,{width:c,height:_}=R(i.rect),P=this.svgFactory.create(c,_,!0),l=i.borderStyle.width,w=this.svgFactory.createElement("svg:ellipse");return w.setAttribute("cx",c/2),w.setAttribute("cy",_/2),w.setAttribute("rx",c/2-l/2),w.setAttribute("ry",_/2-l/2),w.setAttribute("stroke-width",l||1),w.setAttribute("stroke","transparent"),w.setAttribute("fill","transparent"),P.append(w),this.container.append(P),this._createPopup(w,i),this.container}}class lt extends b{constructor(i){var _,P,l;const c=!!(i.data.hasPopup||(_=i.data.titleObj)!=null&&_.str||(P=i.data.contentsObj)!=null&&P.str||(l=i.data.richText)!=null&&l.str);super(i,{isRenderable:c,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const i=this.data,{width:c,height:_}=R(i.rect),P=this.svgFactory.create(c,_,!0);let l=[];for(const v of i.vertices){const M=v.x-i.rect[0],L=i.rect[3]-v.y;l.push(M+","+L)}l=l.join(" ");const w=this.svgFactory.createElement(this.svgElementName);return w.setAttribute("points",l),w.setAttribute("stroke-width",i.borderStyle.width||1),w.setAttribute("stroke","transparent"),w.setAttribute("fill","transparent"),P.append(w),this.container.append(P),this._createPopup(w,i),this.container}}class ut extends lt{constructor(i){super(i),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class ot extends b{constructor(i){var _,P,l;const c=!!(i.data.hasPopup||(_=i.data.titleObj)!=null&&_.str||(P=i.data.contentsObj)!=null&&P.str||(l=i.data.richText)!=null&&l.str);super(i,{isRenderable:c,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class J extends b{constructor(i){var _,P,l;const c=!!(i.data.hasPopup||(_=i.data.titleObj)!=null&&_.str||(P=i.data.contentsObj)!=null&&P.str||(l=i.data.richText)!=null&&l.str);super(i,{isRenderable:c,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const i=this.data,{width:c,height:_}=R(i.rect),P=this.svgFactory.create(c,_,!0);for(const l of i.inkLists){let w=[];for(const M of l){const L=M.x-i.rect[0],Z=i.rect[3]-M.y;w.push(`${L},${Z}`)}w=w.join(" ");const v=this.svgFactory.createElement(this.svgElementName);v.setAttribute("points",w),v.setAttribute("stroke-width",i.borderStyle.width||1),v.setAttribute("stroke","transparent"),v.setAttribute("fill","transparent"),this._createPopup(v,i),P.append(v)}return this.container.append(P),this.container}}class q extends b{constructor(i){var _,P,l;const c=!!(i.data.hasPopup||(_=i.data.titleObj)!=null&&_.str||(P=i.data.contentsObj)!=null&&P.str||(l=i.data.richText)!=null&&l.str);super(i,{isRenderable:c,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class Y extends b{constructor(i){var _,P,l;const c=!!(i.data.hasPopup||(_=i.data.titleObj)!=null&&_.str||(P=i.data.contentsObj)!=null&&P.str||(l=i.data.richText)!=null&&l.str);super(i,{isRenderable:c,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class et extends b{constructor(i){var _,P,l;const c=!!(i.data.hasPopup||(_=i.data.titleObj)!=null&&_.str||(P=i.data.contentsObj)!=null&&P.str||(l=i.data.richText)!=null&&l.str);super(i,{isRenderable:c,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class nt extends b{constructor(i){var _,P,l;const c=!!(i.data.hasPopup||(_=i.data.titleObj)!=null&&_.str||(P=i.data.contentsObj)!=null&&P.str||(l=i.data.richText)!=null&&l.str);super(i,{isRenderable:c,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class dt extends b{constructor(i){var _,P,l;const c=!!(i.data.hasPopup||(_=i.data.titleObj)!=null&&_.str||(P=i.data.contentsObj)!=null&&P.str||(l=i.data.richText)!=null&&l.str);super(i,{isRenderable:c,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class pt extends b{constructor(i){var P;super(i,{isRenderable:!0});const{filename:c,content:_}=this.data.file;this.filename=(0,k.getFilenameFromUrl)(c),this.content=_,(P=this.linkService.eventBus)==null||P.dispatch("fileattachmentannotation",{source:this,filename:c,content:_})}render(){var c,_;this.container.className="fileAttachmentAnnotation";const i=document.createElement("div");return i.className="popupTriggerArea",i.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((c=this.data.titleObj)!=null&&c.str||(_=this.data.contentsObj)!=null&&_.str||this.data.richText)&&this._createPopup(i,this.data),this.container.append(i),this.container}_download(){var i;(i=this.downloadManager)==null||i.openOrDownloadData(this.container,this.content,this.filename)}}const Q=class Q{static render(i){var v,M;const{annotations:c,div:_,viewport:P,accessibilityManager:l}=i;at(this,F,ve).call(this,_,P);let w=0;for(const L of c){if(L.annotationType!==A.AnnotationType.POPUP){const{width:B,height:st}=R(L.rect);if(B<=0||st<=0)continue}const Z=S.create({data:L,layer:_,page:i.page,viewport:P,linkService:i.linkService,downloadManager:i.downloadManager,imageResourcesPath:i.imageResourcesPath||"",renderForms:i.renderForms!==!1,svgFactory:new k.DOMSVGFactory,annotationStorage:i.annotationStorage||new H.AnnotationStorage,enableScripting:i.enableScripting,hasJSActions:i.hasJSActions,fieldObjects:i.fieldObjects,mouseState:i.mouseState||{isDown:!1}});if(Z.isRenderable){const B=Z.render();if(L.hidden&&(B.style.visibility="hidden"),Array.isArray(B))for(const st of B)st.style.zIndex=w++,at(v=Q,F,ye).call(v,st,L.id,_,l);else B.style.zIndex=w++,Z instanceof n?_.prepend(B):at(M=Q,F,ye).call(M,B,L.id,_,l)}}at(this,F,Se).call(this,_,i.annotationCanvasMap)}static update(i){const{annotationCanvasMap:c,div:_,viewport:P}=i;at(this,F,ve).call(this,_,P),at(this,F,Se).call(this,_,c),_.hidden=!1}};F=new WeakSet,ye=function(i,c,_,P){const l=i.firstChild||i;l.id=`${k.AnnotationPrefix}${c}`,_.append(i),P==null||P.moveElementInDOM(_,i,l,!1)},ve=function(i,{width:c,height:_,rotation:P}){const{style:l}=i,w=P%180!==0,v=Math.floor(c)+"px",M=Math.floor(_)+"px";l.width=w?M:v,l.height=w?v:M,i.setAttribute("data-main-rotation",P)},Se=function(i,c){if(c){for(const[_,P]of c){const l=i.querySelector(`[data-annotation-id="${_}"]`);if(!l)continue;const{firstChild:w}=l;w?w.nodeName==="CANVAS"?w.replaceWith(P):w.before(P):l.append(P)}c.clear()}},ht(Q,F);let D=Q;m.AnnotationLayer=D},(rt,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.ColorConverters=void 0;function K(k){return Math.floor(Math.max(0,Math.min(1,k))*255).toString(16).padStart(2,"0")}class A{static CMYK_G([H,$,W,U]){return["G",1-Math.min(1,.3*H+.59*W+.11*$+U)]}static G_CMYK([H]){return["CMYK",0,0,0,1-H]}static G_RGB([H]){return["RGB",H,H,H]}static G_HTML([H]){const $=K(H);return`#${$}${$}${$}`}static RGB_G([H,$,W]){return["G",.3*H+.59*$+.11*W]}static RGB_HTML([H,$,W]){const U=K(H),T=K($),E=K(W);return`#${U}${T}${E}`}static T_HTML(){return"#00000000"}static CMYK_RGB([H,$,W,U]){return["RGB",1-Math.min(1,H+U),1-Math.min(1,W+U),1-Math.min(1,$+U)]}static CMYK_HTML(H){const $=this.CMYK_RGB(H).slice(1);return this.RGB_HTML($)}static RGB_CMYK([H,$,W]){const U=1-H,T=1-$,E=1-W,R=Math.min(U,T,E);return["CMYK",U,T,E,R]}}m.ColorConverters=A},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.XfaLayer=void 0;var A=K(19);class k{static setupStorage($,W,U,T,E){const R=T.getValue(W,{value:null});switch(U.name){case"textarea":if(R.value!==null&&($.textContent=R.value),E==="print")break;$.addEventListener("input",S=>{T.setValue(W,{value:S.target.value})});break;case"input":if(U.attributes.type==="radio"||U.attributes.type==="checkbox"){if(R.value===U.attributes.xfaOn?$.setAttribute("checked",!0):R.value===U.attributes.xfaOff&&$.removeAttribute("checked"),E==="print")break;$.addEventListener("change",S=>{T.setValue(W,{value:S.target.checked?S.target.getAttribute("xfaOn"):S.target.getAttribute("xfaOff")})})}else{if(R.value!==null&&$.setAttribute("value",R.value),E==="print")break;$.addEventListener("input",S=>{T.setValue(W,{value:S.target.value})})}break;case"select":if(R.value!==null)for(const S of U.children)S.attributes.value===R.value&&(S.attributes.selected=!0);$.addEventListener("input",S=>{const b=S.target.options,h=b.selectedIndex===-1?"":b[b.selectedIndex].value;T.setValue(W,{value:h})});break}}static setAttributes({html:$,element:W,storage:U=null,intent:T,linkService:E}){const{attributes:R}=W,S=$ instanceof HTMLAnchorElement;R.type==="radio"&&(R.name=`${R.name}-${T}`);for(const[b,h]of Object.entries(R))if(h!=null)switch(b){case"class":h.length&&$.setAttribute(b,h.join(" "));break;case"dataId":break;case"id":$.setAttribute("data-element-id",h);break;case"style":Object.assign($.style,h);break;case"textContent":$.textContent=h;break;default:(!S||b!=="href"&&b!=="newWindow")&&$.setAttribute(b,h)}S&&E.addLinkAttributes($,R.href,R.newWindow),U&&R.dataId&&this.setupStorage($,R.dataId,W,U)}static render($){var f;const W=$.annotationStorage,U=$.linkService,T=$.xfaHtml,E=$.intent||"display",R=document.createElement(T.name);T.attributes&&this.setAttributes({html:R,element:T,intent:E,linkService:U});const S=[[T,-1,R]],b=$.div;if(b.append(R),$.viewport){const s=`matrix(${$.viewport.transform.join(",")})`;b.style.transform=s}E!=="richText"&&b.setAttribute("class","xfaLayer xfaFont");const h=[];for(;S.length>0;){const[s,e,d]=S.at(-1);if(e+1===s.children.length){S.pop();continue}const o=s.children[++S.at(-1)[1]];if(o===null)continue;const{name:p}=o;if(p==="#text"){const n=document.createTextNode(o.value);h.push(n),d.append(n);continue}let t;if((f=o==null?void 0:o.attributes)!=null&&f.xmlns?t=document.createElementNS(o.attributes.xmlns,p):t=document.createElement(p),d.append(t),o.attributes&&this.setAttributes({html:t,element:o,storage:W,intent:E,linkService:U}),o.children&&o.children.length>0)S.push([o,-1,t]);else if(o.value){const n=document.createTextNode(o.value);A.XfaText.shouldBuildText(p)&&h.push(n),t.append(n)}}for(const s of b.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))s.setAttribute("readOnly",!0);return{textDivs:h}}static update($){const W=`matrix(${$.viewport.transform.join(",")})`;$.div.style.transform=W,$.div.hidden=!1}}m.XfaLayer=k},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.TextLayerRenderTask=void 0,m.renderTextLayer=S;var A=K(1);const k=1e5,H=30,$=.8,W=new Map;function U(b,h){const f=W.get(b);if(f)return f;h.save(),h.font=`${H}px ${b}`;const s=h.measureText("");let e=s.fontBoundingBoxAscent,d=Math.abs(s.fontBoundingBoxDescent);if(e){h.restore();const p=e/(e+d);return W.set(b,p),p}h.strokeStyle="red",h.clearRect(0,0,H,H),h.strokeText("g",0,0);let o=h.getImageData(0,0,H,H).data;d=0;for(let p=o.length-1-3;p>=0;p-=4)if(o[p]>0){d=Math.ceil(p/4/H);break}h.clearRect(0,0,H,H),h.strokeText("A",0,H),o=h.getImageData(0,0,H,H).data,e=0;for(let p=0,t=o.length;p<t;p+=4)if(o[p]>0){e=H-Math.floor(p/4/H);break}if(h.restore(),e){const p=e/(e+d);return W.set(b,p),p}return W.set(b,$),$}function T(b,h,f,s){const e=document.createElement("span"),d={angle:0,canvasWidth:0,hasText:h.str!=="",hasEOL:h.hasEOL,fontSize:0};b._textDivs.push(e);const o=A.Util.transform(b._viewport.transform,h.transform);let p=Math.atan2(o[1],o[0]);const t=f[h.fontName];t.vertical&&(p+=Math.PI/2);const n=Math.hypot(o[2],o[3]),r=n*U(t.fontFamily,s);let u,x;p===0?(u=o[4],x=o[5]-r):(u=o[4]+r*Math.sin(p),x=o[5]-r*Math.cos(p)),e.style.left=`${u}px`,e.style.top=`${x}px`,e.style.fontSize=`${n}px`,e.style.fontFamily=t.fontFamily,d.fontSize=n,e.setAttribute("role","presentation"),e.textContent=h.str,e.dir=h.dir,b._fontInspectorEnabled&&(e.dataset.fontName=h.fontName),p!==0&&(d.angle=p*(180/Math.PI));let G=!1;if(h.str.length>1)G=!0;else if(h.str!==" "&&h.transform[0]!==h.transform[3]){const I=Math.abs(h.transform[0]),lt=Math.abs(h.transform[3]);I!==lt&&Math.max(I,lt)/Math.min(I,lt)>1.5&&(G=!0)}G&&(t.vertical?d.canvasWidth=h.height*b._viewport.scale:d.canvasWidth=h.width*b._viewport.scale),b._textDivProperties.set(e,d),b._textContentStream&&b._layoutText(e)}function E(b){if(b._canceled)return;const h=b._textDivs,f=b._capability;if(h.length>k){b._renderingDone=!0,f.resolve();return}if(!b._textContentStream)for(const e of h)b._layoutText(e);b._renderingDone=!0,f.resolve()}class R{constructor({textContent:h,textContentStream:f,container:s,viewport:e,textDivs:d,textContentItemsStr:o}){var p;this._textContent=h,this._textContentStream=f,this._container=s,this._document=s.ownerDocument,this._viewport=e,this._textDivs=d||[],this._textContentItemsStr=o||[],this._fontInspectorEnabled=!!((p=globalThis.FontInspector)!=null&&p.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,A.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._textDivProperties=null,this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new A.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(h,f){for(const s of h){if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const e=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),s.id!==null&&this._container.setAttribute("id",`${s.id}`),e.append(this._container)}else s.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(s.str),T(this,s,f,this._layoutTextCtx)}}_layoutText(h){const f=this._textDivProperties.get(h);let s="";if(f.canvasWidth!==0&&f.hasText){const{fontFamily:e}=h.style,{fontSize:d}=f;(d!==this._layoutTextLastFontSize||e!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${d*this._devicePixelRatio}px ${e}`,this._layoutTextLastFontSize=d,this._layoutTextLastFontFamily=e);const{width:o}=this._layoutTextCtx.measureText(h.textContent);o>0&&(s=`scaleX(${this._devicePixelRatio*f.canvasWidth/o})`)}if(f.angle!==0&&(s=`rotate(${f.angle}deg) ${s}`),s.length>0&&(h.style.transform=s),f.hasText&&this._container.append(h),f.hasEOL){const e=document.createElement("br");e.setAttribute("role","presentation"),this._container.append(e)}}_render(h=0){const f=(0,A.createPromiseCapability)();let s=Object.create(null);const e=this._document.createElement("canvas");if(e.height=e.width=H,this._layoutTextCtx=e.getContext("2d",{alpha:!1}),this._textContent){const d=this._textContent.items,o=this._textContent.styles;this._processItems(d,o),f.resolve()}else if(this._textContentStream){const d=()=>{this._reader.read().then(({value:o,done:p})=>{if(p){f.resolve();return}Object.assign(s,o.styles),this._processItems(o.items,s),d()},f.reject)};this._reader=this._textContentStream.getReader(),d()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');f.promise.then(()=>{s=null,h?this._renderTimer=setTimeout(()=>{E(this),this._renderTimer=null},h):E(this)},this._capability.reject)}}m.TextLayerRenderTask=R;function S(b){const h=new R({textContent:b.textContent,textContentStream:b.textContentStream,container:b.container,viewport:b.viewport,textDivs:b.textDivs,textContentItemsStr:b.textContentItemsStr});return h._render(b.timeout),h}},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.SVGGraphics=void 0;var A=K(6),k=K(1),H=K(12);let $=class{constructor(){(0,k.unreachable)("Not implemented: SVGGraphics")}};m.SVGGraphics=$;{let f=function(t){let n=[];const r=[];for(const u of t){if(u.fn==="save"){n.push({fnId:92,fn:"group",items:[]}),r.push(n),n=n.at(-1).items;continue}u.fn==="restore"?n=r.pop():n.push(u)}return n},s=function(t){if(Number.isInteger(t))return t.toString();const n=t.toFixed(10);let r=n.length-1;if(n[r]!=="0")return n;do r--;while(n[r]==="0");return n.substring(0,n[r]==="."?r:r+1)},e=function(t){if(t[4]===0&&t[5]===0){if(t[1]===0&&t[2]===0)return t[0]===1&&t[3]===1?"":`scale(${s(t[0])} ${s(t[3])})`;if(t[0]===t[3]&&t[1]===-t[2]){const n=Math.acos(t[0])*180/Math.PI;return`rotate(${s(n)})`}}else if(t[0]===1&&t[1]===0&&t[2]===0&&t[3]===1)return`translate(${s(t[4])} ${s(t[5])})`;return`matrix(${s(t[0])} ${s(t[1])} ${s(t[2])} ${s(t[3])} ${s(t[4])} ${s(t[5])})`};const W={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},U="http://www.w3.org/XML/1998/namespace",T="http://www.w3.org/1999/xlink",E=["butt","round","square"],R=["miter","round","bevel"],S=function(t,n="",r=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!r)return URL.createObjectURL(new Blob([t],{type:n}));const u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let x=`data:${n};base64,`;for(let G=0,I=t.length;G<I;G+=3){const lt=t[G]&255,ut=t[G+1]&255,ot=t[G+2]&255,J=lt>>2,q=(lt&3)<<4|ut>>4,Y=G+1<I?(ut&15)<<2|ot>>6:64,et=G+2<I?ot&63:64;x+=u[J]+u[q]+u[Y]+u[et]}return x},b=function(){const t=new Uint8Array([137,80,78,71,13,10,26,10]),n=12,r=new Int32Array(256);for(let ot=0;ot<256;ot++){let J=ot;for(let q=0;q<8;q++)J&1?J=3988292384^J>>1&2147483647:J=J>>1&2147483647;r[ot]=J}function u(ot,J,q){let Y=-1;for(let et=J;et<q;et++){const nt=(Y^ot[et])&255,dt=r[nt];Y=Y>>>8^dt}return Y^-1}function x(ot,J,q,Y){let et=Y;const nt=J.length;q[et]=nt>>24&255,q[et+1]=nt>>16&255,q[et+2]=nt>>8&255,q[et+3]=nt&255,et+=4,q[et]=ot.charCodeAt(0)&255,q[et+1]=ot.charCodeAt(1)&255,q[et+2]=ot.charCodeAt(2)&255,q[et+3]=ot.charCodeAt(3)&255,et+=4,q.set(J,et),et+=J.length;const dt=u(q,Y+4,et);q[et]=dt>>24&255,q[et+1]=dt>>16&255,q[et+2]=dt>>8&255,q[et+3]=dt&255}function G(ot,J,q){let Y=1,et=0;for(let nt=J;nt<q;++nt)Y=(Y+(ot[nt]&255))%65521,et=(et+Y)%65521;return et<<16|Y}function I(ot){if(!H.isNodeJS)return lt(ot);try{let J;parseInt(process.versions.node)>=8?J=ot:J=Buffer.from(ot);const q=require$$5.deflateSync(J,{level:9});return q instanceof Uint8Array?q:new Uint8Array(q)}catch(J){(0,k.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+J)}return lt(ot)}function lt(ot){let J=ot.length;const q=65535,Y=Math.ceil(J/q),et=new Uint8Array(2+J+Y*5+4);let nt=0;et[nt++]=120,et[nt++]=156;let dt=0;for(;J>q;)et[nt++]=0,et[nt++]=255,et[nt++]=255,et[nt++]=0,et[nt++]=0,et.set(ot.subarray(dt,dt+q),nt),nt+=q,dt+=q,J-=q;et[nt++]=1,et[nt++]=J&255,et[nt++]=J>>8&255,et[nt++]=~J&65535&255,et[nt++]=(~J&65535)>>8&255,et.set(ot.subarray(dt),nt),nt+=ot.length-dt;const pt=G(ot,0,ot.length);return et[nt++]=pt>>24&255,et[nt++]=pt>>16&255,et[nt++]=pt>>8&255,et[nt++]=pt&255,et}function ut(ot,J,q,Y){const et=ot.width,nt=ot.height;let dt,pt,D;const g=ot.data;switch(J){case k.ImageKind.GRAYSCALE_1BPP:pt=0,dt=1,D=et+7>>3;break;case k.ImageKind.RGB_24BPP:pt=2,dt=8,D=et*3;break;case k.ImageKind.RGBA_32BPP:pt=6,dt=8,D=et*4;break;default:throw new Error("invalid format")}const a=new Uint8Array((1+D)*nt);let y=0,F=0;for(let i=0;i<nt;++i)a[y++]=0,a.set(g.subarray(F,F+D),y),F+=D,y+=D;if(J===k.ImageKind.GRAYSCALE_1BPP&&Y){y=0;for(let i=0;i<nt;i++){y++;for(let c=0;c<D;c++)a[y++]^=255}}const O=new Uint8Array([et>>24&255,et>>16&255,et>>8&255,et&255,nt>>24&255,nt>>16&255,nt>>8&255,nt&255,dt,pt,0,0,0]),N=I(a),j=t.length+n*3+O.length+N.length,Q=new Uint8Array(j);let tt=0;return Q.set(t,tt),tt+=t.length,x("IHDR",O,Q,tt),tt+=n+O.length,x("IDATA",N,Q,tt),tt+=n+N.length,x("IEND",new Uint8Array(0),Q,tt),S(Q,"image/png",q)}return function(J,q,Y){const et=J.kind===void 0?k.ImageKind.GRAYSCALE_1BPP:J.kind;return ut(J,et,q,Y)}}();class h{constructor(){this.fontSizeScale=1,this.fontWeight=W.fontWeight,this.fontSize=0,this.textMatrix=k.IDENTITY_MATRIX,this.fontMatrix=k.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=k.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=W.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(n,r){this.x=n,this.y=r}}let d=0,o=0,p=0;m.SVGGraphics=$=class{constructor(t,n,r=!1){(0,A.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new A.DOMSVGFactory,this.current=new h,this.transformMatrix=k.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=n,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!r,this._operatorIdMapping=[];for(const u in k.OPS)this._operatorIdMapping[k.OPS[u]]=u}getObject(t,n=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):n}save(){this.transformStack.push(this.transformMatrix);const t=this.current;this.extraStack.push(t),this.current=t.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(t){this.save(),this.executeOpTree(t),this.restore()}loadDependencies(t){const n=t.fnArray,r=t.argsArray;for(let u=0,x=n.length;u<x;u++)if(n[u]===k.OPS.dependency)for(const G of r[u]){const I=G.startsWith("g_")?this.commonObjs:this.objs,lt=new Promise(ut=>{I.get(G,ut)});this.current.dependencies.push(lt)}return Promise.all(this.current.dependencies)}transform(t,n,r,u,x,G){const I=[t,n,r,u,x,G];this.transformMatrix=k.Util.transform(this.transformMatrix,I),this.tgrp=null}getSVG(t,n){this.viewport=n;const r=this._initialize(n);return this.loadDependencies(t).then(()=>(this.transformMatrix=k.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(t)),r))}convertOpList(t){const n=this._operatorIdMapping,r=t.argsArray,u=t.fnArray,x=[];for(let G=0,I=u.length;G<I;G++){const lt=u[G];x.push({fnId:lt,fn:n[lt],args:r[G]})}return f(x)}executeOpTree(t){for(const n of t){const r=n.fn,u=n.fnId,x=n.args;switch(u|0){case k.OPS.beginText:this.beginText();break;case k.OPS.dependency:break;case k.OPS.setLeading:this.setLeading(x);break;case k.OPS.setLeadingMoveText:this.setLeadingMoveText(x[0],x[1]);break;case k.OPS.setFont:this.setFont(x);break;case k.OPS.showText:this.showText(x[0]);break;case k.OPS.showSpacedText:this.showText(x[0]);break;case k.OPS.endText:this.endText();break;case k.OPS.moveText:this.moveText(x[0],x[1]);break;case k.OPS.setCharSpacing:this.setCharSpacing(x[0]);break;case k.OPS.setWordSpacing:this.setWordSpacing(x[0]);break;case k.OPS.setHScale:this.setHScale(x[0]);break;case k.OPS.setTextMatrix:this.setTextMatrix(x[0],x[1],x[2],x[3],x[4],x[5]);break;case k.OPS.setTextRise:this.setTextRise(x[0]);break;case k.OPS.setTextRenderingMode:this.setTextRenderingMode(x[0]);break;case k.OPS.setLineWidth:this.setLineWidth(x[0]);break;case k.OPS.setLineJoin:this.setLineJoin(x[0]);break;case k.OPS.setLineCap:this.setLineCap(x[0]);break;case k.OPS.setMiterLimit:this.setMiterLimit(x[0]);break;case k.OPS.setFillRGBColor:this.setFillRGBColor(x[0],x[1],x[2]);break;case k.OPS.setStrokeRGBColor:this.setStrokeRGBColor(x[0],x[1],x[2]);break;case k.OPS.setStrokeColorN:this.setStrokeColorN(x);break;case k.OPS.setFillColorN:this.setFillColorN(x);break;case k.OPS.shadingFill:this.shadingFill(x[0]);break;case k.OPS.setDash:this.setDash(x[0],x[1]);break;case k.OPS.setRenderingIntent:this.setRenderingIntent(x[0]);break;case k.OPS.setFlatness:this.setFlatness(x[0]);break;case k.OPS.setGState:this.setGState(x[0]);break;case k.OPS.fill:this.fill();break;case k.OPS.eoFill:this.eoFill();break;case k.OPS.stroke:this.stroke();break;case k.OPS.fillStroke:this.fillStroke();break;case k.OPS.eoFillStroke:this.eoFillStroke();break;case k.OPS.clip:this.clip("nonzero");break;case k.OPS.eoClip:this.clip("evenodd");break;case k.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case k.OPS.paintImageXObject:this.paintImageXObject(x[0]);break;case k.OPS.paintInlineImageXObject:this.paintInlineImageXObject(x[0]);break;case k.OPS.paintImageMaskXObject:this.paintImageMaskXObject(x[0]);break;case k.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(x[0],x[1]);break;case k.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case k.OPS.closePath:this.closePath();break;case k.OPS.closeStroke:this.closeStroke();break;case k.OPS.closeFillStroke:this.closeFillStroke();break;case k.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case k.OPS.nextLine:this.nextLine();break;case k.OPS.transform:this.transform(x[0],x[1],x[2],x[3],x[4],x[5]);break;case k.OPS.constructPath:this.constructPath(x[0],x[1]);break;case k.OPS.endPath:this.endPath();break;case 92:this.group(n.items);break;default:(0,k.warn)(`Unimplemented operator ${r}`);break}}}setWordSpacing(t){this.current.wordSpacing=t}setCharSpacing(t){this.current.charSpacing=t}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(t,n,r,u,x,G){const I=this.current;I.textMatrix=I.lineMatrix=[t,n,r,u,x,G],I.textMatrixScale=Math.hypot(t,n),I.x=I.lineX=0,I.y=I.lineY=0,I.xcoords=[],I.ycoords=[],I.tspan=this.svgFactory.createElement("svg:tspan"),I.tspan.setAttributeNS(null,"font-family",I.fontFamily),I.tspan.setAttributeNS(null,"font-size",`${s(I.fontSize)}px`),I.tspan.setAttributeNS(null,"y",s(-I.y)),I.txtElement=this.svgFactory.createElement("svg:text"),I.txtElement.append(I.tspan)}beginText(){const t=this.current;t.x=t.lineX=0,t.y=t.lineY=0,t.textMatrix=k.IDENTITY_MATRIX,t.lineMatrix=k.IDENTITY_MATRIX,t.textMatrixScale=1,t.tspan=this.svgFactory.createElement("svg:tspan"),t.txtElement=this.svgFactory.createElement("svg:text"),t.txtgrp=this.svgFactory.createElement("svg:g"),t.xcoords=[],t.ycoords=[]}moveText(t,n){const r=this.current;r.x=r.lineX+=t,r.y=r.lineY+=n,r.xcoords=[],r.ycoords=[],r.tspan=this.svgFactory.createElement("svg:tspan"),r.tspan.setAttributeNS(null,"font-family",r.fontFamily),r.tspan.setAttributeNS(null,"font-size",`${s(r.fontSize)}px`),r.tspan.setAttributeNS(null,"y",s(-r.y))}showText(t){const n=this.current,r=n.font,u=n.fontSize;if(u===0)return;const x=n.fontSizeScale,G=n.charSpacing,I=n.wordSpacing,lt=n.fontDirection,ut=n.textHScale*lt,ot=r.vertical,J=ot?1:-1,q=r.defaultVMetrics,Y=u*n.fontMatrix[0];let et=0;for(const pt of t){if(pt===null){et+=lt*I;continue}else if(typeof pt=="number"){et+=J*pt*u/1e3;continue}const D=(pt.isSpace?I:0)+G,g=pt.fontChar;let a,y,F=pt.width;if(ot){let N;const j=pt.vmetric||q;N=pt.vmetric?j[1]:F*.5,N=-N*Y;const Q=j[2]*Y;F=j?-j[0]:F,a=N/x,y=(et+Q)/x}else a=et/x,y=0;(pt.isInFont||r.missingFile)&&(n.xcoords.push(n.x+a),ot&&n.ycoords.push(-n.y+y),n.tspan.textContent+=g);let O;ot?O=F*Y-D*lt:O=F*Y+D*lt,et+=O}n.tspan.setAttributeNS(null,"x",n.xcoords.map(s).join(" ")),ot?n.tspan.setAttributeNS(null,"y",n.ycoords.map(s).join(" ")):n.tspan.setAttributeNS(null,"y",s(-n.y)),ot?n.y-=et:n.x+=et*ut,n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",`${s(n.fontSize)}px`),n.fontStyle!==W.fontStyle&&n.tspan.setAttributeNS(null,"font-style",n.fontStyle),n.fontWeight!==W.fontWeight&&n.tspan.setAttributeNS(null,"font-weight",n.fontWeight);const nt=n.textRenderingMode&k.TextRenderingMode.FILL_STROKE_MASK;if(nt===k.TextRenderingMode.FILL||nt===k.TextRenderingMode.FILL_STROKE?(n.fillColor!==W.fillColor&&n.tspan.setAttributeNS(null,"fill",n.fillColor),n.fillAlpha<1&&n.tspan.setAttributeNS(null,"fill-opacity",n.fillAlpha)):n.textRenderingMode===k.TextRenderingMode.ADD_TO_PATH?n.tspan.setAttributeNS(null,"fill","transparent"):n.tspan.setAttributeNS(null,"fill","none"),nt===k.TextRenderingMode.STROKE||nt===k.TextRenderingMode.FILL_STROKE){const pt=1/(n.textMatrixScale||1);this._setStrokeAttributes(n.tspan,pt)}let dt=n.textMatrix;n.textRise!==0&&(dt=dt.slice(),dt[5]+=n.textRise),n.txtElement.setAttributeNS(null,"transform",`${e(dt)} scale(${s(ut)}, -1)`),n.txtElement.setAttributeNS(U,"xml:space","preserve"),n.txtElement.append(n.tspan),n.txtgrp.append(n.txtElement),this._ensureTransformGroup().append(n.txtElement)}setLeadingMoveText(t,n){this.setLeading(-n),this.moveText(t,n)}addFontStyle(t){if(!t.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const n=S(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${t.loadedName}"; src: url(${n}); }
`}setFont(t){const n=this.current,r=this.commonObjs.get(t[0]);let u=t[1];n.font=r,this.embedFonts&&!r.missingFile&&!this.embeddedFonts[r.loadedName]&&(this.addFontStyle(r),this.embeddedFonts[r.loadedName]=r),n.fontMatrix=r.fontMatrix||k.FONT_IDENTITY_MATRIX;let x="normal";r.black?x="900":r.bold&&(x="bold");const G=r.italic?"italic":"normal";u<0?(u=-u,n.fontDirection=-1):n.fontDirection=1,n.fontSize=u,n.fontFamily=r.loadedName,n.fontWeight=x,n.fontStyle=G,n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"y",s(-n.y)),n.xcoords=[],n.ycoords=[]}endText(){var n;const t=this.current;t.textRenderingMode&k.TextRenderingMode.ADD_TO_PATH_FLAG&&((n=t.txtElement)!=null&&n.hasChildNodes())&&(t.element=t.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(t){t>0&&(this.current.lineWidth=t)}setLineCap(t){this.current.lineCap=E[t]}setLineJoin(t){this.current.lineJoin=R[t]}setMiterLimit(t){this.current.miterLimit=t}setStrokeAlpha(t){this.current.strokeAlpha=t}setStrokeRGBColor(t,n,r){this.current.strokeColor=k.Util.makeHexColor(t,n,r)}setFillAlpha(t){this.current.fillAlpha=t}setFillRGBColor(t,n,r){this.current.fillColor=k.Util.makeHexColor(t,n,r),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(t){this.current.strokeColor=this._makeColorN_Pattern(t)}setFillColorN(t){this.current.fillColor=this._makeColorN_Pattern(t)}shadingFill(t){const n=this.viewport.width,r=this.viewport.height,u=k.Util.inverseTransform(this.transformMatrix),x=k.Util.applyTransform([0,0],u),G=k.Util.applyTransform([0,r],u),I=k.Util.applyTransform([n,0],u),lt=k.Util.applyTransform([n,r],u),ut=Math.min(x[0],G[0],I[0],lt[0]),ot=Math.min(x[1],G[1],I[1],lt[1]),J=Math.max(x[0],G[0],I[0],lt[0]),q=Math.max(x[1],G[1],I[1],lt[1]),Y=this.svgFactory.createElement("svg:rect");Y.setAttributeNS(null,"x",ut),Y.setAttributeNS(null,"y",ot),Y.setAttributeNS(null,"width",J-ut),Y.setAttributeNS(null,"height",q-ot),Y.setAttributeNS(null,"fill",this._makeShadingPattern(t)),this.current.fillAlpha<1&&Y.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Y)}_makeColorN_Pattern(t){return t[0]==="TilingPattern"?this._makeTilingPattern(t):this._makeShadingPattern(t)}_makeTilingPattern(t){const n=t[1],r=t[2],u=t[3]||k.IDENTITY_MATRIX,[x,G,I,lt]=t[4],ut=t[5],ot=t[6],J=t[7],q=`shading${p++}`,[Y,et,nt,dt]=k.Util.normalizeRect([...k.Util.applyTransform([x,G],u),...k.Util.applyTransform([I,lt],u)]),[pt,D]=k.Util.singularValueDecompose2dScale(u),g=ut*pt,a=ot*D,y=this.svgFactory.createElement("svg:pattern");y.setAttributeNS(null,"id",q),y.setAttributeNS(null,"patternUnits","userSpaceOnUse"),y.setAttributeNS(null,"width",g),y.setAttributeNS(null,"height",a),y.setAttributeNS(null,"x",`${Y}`),y.setAttributeNS(null,"y",`${et}`);const F=this.svg,O=this.transformMatrix,N=this.current.fillColor,j=this.current.strokeColor,Q=this.svgFactory.create(nt-Y,dt-et);if(this.svg=Q,this.transformMatrix=u,J===2){const tt=k.Util.makeHexColor(...n);this.current.fillColor=tt,this.current.strokeColor=tt}return this.executeOpTree(this.convertOpList(r)),this.svg=F,this.transformMatrix=O,this.current.fillColor=N,this.current.strokeColor=j,y.append(Q.childNodes[0]),this.defs.append(y),`url(#${q})`}_makeShadingPattern(t){switch(typeof t=="string"&&(t=this.objs.get(t)),t[0]){case"RadialAxial":const n=`shading${p++}`,r=t[3];let u;switch(t[1]){case"axial":const x=t[4],G=t[5];u=this.svgFactory.createElement("svg:linearGradient"),u.setAttributeNS(null,"id",n),u.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),u.setAttributeNS(null,"x1",x[0]),u.setAttributeNS(null,"y1",x[1]),u.setAttributeNS(null,"x2",G[0]),u.setAttributeNS(null,"y2",G[1]);break;case"radial":const I=t[4],lt=t[5],ut=t[6],ot=t[7];u=this.svgFactory.createElement("svg:radialGradient"),u.setAttributeNS(null,"id",n),u.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),u.setAttributeNS(null,"cx",lt[0]),u.setAttributeNS(null,"cy",lt[1]),u.setAttributeNS(null,"r",ot),u.setAttributeNS(null,"fx",I[0]),u.setAttributeNS(null,"fy",I[1]),u.setAttributeNS(null,"fr",ut);break;default:throw new Error(`Unknown RadialAxial type: ${t[1]}`)}for(const x of r){const G=this.svgFactory.createElement("svg:stop");G.setAttributeNS(null,"offset",x[0]),G.setAttributeNS(null,"stop-color",x[1]),u.append(G)}return this.defs.append(u),`url(#${n})`;case"Mesh":return(0,k.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${t[0]}`)}}setDash(t,n){this.current.dashArray=t,this.current.dashPhase=n}constructPath(t,n){const r=this.current;let u=r.x,x=r.y,G=[],I=0;for(const lt of t)switch(lt|0){case k.OPS.rectangle:u=n[I++],x=n[I++];const ut=n[I++],ot=n[I++],J=u+ut,q=x+ot;G.push("M",s(u),s(x),"L",s(J),s(x),"L",s(J),s(q),"L",s(u),s(q),"Z");break;case k.OPS.moveTo:u=n[I++],x=n[I++],G.push("M",s(u),s(x));break;case k.OPS.lineTo:u=n[I++],x=n[I++],G.push("L",s(u),s(x));break;case k.OPS.curveTo:u=n[I+4],x=n[I+5],G.push("C",s(n[I]),s(n[I+1]),s(n[I+2]),s(n[I+3]),s(u),s(x)),I+=6;break;case k.OPS.curveTo2:G.push("C",s(u),s(x),s(n[I]),s(n[I+1]),s(n[I+2]),s(n[I+3])),u=n[I+2],x=n[I+3],I+=4;break;case k.OPS.curveTo3:u=n[I+2],x=n[I+3],G.push("C",s(n[I]),s(n[I+1]),s(u),s(x),s(u),s(x)),I+=4;break;case k.OPS.closePath:G.push("Z");break}G=G.join(" "),r.path&&t.length>0&&t[0]!==k.OPS.rectangle&&t[0]!==k.OPS.moveTo?G=r.path.getAttributeNS(null,"d")+G:(r.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(r.path)),r.path.setAttributeNS(null,"d",G),r.path.setAttributeNS(null,"fill","none"),r.element=r.path,r.setCurrentPoint(u,x)}endPath(){const t=this.current;if(t.path=null,!this.pendingClip)return;if(!t.element){this.pendingClip=null;return}const n=`clippath${d++}`,r=this.svgFactory.createElement("svg:clipPath");r.setAttributeNS(null,"id",n),r.setAttributeNS(null,"transform",e(this.transformMatrix));const u=t.element.cloneNode(!0);if(this.pendingClip==="evenodd"?u.setAttributeNS(null,"clip-rule","evenodd"):u.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,r.append(u),this.defs.append(r),t.activeClipUrl){t.clipGroup=null;for(const x of this.extraStack)x.clipGroup=null;r.setAttributeNS(null,"clip-path",t.activeClipUrl)}t.activeClipUrl=`url(#${n})`,this.tgrp=null}clip(t){this.pendingClip=t}closePath(){const t=this.current;if(t.path){const n=`${t.path.getAttributeNS(null,"d")}Z`;t.path.setAttributeNS(null,"d",n)}}setLeading(t){this.current.leading=-t}setTextRise(t){this.current.textRise=t}setTextRenderingMode(t){this.current.textRenderingMode=t}setHScale(t){this.current.textHScale=t/100}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[n,r]of t)switch(n){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r);break;case"CA":this.setStrokeAlpha(r);break;case"ca":this.setFillAlpha(r);break;default:(0,k.warn)(`Unimplemented graphic state operator ${n}`);break}}fill(){const t=this.current;t.element&&(t.element.setAttributeNS(null,"fill",t.fillColor),t.element.setAttributeNS(null,"fill-opacity",t.fillAlpha),this.endPath())}stroke(){const t=this.current;t.element&&(this._setStrokeAttributes(t.element),t.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(t,n=1){const r=this.current;let u=r.dashArray;n!==1&&u.length>0&&(u=u.map(function(x){return n*x})),t.setAttributeNS(null,"stroke",r.strokeColor),t.setAttributeNS(null,"stroke-opacity",r.strokeAlpha),t.setAttributeNS(null,"stroke-miterlimit",s(r.miterLimit)),t.setAttributeNS(null,"stroke-linecap",r.lineCap),t.setAttributeNS(null,"stroke-linejoin",r.lineJoin),t.setAttributeNS(null,"stroke-width",s(n*r.lineWidth)+"px"),t.setAttributeNS(null,"stroke-dasharray",u.map(s).join(" ")),t.setAttributeNS(null,"stroke-dashoffset",s(n*r.dashPhase)+"px")}eoFill(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const t=this.svgFactory.createElement("svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(t)}paintImageXObject(t){const n=this.getObject(t);if(!n){(0,k.warn)(`Dependent image with object ID ${t} is not ready yet`);return}this.paintInlineImageXObject(n)}paintInlineImageXObject(t,n){const r=t.width,u=t.height,x=b(t,this.forceDataSchema,!!n),G=this.svgFactory.createElement("svg:rect");G.setAttributeNS(null,"x","0"),G.setAttributeNS(null,"y","0"),G.setAttributeNS(null,"width",s(r)),G.setAttributeNS(null,"height",s(u)),this.current.element=G,this.clip("nonzero");const I=this.svgFactory.createElement("svg:image");I.setAttributeNS(T,"xlink:href",x),I.setAttributeNS(null,"x","0"),I.setAttributeNS(null,"y",s(-u)),I.setAttributeNS(null,"width",s(r)+"px"),I.setAttributeNS(null,"height",s(u)+"px"),I.setAttributeNS(null,"transform",`scale(${s(1/r)} ${s(-1/u)})`),n?n.append(I):this._ensureTransformGroup().append(I)}paintImageMaskXObject(t){const n=this.getObject(t.data,t);if(n.bitmap){(0,k.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const r=this.current,u=n.width,x=n.height,G=r.fillColor;r.maskId=`mask${o++}`;const I=this.svgFactory.createElement("svg:mask");I.setAttributeNS(null,"id",r.maskId);const lt=this.svgFactory.createElement("svg:rect");lt.setAttributeNS(null,"x","0"),lt.setAttributeNS(null,"y","0"),lt.setAttributeNS(null,"width",s(u)),lt.setAttributeNS(null,"height",s(x)),lt.setAttributeNS(null,"fill",G),lt.setAttributeNS(null,"mask",`url(#${r.maskId})`),this.defs.append(I),this._ensureTransformGroup().append(lt),this.paintInlineImageXObject(n,I)}paintFormXObjectBegin(t,n){if(Array.isArray(t)&&t.length===6&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]),n){const r=n[2]-n[0],u=n[3]-n[1],x=this.svgFactory.createElement("svg:rect");x.setAttributeNS(null,"x",n[0]),x.setAttributeNS(null,"y",n[1]),x.setAttributeNS(null,"width",s(r)),x.setAttributeNS(null,"height",s(u)),this.current.element=x,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(t){const n=this.svgFactory.create(t.width,t.height),r=this.svgFactory.createElement("svg:defs");n.append(r),this.defs=r;const u=this.svgFactory.createElement("svg:g");return u.setAttributeNS(null,"transform",e(t.transform)),n.append(u),this.svg=u,n}_ensureClipGroup(){if(!this.current.clipGroup){const t=this.svgFactory.createElement("svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(t),this.current.clipGroup=t}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",e(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.PDFNodeStream=void 0;var A=K(1),k=K(32);const H=require$$5,$=require$$5,W=require$$5,U=require$$5,T=/^file:\/\/\/[a-zA-Z]:\//;function E(o){const p=U.parse(o);return p.protocol==="file:"||p.host?p:/^[a-z]:[/\\]/i.test(o)?U.parse(`file:///${o}`):(p.host||(p.protocol="file:"),p)}class R{constructor(p){this.source=p,this.url=E(p.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&p.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var p;return((p=this._fullRequestReader)==null?void 0:p._loaded)??0}getFullReader(){return(0,A.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new e(this):new f(this),this._fullRequestReader}getRangeReader(p,t){if(t<=this._progressiveDataLength)return null;const n=this.isFsUrl?new d(this,p,t):new s(this,p,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(p){var t;(t=this._fullRequestReader)==null||t.cancel(p);for(const n of this._rangeRequestReaders.slice(0))n.cancel(p)}}m.PDFNodeStream=R;class S{constructor(p){this._url=p.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=p.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=(0,A.createPromiseCapability)(),this._headersCapability=(0,A.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const p=this._readableStream.read();return p===null?(this._readCapability=(0,A.createPromiseCapability)(),this.read()):(this._loaded+=p.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(p).buffer,done:!1})}cancel(p){if(!this._readableStream){this._error(p);return}this._readableStream.destroy(p)}_error(p){this._storedError=p,this._readCapability.resolve()}_setReadableStream(p){this._readableStream=p,p.on("readable",()=>{this._readCapability.resolve()}),p.on("end",()=>{p.destroy(),this._done=!0,this._readCapability.resolve()}),p.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new A.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class b{constructor(p){this._url=p.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,A.createPromiseCapability)();const t=p.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const p=this._readableStream.read();return p===null?(this._readCapability=(0,A.createPromiseCapability)(),this.read()):(this._loaded+=p.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(p).buffer,done:!1})}cancel(p){if(!this._readableStream){this._error(p);return}this._readableStream.destroy(p)}_error(p){this._storedError=p,this._readCapability.resolve()}_setReadableStream(p){this._readableStream=p,p.on("readable",()=>{this._readCapability.resolve()}),p.on("end",()=>{p.destroy(),this._done=!0,this._readCapability.resolve()}),p.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function h(o,p){return{protocol:o.protocol,auth:o.auth,host:o.hostname,port:o.port,path:o.path,method:"GET",headers:p}}class f extends S{constructor(p){super(p);const t=n=>{if(n.statusCode===404){const G=new A.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=G,this._headersCapability.reject(G);return}this._headersCapability.resolve(),this._setReadableStream(n);const r=G=>this._readableStream.headers[G.toLowerCase()],{allowRangeRequests:u,suggestedLength:x}=(0,k.validateRangeRequestCapabilities)({getResponseHeader:r,isHttp:p.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=x||this._contentLength,this._filename=(0,k.extractFilenameFromHeader)(r)};this._request=null,this._url.protocol==="http:"?this._request=$.request(h(this._url,p.httpHeaders),t):this._request=W.request(h(this._url,p.httpHeaders),t),this._request.on("error",n=>{this._storedError=n,this._headersCapability.reject(n)}),this._request.end()}}class s extends b{constructor(p,t,n){super(p),this._httpHeaders={};for(const u in p.httpHeaders){const x=p.httpHeaders[u];typeof x>"u"||(this._httpHeaders[u]=x)}this._httpHeaders.Range=`bytes=${t}-${n-1}`;const r=u=>{if(u.statusCode===404){const x=new A.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=x;return}this._setReadableStream(u)};this._request=null,this._url.protocol==="http:"?this._request=$.request(h(this._url,this._httpHeaders),r):this._request=W.request(h(this._url,this._httpHeaders),r),this._request.on("error",u=>{this._storedError=u}),this._request.end()}}class e extends S{constructor(p){super(p);let t=decodeURIComponent(this._url.path);T.test(this._url.href)&&(t=t.replace(/^\//,"")),H.lstat(t,(n,r)=>{if(n){n.code==="ENOENT"&&(n=new A.MissingPDFException(`Missing PDF "${t}".`)),this._storedError=n,this._headersCapability.reject(n);return}this._contentLength=r.size,this._setReadableStream(H.createReadStream(t)),this._headersCapability.resolve()})}}class d extends b{constructor(p,t,n){super(p);let r=decodeURIComponent(this._url.path);T.test(this._url.href)&&(r=r.replace(/^\//,"")),this._setReadableStream(H.createReadStream(r,{start:t,end:n-1}))}}},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.createResponseStatusError=U,m.extractFilenameFromHeader=W,m.validateRangeRequestCapabilities=$,m.validateResponseStatus=T;var A=K(1),k=K(33),H=K(6);function $({getResponseHeader:E,isHttp:R,rangeChunkSize:S,disableRange:b}){const h={allowRangeRequests:!1,suggestedLength:void 0},f=parseInt(E("Content-Length"),10);return!Number.isInteger(f)||(h.suggestedLength=f,f<=2*S)||b||!R||E("Accept-Ranges")!=="bytes"||(E("Content-Encoding")||"identity")!=="identity"||(h.allowRangeRequests=!0),h}function W(E){const R=E("Content-Disposition");if(R){let S=(0,k.getFilenameFromContentDispositionHeader)(R);if(S.includes("%"))try{S=decodeURIComponent(S)}catch{}if((0,H.isPdfFile)(S))return S}return null}function U(E,R){return E===404||E===0&&R.startsWith("file:")?new A.MissingPDFException('Missing PDF "'+R+'".'):new A.UnexpectedResponseException(`Unexpected server response (${E}) while retrieving PDF "${R}".`,E)}function T(E){return E===200||E===206}},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.getFilenameFromContentDispositionHeader=k;var A=K(1);function k(H){let $=!0,W=U("filename\\*","i").exec(H);if(W){W=W[1];let f=S(W);return f=unescape(f),f=b(f),f=h(f),E(f)}if(W=R(H),W){const f=h(W);return E(f)}if(W=U("filename","i").exec(H),W){W=W[1];let f=S(W);return f=h(f),E(f)}function U(f,s){return new RegExp("(?:^|;)\\s*"+f+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',s)}function T(f,s){if(f){if(!/^[\x00-\xFF]+$/.test(s))return s;try{const e=new TextDecoder(f,{fatal:!0}),d=(0,A.stringToBytes)(s);s=e.decode(d),$=!1}catch{}}return s}function E(f){return $&&/[\x80-\xff]/.test(f)&&(f=T("utf-8",f),$&&(f=T("iso-8859-1",f))),f}function R(f){const s=[];let e;const d=U("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(e=d.exec(f))!==null;){let[,p,t,n]=e;if(p=parseInt(p,10),p in s){if(p===0)break;continue}s[p]=[t,n]}const o=[];for(let p=0;p<s.length&&p in s;++p){let[t,n]=s[p];n=S(n),t&&(n=unescape(n),p===0&&(n=b(n))),o.push(n)}return o.join("")}function S(f){if(f.startsWith('"')){const s=f.slice(1).split('\\"');for(let e=0;e<s.length;++e){const d=s[e].indexOf('"');d!==-1&&(s[e]=s[e].slice(0,d),s.length=e+1),s[e]=s[e].replace(/\\(.)/g,"$1")}f=s.join('"')}return f}function b(f){const s=f.indexOf("'");if(s===-1)return f;const e=f.slice(0,s),o=f.slice(s+1).replace(/^[^']*'/,"");return T(e,o)}function h(f){return!f.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(f)?f:f.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(s,e,d,o){if(d==="q"||d==="Q")return o=o.replace(/_/g," "),o=o.replace(/=([0-9a-fA-F]{2})/g,function(p,t){return String.fromCharCode(parseInt(t,16))}),T(e,o);try{o=atob(o)}catch{}return T(e,o)})}return""}},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.PDFNetworkStream=void 0;var A=K(1),k=K(32);const H=200,$=206;function W(S){const b=S.response;return typeof b!="string"?b:(0,A.stringToBytes)(b).buffer}class U{constructor(b,h={}){this.url=b,this.isHttp=/^https?:/i.test(b),this.httpHeaders=this.isHttp&&h.httpHeaders||Object.create(null),this.withCredentials=h.withCredentials||!1,this.getXhr=h.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(b,h,f){const s={begin:b,end:h};for(const e in f)s[e]=f[e];return this.request(s)}requestFull(b){return this.request(b)}request(b){const h=this.getXhr(),f=this.currXhrId++,s=this.pendingRequests[f]={xhr:h};h.open("GET",this.url),h.withCredentials=this.withCredentials;for(const e in this.httpHeaders){const d=this.httpHeaders[e];typeof d>"u"||h.setRequestHeader(e,d)}return this.isHttp&&"begin"in b&&"end"in b?(h.setRequestHeader("Range",`bytes=${b.begin}-${b.end-1}`),s.expectedStatus=$):s.expectedStatus=H,h.responseType="arraybuffer",b.onError&&(h.onerror=function(e){b.onError(h.status)}),h.onreadystatechange=this.onStateChange.bind(this,f),h.onprogress=this.onProgress.bind(this,f),s.onHeadersReceived=b.onHeadersReceived,s.onDone=b.onDone,s.onError=b.onError,s.onProgress=b.onProgress,h.send(null),f}onProgress(b,h){var s;const f=this.pendingRequests[b];f&&((s=f.onProgress)==null||s.call(f,h))}onStateChange(b,h){var p,t,n;const f=this.pendingRequests[b];if(!f)return;const s=f.xhr;if(s.readyState>=2&&f.onHeadersReceived&&(f.onHeadersReceived(),delete f.onHeadersReceived),s.readyState!==4||!(b in this.pendingRequests))return;if(delete this.pendingRequests[b],s.status===0&&this.isHttp){(p=f.onError)==null||p.call(f,s.status);return}const e=s.status||H;if(!(e===H&&f.expectedStatus===$)&&e!==f.expectedStatus){(t=f.onError)==null||t.call(f,s.status);return}const o=W(s);if(e===$){const r=s.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(r);f.onDone({begin:parseInt(u[1],10),chunk:o})}else o?f.onDone({begin:0,chunk:o}):(n=f.onError)==null||n.call(f,s.status)}getRequestXhr(b){return this.pendingRequests[b].xhr}isPendingRequest(b){return b in this.pendingRequests}abortRequest(b){const h=this.pendingRequests[b].xhr;delete this.pendingRequests[b],h.abort()}}class T{constructor(b){this._source=b,this._manager=new U(b.url,{httpHeaders:b.httpHeaders,withCredentials:b.withCredentials}),this._rangeChunkSize=b.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(b){const h=this._rangeRequestReaders.indexOf(b);h>=0&&this._rangeRequestReaders.splice(h,1)}getFullReader(){return(0,A.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new E(this._manager,this._source),this._fullRequestReader}getRangeReader(b,h){const f=new R(this._manager,b,h);return f.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(f),f}cancelAllRequests(b){var h;(h=this._fullRequestReader)==null||h.cancel(b);for(const f of this._rangeRequestReaders.slice(0))f.cancel(b)}}m.PDFNetworkStream=T;class E{constructor(b,h){this._manager=b;const f={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=h.url,this._fullRequestId=b.requestFull(f),this._headersReceivedCapability=(0,A.createPromiseCapability)(),this._disableRange=h.disableRange||!1,this._contentLength=h.length,this._rangeChunkSize=h.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const b=this._fullRequestId,h=this._manager.getRequestXhr(b),f=d=>h.getResponseHeader(d),{allowRangeRequests:s,suggestedLength:e}=(0,k.validateRangeRequestCapabilities)({getResponseHeader:f,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=e||this._contentLength,this._filename=(0,k.extractFilenameFromHeader)(f),this._isRangeSupported&&this._manager.abortRequest(b),this._headersReceivedCapability.resolve()}_onDone(b){if(b&&(this._requests.length>0?this._requests.shift().resolve({value:b.chunk,done:!1}):this._cachedChunks.push(b.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(b){this._storedError=(0,k.createResponseStatusError)(b,this._url),this._headersReceivedCapability.reject(this._storedError);for(const h of this._requests)h.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(b){var h;(h=this.onProgress)==null||h.call(this,{loaded:b.loaded,total:b.lengthComputable?b.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const b=(0,A.createPromiseCapability)();return this._requests.push(b),b.promise}cancel(b){this._done=!0,this._headersReceivedCapability.reject(b);for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class R{constructor(b,h,f){this._manager=b;const s={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=b.url,this._requestId=b.requestRange(h,f,s),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var b;(b=this.onClosed)==null||b.call(this,this)}_onDone(b){const h=b.chunk;this._requests.length>0?this._requests.shift().resolve({value:h,done:!1}):this._queuedChunk=h,this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(b){this._storedError=(0,k.createResponseStatusError)(b,this._url);for(const h of this._requests)h.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(b){var h;this.isStreamingSupported||(h=this.onProgress)==null||h.call(this,{loaded:b.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const h=this._queuedChunk;return this._queuedChunk=null,{value:h,done:!1}}if(this._done)return{value:void 0,done:!0};const b=(0,A.createPromiseCapability)();return this._requests.push(b),b.promise}cancel(b){this._done=!0;for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(rt,m,K)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.PDFFetchStream=void 0;var A=K(1),k=K(32);function H(E,R,S){return{method:"GET",headers:E,signal:S.signal,mode:"cors",credentials:R?"include":"same-origin",redirect:"follow"}}function $(E){const R=new Headers;for(const S in E){const b=E[S];typeof b>"u"||R.append(S,b)}return R}class W{constructor(R){this.source=R,this.isHttp=/^https?:/i.test(R.url),this.httpHeaders=this.isHttp&&R.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var R;return((R=this._fullRequestReader)==null?void 0:R._loaded)??0}getFullReader(){return(0,A.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new U(this),this._fullRequestReader}getRangeReader(R,S){if(S<=this._progressiveDataLength)return null;const b=new T(this,R,S);return this._rangeRequestReaders.push(b),b}cancelAllRequests(R){var S;(S=this._fullRequestReader)==null||S.cancel(R);for(const b of this._rangeRequestReaders.slice(0))b.cancel(R)}}m.PDFFetchStream=W;class U{constructor(R){this._stream=R,this._reader=null,this._loaded=0,this._filename=null;const S=R.source;this._withCredentials=S.withCredentials||!1,this._contentLength=S.length,this._headersCapability=(0,A.createPromiseCapability)(),this._disableRange=S.disableRange||!1,this._rangeChunkSize=S.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!S.disableStream,this._isRangeSupported=!S.disableRange,this._headers=$(this._stream.httpHeaders);const b=S.url;fetch(b,H(this._headers,this._withCredentials,this._abortController)).then(h=>{if(!(0,k.validateResponseStatus)(h.status))throw(0,k.createResponseStatusError)(h.status,b);this._reader=h.body.getReader(),this._headersCapability.resolve();const f=d=>h.headers.get(d),{allowRangeRequests:s,suggestedLength:e}=(0,k.validateRangeRequestCapabilities)({getResponseHeader:f,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=e||this._contentLength,this._filename=(0,k.extractFilenameFromHeader)(f),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new A.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var h;await this._headersCapability.promise;const{value:R,done:S}=await this._reader.read();return S?{value:R,done:S}:(this._loaded+=R.byteLength,(h=this.onProgress)==null||h.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(R).buffer,done:!1})}cancel(R){var S;(S=this._reader)==null||S.cancel(R),this._abortController.abort()}}class T{constructor(R,S,b){this._stream=R,this._reader=null,this._loaded=0;const h=R.source;this._withCredentials=h.withCredentials||!1,this._readCapability=(0,A.createPromiseCapability)(),this._isStreamingSupported=!h.disableStream,this._abortController=new AbortController,this._headers=$(this._stream.httpHeaders),this._headers.append("Range",`bytes=${S}-${b-1}`);const f=h.url;fetch(f,H(this._headers,this._withCredentials,this._abortController)).then(s=>{if(!(0,k.validateResponseStatus)(s.status))throw(0,k.createResponseStatusError)(s.status,f);this._readCapability.resolve(),this._reader=s.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var h;await this._readCapability.promise;const{value:R,done:S}=await this._reader.read();return S?{value:R,done:S}:(this._loaded+=R.byteLength,(h=this.onProgress)==null||h.call(this,{loaded:this._loaded}),{value:new Uint8Array(R).buffer,done:!1})}cancel(R){var S;(S=this._reader)==null||S.cancel(R),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(rt){var m=__webpack_module_cache__[rt];if(m!==void 0)return m.exports;var K=__webpack_module_cache__[rt]={exports:{}};return __webpack_modules__[rt](K,K.exports,__w_pdfjs_require__),K.exports}var __webpack_exports__={};return(()=>{var rt=__webpack_exports__;Object.defineProperty(rt,"__esModule",{value:!0}),Object.defineProperty(rt,"AnnotationEditorLayer",{enumerable:!0,get:function(){return k.AnnotationEditorLayer}}),Object.defineProperty(rt,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return m.AnnotationEditorParamsType}}),Object.defineProperty(rt,"AnnotationEditorType",{enumerable:!0,get:function(){return m.AnnotationEditorType}}),Object.defineProperty(rt,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return H.AnnotationEditorUIManager}}),Object.defineProperty(rt,"AnnotationLayer",{enumerable:!0,get:function(){return $.AnnotationLayer}}),Object.defineProperty(rt,"AnnotationMode",{enumerable:!0,get:function(){return m.AnnotationMode}}),Object.defineProperty(rt,"CMapCompressionType",{enumerable:!0,get:function(){return m.CMapCompressionType}}),Object.defineProperty(rt,"GlobalWorkerOptions",{enumerable:!0,get:function(){return W.GlobalWorkerOptions}}),Object.defineProperty(rt,"InvalidPDFException",{enumerable:!0,get:function(){return m.InvalidPDFException}}),Object.defineProperty(rt,"MissingPDFException",{enumerable:!0,get:function(){return m.MissingPDFException}}),Object.defineProperty(rt,"OPS",{enumerable:!0,get:function(){return m.OPS}}),Object.defineProperty(rt,"PDFDataRangeTransport",{enumerable:!0,get:function(){return K.PDFDataRangeTransport}}),Object.defineProperty(rt,"PDFDateString",{enumerable:!0,get:function(){return A.PDFDateString}}),Object.defineProperty(rt,"PDFWorker",{enumerable:!0,get:function(){return K.PDFWorker}}),Object.defineProperty(rt,"PasswordResponses",{enumerable:!0,get:function(){return m.PasswordResponses}}),Object.defineProperty(rt,"PermissionFlag",{enumerable:!0,get:function(){return m.PermissionFlag}}),Object.defineProperty(rt,"PixelsPerInch",{enumerable:!0,get:function(){return A.PixelsPerInch}}),Object.defineProperty(rt,"RenderingCancelledException",{enumerable:!0,get:function(){return A.RenderingCancelledException}}),Object.defineProperty(rt,"SVGGraphics",{enumerable:!0,get:function(){return E.SVGGraphics}}),Object.defineProperty(rt,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return m.UNSUPPORTED_FEATURES}}),Object.defineProperty(rt,"UnexpectedResponseException",{enumerable:!0,get:function(){return m.UnexpectedResponseException}}),Object.defineProperty(rt,"Util",{enumerable:!0,get:function(){return m.Util}}),Object.defineProperty(rt,"VerbosityLevel",{enumerable:!0,get:function(){return m.VerbosityLevel}}),Object.defineProperty(rt,"XfaLayer",{enumerable:!0,get:function(){return R.XfaLayer}}),Object.defineProperty(rt,"build",{enumerable:!0,get:function(){return K.build}}),Object.defineProperty(rt,"createPromiseCapability",{enumerable:!0,get:function(){return m.createPromiseCapability}}),Object.defineProperty(rt,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return m.createValidAbsoluteUrl}}),Object.defineProperty(rt,"getDocument",{enumerable:!0,get:function(){return K.getDocument}}),Object.defineProperty(rt,"getFilenameFromUrl",{enumerable:!0,get:function(){return A.getFilenameFromUrl}}),Object.defineProperty(rt,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return A.getPdfFilenameFromUrl}}),Object.defineProperty(rt,"getXfaPageViewport",{enumerable:!0,get:function(){return A.getXfaPageViewport}}),Object.defineProperty(rt,"isPdfFile",{enumerable:!0,get:function(){return A.isPdfFile}}),Object.defineProperty(rt,"loadScript",{enumerable:!0,get:function(){return A.loadScript}}),Object.defineProperty(rt,"renderTextLayer",{enumerable:!0,get:function(){return T.renderTextLayer}}),Object.defineProperty(rt,"shadow",{enumerable:!0,get:function(){return m.shadow}}),Object.defineProperty(rt,"version",{enumerable:!0,get:function(){return K.version}});var m=__w_pdfjs_require__(1),K=__w_pdfjs_require__(2),A=__w_pdfjs_require__(6),k=__w_pdfjs_require__(21),H=__w_pdfjs_require__(5),$=__w_pdfjs_require__(26),W=__w_pdfjs_require__(14),U=__w_pdfjs_require__(12),T=__w_pdfjs_require__(29),E=__w_pdfjs_require__(30),R=__w_pdfjs_require__(28);if(U.isNodeJS){const{PDFNodeStream:S}=__w_pdfjs_require__(31);(0,K.setPDFNetworkStreamFactory)(b=>new S(b))}else{const{PDFNetworkStream:S}=__w_pdfjs_require__(34),{PDFFetchStream:b}=__w_pdfjs_require__(35);(0,K.setPDFNetworkStreamFactory)(h=>(0,A.isValidFetchUrl)(h.url)?new b(h):new S(h))}})(),__webpack_exports__})())})(pdf$2);var pdfExports=pdf$2.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdf$1=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]);export{pdf$1 as p};
